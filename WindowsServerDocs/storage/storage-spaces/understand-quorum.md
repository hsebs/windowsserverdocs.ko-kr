---
title: 클러스터 및 풀 쿼럼의 이해
description: 클러스터 및 풀 쿼럼을 이해 하 고 복잡 한 방법에 대 한 구체적인 예를 살펴보겠습니다.
ms.prod: windows-server
ms.author: adagashe
manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: adagashe
ms.date: 01/18/2019
ms.localizationpriority: medium
ms.openlocfilehash: f13affc3ef15c3a39f4fd3839506897f7807d93a
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80820996"
---
# <a name="understanding-cluster-and-pool-quorum"></a>클러스터 및 풀 쿼럼의 이해

>적용 대상: Windows Server 2019, Windows Server 2016

[Windows Server 장애 조치 (Failover) 클러스터링](../../failover-clustering/failover-clustering-overview.md) 은 워크 로드에 대 한 고가용성을 제공 합니다. 리소스를 호스트 하는 노드가 가동 중인 경우 이러한 리소스는 항상 사용 가능한 것으로 간주 됩니다. 그러나 클러스터에는 일반적으로 실행 해야 하는 노드의 절반 이상이 필요 하며,이는 *쿼럼이*있는 것으로 알려져 있습니다.

쿼럼은 네트워크에 파티션이 있고 노드 하위 집합이 서로 통신할 수 없는 경우 발생할 수 있는 *분할 두뇌* 시나리오를 방지 하기 위해 설계 되었습니다. 이로 인해 노드 하위 집합이 모두 워크 로드를 소유 하 고 동일한 디스크에 기록 하 여 여러 가지 문제가 발생할 수 있습니다. 그러나이는 이러한 노드 그룹 중 하나만 계속 실행 되도록 강제 하는 장애 조치 (Failover) 클러스터링의 쿼럼 개념으로 인해 이러한 그룹 중 하나만 온라인 상태로 유지 됩니다.

쿼럼은 클러스터가 계속 온라인 상태에서 유지할 수 있는 오류 수를 결정 합니다. 쿼럼은 클러스터 노드의 하위 집합 간 통신에 문제가 있을 때 시나리오를 처리 하도록 설계 되어 있으므로 여러 서버에서 동시에 리소스 그룹을 호스트 하 고 동일한 디스크에 쓰는 것을 시도 하지 않습니다. 쿼럼의 이러한 개념을 포함 하 여 클러스터는 특정 리소스 그룹의 실제 소유자가 하나만 있도록 클러스터 서비스를 노드 하위 집합 중 하나에서 중지 하도록 강제 합니다. 중지 된 노드가 다시 주 노드의 주 그룹과 통신할 수 있게 되 면 자동으로 클러스터에 다시 가입 하 고 클러스터 서비스를 시작 합니다.

Windows Server 2019 및 Windows Server 2016에는 자체 쿼럼 메커니즘이 있는 시스템의 두 가지 구성 요소가 있습니다.

- **클러스터 쿼럼**: 클러스터 수준에서 작동 합니다. 즉, 노드를 손실 하 고 클러스터를 유지할 수 있습니다.
- **풀 쿼럼**: 스토리지 공간 다이렉트 사용 하는 경우 풀 수준에서 작동 합니다. 즉, 노드 및 드라이브를 손실 하 고 풀을 유지할 수 있습니다. 저장소 풀은 클러스터 된 시나리오와 비클러스터형 시나리오 모두에서 사용 하도록 설계 되었습니다. 즉, 서로 다른 쿼럼 메커니즘이 있습니다.

## <a name="cluster-quorum-overview"></a>클러스터 쿼럼 개요

아래 표에서는 시나리오 별로 클러스터 쿼럼 결과의 개요를 제공 합니다.

| 서버 노드 | 단일 서버 노드 오류를 존속 시킬 수 있습니다. | 서버 노드 실패가 발생할 수 있습니다. | 두 개의 동시 서버 노드가 실패할 수 있습니다. |
|--------------|-------------------------------------|---------------------------------------------------|----------------------------------------------------|
| 2            | 50/50                               | 아니요                                                | 아니요                                                 |
| 2 + 미러링 모니터  | 예                                 | 아니요                                                | 아니요                                                 |
| 3            | 예                                 | 50/50                                             | 아니요                                                 |
| 3 + 미러링 모니터 서버  | 예                                 | 예                                               | 아니요                                                 |
| 4            | 예                                 | 예                                               | 50/50                                              |
| 4 + 미러링 모니터 서버  | 예                                 | 예                                               | 예                                                |
| 5 이상  | 예                                 | 예                                               | 예                                                |

### <a name="cluster-quorum-recommendations"></a>클러스터 쿼럼 권장 사항

- 노드가 두 개인 경우 미러링 모니터 서버가 **필요**합니다.
- 노드가 3 개 또는 4 개 있는 경우 미러링 모니터 서버를 **적극 권장**합니다.
- 인터넷에 액세스할 수 있는 경우  **[클라우드 감시](../../failover-clustering/deploy-cloud-witness.md) 를 사용 합니다.**
- 다른 컴퓨터 및 파일 공유를 사용 하는 IT 환경에서 파일 공유 감시를 사용 합니다.

## <a name="how-cluster-quorum-works"></a>클러스터 쿼럼 작동 방법

노드가 실패 하는 경우 또는 일부 노드의 하위 집합이 다른 하위 집합과의 연결을 잃은 경우 남아 있는 노드에서 클러스터의 *대부분이* 온라인 상태로 유지 되는지 확인 해야 합니다. 확인할 수 없는 경우 오프 라인으로 전환 됩니다.

그러나 *과반수* 의 개념은 클러스터의 총 노드 수가 홀수 인 경우에만 정상적으로 작동 합니다 (예: 5 개 노드 클러스터의 노드 3 개). 따라서 노드 수가 짝수인 클러스터 (예: 노드 4 개)는 어떻습니까?

클러스터가 *총 응답 수* 를 홀수로 만드는 방법에는 두 가지가 있습니다.

1. 먼저 추가 투표를 사용 하 여 *미러링 모니터 서버* *를 추가* 하면 됩니다. 이렇게 하려면 사용자가 설정 해야 합니다.
2.    또는 unlucky 노드의 응답 하나를 제로화 하 여 한 번만 *다운* 될 수 있습니다 (필요에 따라 자동으로 수행 됨).

노드가 정상 상태 인지 확인할 때마다 *과반수* 의 정의가 남은 것 *만으로 업데이트*됩니다. 이렇게 하면 클러스터에서 한 노드, 다른 노드, 다른 노드 등을 잃게 됩니다. 연속 실패 후에 적용 되는 *총 투표 수* 의 개념은 ***동적 쿼럼***이라고 합니다.  

### <a name="dynamic-witness"></a>동적 미러링 모니터

동적 감시는 *전체 투표 수가* 홀수 인지 확인 하기 위해 미러링 모니터 서버의 투표를 전환 합니다. 투표 수가 홀수인 경우 미러링 모니터 서버는 응답을 받지 않습니다. 짝수의 투표 수가 있는 경우 미러링 모니터 서버에 응답이 있습니다. 동적 감시는 감시 오류로 인해 클러스터가 중단 될 위험을 크게 줄여줍니다. 클러스터는 클러스터에서 사용할 수 있는 투표 노드 수를 기준으로 미러링 모니터 서버 응답을 사용할지 여부를 결정 합니다.

동적 쿼럼은 아래에 설명 된 방식으로 동적 미러링 모니터 서버와 함께 작동 합니다.

### <a name="dynamic-quorum-behavior"></a>동적 쿼럼 동작

- 노드가 **짝수** 이 고 미러링 모니터 서버가 없는 경우 *하나의 노드가 투표를 0으로 가져옵니다*. 예를 들어 4 개 노드 중 3 개만 투표를 수신 하므로 *총 투표 수* 는 3이 고, 투표를 포함 하는 두 개의 생존은 과반수로 간주 됩니다.
- 노드가 **홀수** 이 고 미러링 모니터 서버가 없는 경우 *모두 투표를 받습니다*.
- **짝수** 개의 노드 및 미러링 모니터 서버가 있는 경우 *미러링 모니터 서버에서 응답*하므로 합계는 홀수입니다.
- 노드 수가 **홀수인** 경우 미러링 모니터 서버 *는 응답 하지 않습니다*.

동적 쿼럼을 사용 하면 노드에 응답을 동적으로 할당 하 여 대부분의 투표를 방지 하 고 클러스터를 한 노드 (last man 이라고 함)를 사용 하 여 실행할 수 있습니다. 예를 들어 4 개 노드 클러스터를 살펴보겠습니다. 쿼럼을 3 개 투표 해야 한다고 가정 합니다. 

이 경우 두 개의 노드가 손실 되 면 클러스터가 중단 됩니다.

![각각 투표를 가져오는 4 개의 클러스터 노드를 보여 주는 다이어그램](media/understand-quorum/dynamic-quorum-base.png)

그러나 동적 쿼럼으로 인해이 문제가 발생 하지 않습니다. 이제 쿼럼에 필요한 *총 투표 수가* 사용 가능한 노드 수에 따라 결정 됩니다. 따라서 동적 쿼럼을 사용 하면 세 개의 노드가 손실 되더라도 클러스터가 작동 합니다.

![노드가 한 번에 하나씩 장애 조치 (failover) 되는 4 개의 클러스터 노드를 보여 주는 다이어그램 및 각 실패 후에 조정 하는 데 필요한 투표 수](media/understand-quorum/dynamic-quorum-step-through.png)

위의 시나리오는 스토리지 공간 다이렉트 사용 하도록 설정 되지 않은 일반 클러스터에 적용 됩니다. 그러나 스토리지 공간 다이렉트를 사용 하도록 설정 하면 클러스터는 두 개의 노드 오류만 지원할 수 있습니다. 이에 대해서는 [풀 쿼럼 섹션](#pool-quorum-overview)에서 자세히 설명 합니다.

### <a name="examples"></a>예

#### <a name="two-nodes-without-a-witness"></a>미러링 모니터 서버가 없는 두 개의 노드 
한 노드의 투표는 0 이므로 *과반수* 투표는 총 **1 투표**중에서 결정 됩니다. 비 투표 노드가 예기치 않게 중단 되 면 survivor에는 1/1이 포함 되 고 클러스터는 살아 있습니다. 투표 노드가 예기치 않게 중단 되 면 survivor에 0/1이 발생 하 고 클러스터가 중단 됩니다. 응답 노드의 전원이 꺼진 경우 응답은 다른 노드로 전송 되 고 클러스터는 살아 있습니다. ***이 때문에 미러링 모니터 서버를 구성 하는 것이 중요 합니다.***

![미러링 모니터 서버가 없는 두 개의 노드가 있는 경우에 설명 된 쿼럼](media/understand-quorum/2-node-no-witness.png)

- 단일 서버 오류 발생 가능성: **50%**
- 한 서버 장애를 존속 시킬 수 **있습니다.**
- 한 번에 두 개의 서버 **오류를 존속**시킬 수 있습니다. 

#### <a name="two-nodes-with-a-witness"></a>미러링 모니터 서버가 있는 두 개의 노드 
두 노드 모두 응답 하 고 미러링 모니터 서버에 응답 하므로 *과반수* 는 총 **3 개 투표**중에서 결정 됩니다. 두 노드 중 하나가 중단 되 면 survivor에는 2/3이 있고 클러스터는 살아 있습니다.

![미러링 모니터 서버가 있는 두 개의 노드가 있는 경우에 설명 된 쿼럼](media/understand-quorum/2-node-witness.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 존속 시킬 수 **있습니다.**
- 한 번에 두 개의 서버 **오류를 존속**시킬 수 있습니다. 

#### <a name="three-nodes-without-a-witness"></a>미러링 모니터 서버가 없는 3 개의 노드
모든 노드가 응답 하므로 *과반수* 는 총 **3 개 투표**중에서 결정 됩니다. 노드가 다운 되는 경우 생존은 2/3이 고 클러스터는 존속 합니다. 클러스터는 미러링 모니터 서버가 없는 두 개의 노드가 됩니다. 해당 시점에서 시나리오 1에 있습니다.

![미러링 모니터 서버가 없는 3 개의 노드가 있는 경우에 설명 된 쿼럼](media/understand-quorum/3-node-no-witness.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 발생 시킬 수 있습니다. 즉, **50%** 가 될 수 있습니다.
- 한 번에 두 개의 서버 **오류를 존속**시킬 수 있습니다. 

#### <a name="three-nodes-with-a-witness"></a>미러링 모니터 서버가 있는 세 개의 노드
모든 노드가 응답 하므로 미러링 모니터 서버가 처음에 응답 하지 않습니다. *과반수* 는 총 **3 개 투표**중에서 결정 됩니다. 한 번의 실패 후에는 클러스터에 미러링 모니터 서버가 있는 두 개의 노드가 있습니다 .이 노드는 시나리오 2로 돌아갑니다. 따라서 이제 두 개의 노드와 미러링 모니터 서버가 투표 합니다.

![미러링 모니터 서버가 포함 된 세 개의 노드가 있는 경우에 설명 된 쿼럼](media/understand-quorum/3-node-witness.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 발생 시킬 수 있습니다. **예**.
- 한 번에 두 개의 서버 **오류를 존속**시킬 수 있습니다. 

#### <a name="four-nodes-without-a-witness"></a>미러링 모니터 서버가 없는 4 개 노드
한 노드의 투표는 0이 되므로 *과반수* 는 총 **3 개 투표**중에서 결정 됩니다. 한 번의 실패 후에는 클러스터가 3 개의 노드가 되며 시나리오 3에 있습니다.

![미러링 모니터 서버가 없는 4 개 노드를 사용 하는 경우에 설명 된 쿼럼](media/understand-quorum/4-node-no-witness.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 발생 시킬 수 있습니다. **예**.
- 두 서버 오류를 한 번에 **50%** 까지 존속 시킬 수 있습니다. 

#### <a name="four-nodes-with-a-witness"></a>미러링 모니터 서버가 있는 4 개 노드
모든 노드는 응답 하 고 감시를 투표 하므로 *과반수* 는 총 **5 개 투표**중에서 결정 됩니다. 한 번 실패 한 후에는 시나리오 4에 있습니다. 두 번의 동시 실패 후에는 시나리오 2로 건너뜁니다.

![미러링 모니터 서버가 있는 4 개의 노드가 있는 경우에 설명 된 쿼럼](media/understand-quorum/4-node-witness.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 발생 시킬 수 있습니다. **예**.
- 한 번에 두 개의 서버 오류를 존속 시킬 수 있습니다. **예**. 

#### <a name="five-nodes-and-beyond"></a>5 개 노드 이상
모든 노드는 투표를 하나 이상 투표 하 여 총 홀수를 만듭니다. 그러나 두 개 이상의 노드를 처리할 수 없기 때문에이 시점에서 미러링 모니터 서버가 필요 하지 않거나 유용 하지 않습니다. 스토리지 공간 다이렉트

![5 개 노드 이상이 있는 경우의 쿼럼 설명](media/understand-quorum/5-nodes.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 발생 시킬 수 있습니다. **예**.
- 한 번에 두 개의 서버 오류를 존속 시킬 수 있습니다. **예**. 

쿼럼을 어떻게 작동 하는지 이해 했으므로 쿼럼 미러링 모니터 서버의 유형을 살펴보겠습니다.

### <a name="quorum-witness-types"></a>쿼럼 감시 유형

장애 조치 (Failover) 클러스터링은 세 가지 유형의 쿼럼 미러링 모니터 서버을 지원 합니다.

- **[클라우드 감시](../../failover-clustering/deploy-cloud-witness.md)** -클러스터의 모든 노드에서 액세스할 수 있는 Azure의 Blob 저장소입니다. 이는 감시 파일에 클러스터링 정보를 유지 하지만 클러스터 데이터베이스의 복사본은 저장 하지 않습니다.
- **파일 공유 감시** – Windows server를 실행 하는 파일 서버에 구성 된 SMB 파일 공유입니다. 이는 감시 파일에 클러스터링 정보를 유지 하지만 클러스터 데이터베이스의 복사본은 저장 하지 않습니다.
- **디스크 감시** -클러스터에서 사용할 수 있는 저장소 그룹에 있는 작은 클러스터 된 디스크입니다. 이 디스크는 항상 사용 가능 하며 노드 간에 장애 조치 (failover) 할 수 있습니다. 클러스터 데이터베이스의 복사본을 포함 합니다.  ***디스크 감시는 스토리지 공간 다이렉트 지원 되지 않습니다***.

## <a name="pool-quorum-overview"></a>풀 쿼럼 개요

클러스터 수준에서 작동 하는 클러스터 쿼럼에 대해 언급 했습니다. 이제 풀 수준에서 작동 하는 풀 쿼럼을 살펴보겠습니다 (즉, 노드 및 드라이브를 손실 하 고 풀을 계속 사용할 수 있음). 저장소 풀은 클러스터 된 시나리오와 비클러스터형 시나리오 모두에서 사용 하도록 설계 되었습니다. 즉, 서로 다른 쿼럼 메커니즘이 있습니다.

아래 표에서는 시나리오 별로 풀 쿼럼 결과의 개요를 제공 합니다.

| 서버 노드 | 단일 서버 노드 오류를 존속 시킬 수 있습니다. | 서버 노드 실패가 발생할 수 있습니다. | 두 개의 동시 서버 노드가 실패할 수 있습니다. |
|--------------|-------------------------------------|---------------------------------------------------|----------------------------------------------------|
| 2            | 아니요                                  | 아니요                                                | 아니요                                                 |
| 2 + 미러링 모니터  | 예                                 | 아니요                                                | 아니요                                                 |
| 3            | 예                                 | 아니요                                                | 아니요                                                 |
| 3 + 미러링 모니터 서버  | 예                                 | 아니요                                                | 아니요                                                 |
| 4            | 예                                 | 아니요                                                | 아니요                                                 |
| 4 + 미러링 모니터 서버  | 예                                 | 예                                               | 예                                                |
| 5 이상  | 예                                 | 예                                               | 예                                                |

## <a name="how-pool-quorum-works"></a>풀 쿼럼을 작동 하는 방법

드라이브에 오류가 발생 하거나 일부 드라이브 하위 집합이 다른 하위 집합과의 연결을 잃은 경우 남은 드라이브는 풀의 *대부분이* 온라인 상태로 유지 되는지 확인 해야 합니다. 확인할 수 없는 경우 오프 라인으로 전환 됩니다. 풀은 쿼럼에 대 한 충분 한 디스크 (50% + 1)를 기반으로 오프 라인으로 전환 되거나 온라인 상태를 유지 하는 엔터티입니다. 풀 리소스 소유자 (활성 클러스터 노드)는 + 1 일 수 있습니다.

그러나 풀 쿼럼은 다음과 같은 방식으로 클러스터 쿼럼과 다르게 작동 합니다.

- 풀은 클러스터에서 한 노드를 미러링 모니터로 사용 하 여 드라이브의 절반 (풀 리소스 소유자 인 노드)을 그대로 유지 합니다.
- 풀에 동적 쿼럼이 없습니다.
- 풀에서 자체 버전의 응답 제거를 구현 하지 않습니다.

### <a name="examples"></a>예

#### <a name="four-nodes-with-a-symmetrical-layout"></a>대칭 레이아웃을 사용 하는 4 개 노드 
16 개의 드라이브는 각각 하나의 투표를 포함 하 고 노드 2는 하나의 투표를 가집니다 (풀 리소스 소유자 이므로). *과반수* 는 총 **16 개 투표**중에서 결정 됩니다. 3 및 4 노드가 다운 된 경우 남은 하위 집합에는 8 개의 드라이브와 풀 리소스 소유자 (9/16 투표)가 있습니다. 따라서 풀이 살아 있습니다.

![풀 쿼럼 1](media/understand-quorum/pool-1.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 발생 시킬 수 있습니다. **예**.
- 한 번에 두 개의 서버 오류를 존속 시킬 수 있습니다. **예**. 

#### <a name="four-nodes-with-a-symmetrical-layout-and-drive-failure"></a>대칭 레이아웃 및 드라이브 오류가 있는 4 개의 노드 
16 개의 드라이브는 각각 하나의 투표를 포함 하 고 노드 2는 풀 리소스 소유자 이므로 하나의 투표를 가집니다. *과반수* 는 총 **16 개 투표**중에서 결정 됩니다. 먼저, 드라이브 7이 다운 됩니다. 3 및 4 노드가 다운 된 경우 남은 하위 집합에는 7 개의 드라이브와 풀 리소스 소유자 (8/16 투표)가 있습니다. 따라서 풀에 과반수가 없고 작동이 중단 됩니다.

![풀 쿼럼 2](media/understand-quorum/pool-2.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 서버 장애를 존속 시킬 수 **있습니다.**
- 한 번에 두 개의 서버 **오류를 존속**시킬 수 있습니다. 

#### <a name="four-nodes-with-a-non-symmetrical-layout"></a>비 대칭 레이아웃을 사용 하는 4 개 노드 
각각의 24 개 드라이브에는 하나의 응답이 있으며 노드 2에는 하나의 투표 (풀 리소스 소유자 이므로)가 있습니다. *과반수* 는 총 **24 개 투표**중에서 결정 됩니다. 3 및 4 노드가 다운 된 경우 남은 하위 집합에는 8 개의 드라이브와 풀 리소스 소유자 (9/24 투표)가 있습니다. 따라서 풀에 과반수가 없고 작동이 중단 됩니다.

![풀 쿼럼 3](media/understand-quorum/pool-3.png)

- 한 서버에서 계속 실패할 수 있음: **예**.
- 한 번의 서버 장애를 발생 시킬 수 있습니다. * *은 (는) * *를 사용할 수 있습니다. * *는 노드 3과 4가 모두 다운 되어도 존속 될 수 없지만 다른 모든 시나리오는 계속 사용할 수
- 한 번에 두 서버 장애를 계속 진행할 수 있습니다. * *은 (는) 두 노드를 세 번 이상 사용할 수 없습니다.

### <a name="pool-quorum-recommendations"></a>풀 쿼럼 권장 사항

- 클러스터의 각 노드가 대칭 (각 노드의 드라이브 수는 동일) 인지 확인 합니다.
- 3 방향 미러 또는 이중 패리티를 사용 하도록 설정 하 여 노드 오류를 허용 하 고 가상 디스크를 온라인 상태로 유지할 수 있습니다. 자세한 내용은 [볼륨 지침 페이지](plan-volumes.md) 를 참조 하세요.
- 두 개 이상의 노드가 다운 되었거나 두 개의 노드와 다른 노드의 디스크가 다운 된 경우 볼륨은 해당 데이터의 모든 복사본에 액세스 하지 못할 수 있으므로 오프 라인으로 전환 되 고 사용할 수 없게 됩니다. 볼륨의 모든 데이터에 대 한 복원 력을 극대화 하기 위해 서버를 다시 가져오거나 디스크를 빠르게 교체 하는 것이 좋습니다.

## <a name="more-information"></a>자세한 정보

- [쿼럼 구성 및 관리](../../failover-clustering/manage-cluster-quorum.md)
- [클라우드 감시 배포](../../failover-clustering/deploy-cloud-witness.md)
