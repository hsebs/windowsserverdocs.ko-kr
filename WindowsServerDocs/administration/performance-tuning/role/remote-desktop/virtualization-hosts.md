---
title: 원격 데스크톱 가상화 호스트 성능 조정
description: 원격 데스크톱 가상화 호스트에 대 한 성능 조정
ms.prod: windows-server
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: hammadbu; vladmis; denisgun
author: phstee
ms.date: 10/22/2019
ms.openlocfilehash: 2a0db4d890a01df13c44a9bb7adfbd13bebbdde0
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80851706"
---
# <a name="performance-tuning-remote-desktop-virtualization-hosts"></a>원격 데스크톱 가상화 호스트 성능 조정

원격 데스크톱 가상화 호스트 (RD 가상화 호스트)는 VDI (가상 데스크톱 인프라) 시나리오를 지원 하 고 여러 사용자가 Windows Server 및 Hyper-v를 실행 하는 서버에서 호스트 되는 가상 컴퓨터에서 Windows 기반 응용 프로그램을 실행할 수 있도록 하는 역할 서비스입니다.

Windows Server는 개인 가상 데스크톱 및 풀링된 가상 데스크톱 이라는 두 가지 유형의 가상 데스크톱을 지원 합니다.

## <a name="general-considerations"></a>일반적인 고려 사항

### <a name="storage"></a>저장 공간

저장소는 가장 가능성이 높은 성능 병목 현상 이므로 저장소 크기를 조정 하 여 가상 머신 상태 변경에 의해 생성 된 i/o 로드를 적절 하 게 처리 해야 합니다. 파일럿 또는 시뮬레이션을 사용할 수 없는 경우 4 개의 활성 가상 머신에 대해 하나의 디스크 스핀 들을 프로 비전 하는 것이 좋습니다. 쓰기 성능이 좋은 디스크 구성 (예: RAID 1 + 0)을 사용 합니다.

디스크 중복 제거 및 캐싱을 사용 하 여 디스크 읽기 부하를 줄이고 저장소 솔루션을 사용 하 여 이미지의 상당 부분을 캐싱하여 성능을 향상 시킬 수 있도록 하는 것이 좋습니다.

### <a name="data-deduplication-and-vdi"></a>데이터 중복 제거 및 VDI

Windows Server 2012 r 2에서 도입 된 데이터 중복 제거는 열려 있는 파일의 최적화를 지원 합니다. 중복 제거 된 볼륨에서 실행 되는 가상 컴퓨터를 사용 하려면 가상 컴퓨터 파일을 Hyper-v 호스트와는 별도의 호스트에 저장 해야 합니다. Hyper-v와 중복 제거를 동일한 컴퓨터에서 실행 하는 경우 두 기능이 시스템 리소스에 대해 경합 하 고 전반적인 성능에 부정적인 영향을 줍니다.

또한 "VDI (가상 데스크톱 인프라)" 중복 제거 최적화 유형을 사용 하도록 볼륨을 구성 해야 합니다. 다음 Windows PowerShell 명령을 사용 하 여 서버 관리자 (**파일 및 저장소 서비스** -&gt; **볼륨** 을 -&gt; **중복 제거 설정**)를 사용 하 여이를 구성할 수 있습니다.

``` syntax
Enable-DedupVolume <volume> -UsageType HyperV
```

> [!NOTE]
> 열려 있는 파일의 데이터 중복 제거 최적화는 SMB 3.0를 통한 원격 저장소를 사용 하는 Hyper-v가 포함 된 VDI 시나리오 에서만 지원 됩니다.

### <a name="memory"></a>메모리

서버 메모리 사용량은 세 가지 주요 요소를 기반으로 합니다.

- 운영 체제 오버 헤드

- 가상 컴퓨터당 hyper-v 서비스 오버 헤드

- 각 가상 컴퓨터에 할당 된 메모리

일반적인 지식 근로자 작업의 경우 x86 Window 8 또는 Windows 8.1를 실행 하는 게스트 가상 컴퓨터를 기준으로 512 ~의 메모리를 제공 해야 합니다. 그러나 동적 메모리는 워크 로드에 따라 게스트 가상 컴퓨터의 메모리를 약 800 MB로 늘릴 수 있습니다. X 64의 경우 약 800 MB의 시작, 1024 MB로 확장을 참조 하세요.

따라서 필요한 수의 게스트 가상 컴퓨터에 필요한 메모리를 충족 하기에 충분 한 서버 메모리를 제공 하 고 서버에 충분 한 메모리를 허용 하는 것이 중요 합니다.

### <a name="cpu"></a>CPU

RD 가상화 호스트 서버에 대 한 서버 용량을 계획 하는 경우 실제 코어 당 가상 머신 수는 워크 로드의 특성에 따라 달라 집니다. 처음에는 물리적 코어 당 12 개의 가상 머신을 계획 한 후 적절 한 시나리오를 실행 하 여 성능과 밀도의 유효성을 검사 하는 것이 합리적입니다. 작업의 세부 사항에 따라 더 높은 밀도를 달성할 수 있습니다.

하이퍼 스레딩을 사용 하도록 설정 하는 것이 좋지만 논리적 프로세서 수가 아니라 실제 코어 수를 기준으로 하 여 초과 구독 비율을 계산 해야 합니다. 이렇게 하면 CPU 별로 예상 수준의 성능이 보장 됩니다.

## <a name="performance-optimizations"></a>성능 최적화

### <a name="dynamic-memory"></a>동적 메모리

동적 메모리를 사용 하면 실행 중인 가상 컴퓨터 간에 메모리를 분산 하는 방법을 분산 하 여 Hyper-v를 실행 하는 서버의 메모리 리소스를 보다 효율적으로 활용할 수 있습니다. 변경 작업에 대 한 응답으로 가상 컴퓨터 간에 메모리를 동적으로 다시 할당할 수 있습니다.

동적 메모리를 사용 하면 성능 또는 확장성을 저하 시 키 지 않고 이미 보유 한 리소스를 사용 하 여 가상 컴퓨터 밀도를 늘릴 수 있습니다. 결과적으로 비용이 많이 드는 서버 하드웨어 리소스를 보다 효율적으로 사용 하 여 더 쉽게 관리 하 고 비용을 절감할 수 있습니다.

여러 논리 프로세서를 포함 하는 가상 프로세서와 함께 Windows 8 이상을 실행 하는 게스트 운영 체제에서는 메모리 사용을 최소화 하 고 동적 메모리을 사용 하지 않도록 설정 하 여 컴퓨터에서 인식 하는 응용 프로그램의 성능을 향상 시킬 수 있도록 동적 메모리와의 실행 간 균형을 고려해 야 합니다. 이러한 응용 프로그램은 토폴로지 정보를 활용 하 여 일정 예약 및 메모리 할당 결정을 내릴 수 있습니다.

### <a name="tiered-storage"></a>계층화된 저장소

RD 가상화 호스트는 가상 데스크톱 풀에 대해 계층화 된 저장소를 지원 합니다. 컬렉션 내의 풀링된 모든 가상 데스크톱에서 공유 하는 물리적 컴퓨터는 미러된 SSD (반도체 드라이브)와 같은 소형 고성능 저장소 솔루션을 사용할 수 있습니다. 풀링된 가상 데스크톱은 RAID 1 + 0과 같은 저렴 한 기존 저장소에 배치할 수 있습니다.

물리적 컴퓨터는 풀링된 가상 데스크톱의 읽기-i/o 대부분이 관리 운영 체제로 이동 하기 때문에 SSD에 배치 해야 합니다. 따라서 물리적 컴퓨터에서 사용 하는 저장소는 초당 훨씬 더 많은 읽기 i/o를 유지 해야 합니다.

이 배포 구성은 성능이 필요한 경우 비용 효율적인 성능을 보장 합니다. SSD는 더 작은 크기의 디스크에서 더 높은 성능을 제공 합니다 (구성에 따라 컬렉션 당 20 GB 당). 풀링된 가상 데스크톱에 대 한 기존 저장소 (RAID 1 + 0)는 가상 머신 당 약 3gb를 사용 합니다.

### <a name="csv-cache"></a>CSV 캐시

Windows Server 2012 이상에서 장애 조치 (Failover) 클러스터링은 CSV (클러스터 공유 볼륨)에 대 한 캐싱을 제공 합니다. 이는 대부분의 읽기 i/o가 관리 운영 체제에서 제공 되는 풀링된 가상 데스크톱 컬렉션에 매우 유용 합니다. CSV 캐시는 두 번 이상 읽은 블록을 캐시 하 고 시스템 메모리에서 배달 하므로 i/o를 줄일 수 있기 때문에 몇 가지 크기의 성능을 제공 합니다. CSV 캐시에 대 한 자세한 내용은 [Csv 캐시를 사용 하도록 설정 하는 방법](https://blogs.msdn.com/b/clustering/archive/2012/03/22/10286676.aspx)을 참조 하세요.

### <a name="pooled-virtual-desktops"></a>풀링된 가상 데스크톱

기본적으로 풀링된 가상 데스크톱은 사용자가 로그 아웃 한 후에 초기 상태로 롤백되고 마지막 사용자 로그인 이후에 Windows 운영 체제에서 변경한 내용이 모두 중단 됩니다.

롤백을 사용 하지 않도록 설정할 수 있지만, 일반적으로 가상 데스크톱 템플릿에 대 한 다양 한 업데이트로 인해 풀링된 가상 데스크톱 컬렉션이 다시 만들어지기 때문에 일시적인 상태입니다.

영구적 상태에 종속 된 Windows 기능 및 서비스를 해제 하는 것이 좋습니다. 또한 주로 엔터프라이즈가 아닌 시나리오에 사용 되는 서비스를 해제 하는 것이 좋습니다.

광범위 한 배포 전에 각 특정 서비스를 적절 하 게 평가 해야 합니다. 다음은 몇 가지 초기 고려해 야 할 사항입니다.

| Service                                      | 이유                                                                                                                                                                                                      |
|----------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 자동 업데이트                                  | 풀링된 가상 데스크톱은 가상 데스크톱 템플릿을 다시 만들어 업데이트 됩니다.                                                                                                                          |
| 오프라인 파일                                | 가상 데스크톱은 항상 온라인 상태 이며 네트워킹 관점에서 연결 됩니다.                                                                                                                         |
| 백그라운드 조각 모음                            | 사용자가 로그 오프 한 후 파일 시스템 변경 내용이 삭제 됩니다 (초기 상태로 롤백 또는 가상 데스크톱 템플릿 다시 만들기로 인해 풀링된 모든 가상 데스크톱이 다시 생성 됨). |
| 최대 절전 모드 또는 절전 모드                           | VDI에 대 한 이러한 개념 없음                                                                                                                                                                                   |
| 버그 확인 메모리 덤프                        | 풀링된 가상 데스크톱에 대 한 이러한 개념은 없습니다. 버그 확인 풀링된 가상 데스크톱이 초기 상태에서 시작 됩니다.                                                                                       |
| WLAN 자동 구성                              | VDI 용 WiFi 장치 인터페이스가 없습니다.                                                                                                                                                                 |
| Windows Media Player 네트워크 공유 서비스 | 소비자 중심 서비스                                                                                                                                                                                  |
| 홈 그룹 공급자                          | 소비자 중심 서비스                                                                                                                                                                                  |
| 인터넷 연결 공유                  | 소비자 중심 서비스                                                                                                                                                                                  |
| Media Center 확장 서비스               | 소비자 중심 서비스                                                                                                                                                                                  |
> [!NOTE]
> 모든 변경 내용이 의도 된 목표 및 시나리오에 영향을 주므로이 목록은 전체 목록이 아닙니다. 자세한 내용은 [PFE!를 제공 하는 즉시 누름, 지금 가져오기, Windows 8 VDI 최적화 스크립트](https://blogs.technet.com/b/jeff_stokes/archive/2013/04/09/hot-off-the-presses-get-it-now-the-windows-8-vdi-optimization-script-courtesy-of-pfe.aspx)를 참조 하세요.


> [!NOTE]
> Windows 8의 SuperFetch는 기본적으로 사용 하도록 설정 되어 있습니다. VDI에서 인식 하므로 사용 하지 않도록 설정 하면 안 됩니다. SuperFetch는 VDI에 유용한 메모리 페이지 공유를 통해 메모리 사용을 더 줄일 수 있습니다. Windows 7을 실행 하는 풀링된 가상 데스크톱은 SuperFetch를 사용 하지 않도록 설정 해야 합니다. 그러나 Windows 7을 실행 하는 개인용 가상 데스크톱의 경우에는 그대로 두어야 합니다.
