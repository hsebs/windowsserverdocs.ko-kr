---
ms.assetid: b11f7a65-ec7b-4c11-8dc4-d7cabb54cd94
title: Active Directory 복제 문제 해결
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adds
ms.openlocfilehash: a3e9c3e901f164d793ca40943934efbbccafda38
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80822966"
---
# <a name="troubleshooting-active-directory-replication-problems"></a>Active Directory 복제 문제 해결

>적용 대상: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Active Directory 복제 문제에는 여러 가지 원본이 있을 수 있습니다. 예를 들어 DNS (Domain Name System) 문제, 네트워킹 문제 또는 보안 문제로 인해 Active Directory 복제가 실패할 수 있습니다. 

이 항목의 나머지 부분에서는 도구와 Active Directory 복제 오류를 해결 하는 일반적인 방법을 설명 합니다. 다음 하위 항목에서는 증상, 원인 및 특정 복제 오류를 해결 하는 방법을 다룹니다.

## <a name="introduction-and-resources-for-troubleshooting-active-directory-replication"></a>Active Directory 복제 문제 해결을 위한 소개 및 리소스

인바운드 또는 아웃 바운드 복제 실패로 Active Directory 인해 복제 토폴로지, 복제 일정, 도메인 컨트롤러, 사용자, 컴퓨터, 암호, 보안 그룹, 그룹 멤버 자격 및 그룹 정책을 나타내는 개체가 도메인 컨트롤러 간에 일치 하지 않습니다. 디렉터리 불일치 및 복제 실패로 인해 작업에 연결 된 도메인 컨트롤러에 따라 작동 실패 또는 일관 되지 않은 결과가 발생 하 여 그룹 정책 및 액세스 제어 권한을 응용 프로그램에서 차단할 수 있습니다. Active Directory Domain Services (AD DS)는 네트워크 연결, 이름 확인, 인증 및 권한 부여, 디렉터리 데이터베이스, 복제 토폴로지 및 복제 엔진에 따라 달라 집니다. 복제 문제의 근본 원인이 즉시 명확 하지 않은 경우 가능한 여러 원인 중에서 원인을 파악 하려면 가능한 원인을 체계적으로 제거 해야 합니다.

복제를 모니터링 하 고 오류를 진단 하는 데 도움이 되는 UI 기반 도구는 [Active Directory 복제 상태 도구](https://www.microsoft.com/download/details.aspx?id=30005) 를 참조 하세요.

Repadmin 도구를 사용 하 여 Active Directory 문제를 해결 하는 방법을 설명 하는 포괄적인 문서는 복제를 사용할 수 있습니다. [Repadmin을 사용 하 여 Active Directory 복제 모니터링 및 문제 해결을](https://go.microsoft.com/fwlink/?LinkId=122830)참조 하세요.

Active Directory 복제가 작동 하는 방법에 대 한 자세한 내용은 다음 기술 참조를 참조 하세요.

- [Active Directory 복제 모델 기술 참조](https://go.microsoft.com/fwlink/?LinkId=65958)
- [Active Director 복제 토폴로지 기술 참조](https://go.microsoft.com/fwlink/?LinkId=93578)

## <a name="event-and-tool-solution-recommendations"></a>이벤트 및 도구 솔루션 권장 사항

이상적으로, 디렉터리 서비스 이벤트 로그의 빨간색 (오류) 및 노란색 (경고) 이벤트는 원본 또는 대상 도메인 컨트롤러에서 복제 실패를 야기 하는 특정 제약 조건을 제안 합니다. 이벤트 메시지가 솔루션에 대 한 단계를 제안 하는 경우 이벤트에 설명 된 단계를 수행 합니다. 또한 Repadmin 도구 및 기타 진단 도구는 복제 오류를 해결 하는 데 도움이 되는 정보를 제공 합니다. 

복제 문제 해결에 Repadmin을 사용 하는 방법에 대 한 자세한 내용은 [repadmin을 사용 하 여 Active Directory 복제 모니터링 및 문제 해결](https://go.microsoft.com/fwlink/?LinkId=122830)을 참조 하세요.

## <a name="ruling-out-intentional-disruptions-or-hardware-failures"></a>의도적인 장애 또는 하드웨어 오류 배제

의도적인 중단으로 인해 복제 오류가 발생 하는 경우도 있습니다. 예를 들어 Active Directory 복제 문제를 해결 하는 경우 의도적인 연결이 나 하드웨어 오류 또는 업그레이드를 먼저 규칙으로 처리 합니다.

### <a name="intentional-disconnections"></a>의도적인 연결이 끊김

준비 사이트에서 빌드된 도메인 컨트롤러를 사용 하 여 복제를 시도 하는 도메인 컨트롤러에서 복제 오류를 보고 하 고 현재 최종 프로덕션 사이트 (지점 등의 원격 사이트)에서 해당 배포를 대기 하 고 있는 경우 해당 복제 오류를 확인할 수 있습니다. 도메인 컨트롤러를 다시 연결할 때까지 연속 오류가 발생 하는 확장 기간 동안 도메인 컨트롤러를 복제 토폴로지에서 분리 하지 않으려면 먼저 해당 컴퓨터를 구성원 서버로 추가 하 고 IFM (미디어에서 설치) 방법을 사용 하 여 Active Directory Domain Services (AD DS)를 설치 하는 것이 좋습니다. Ntdsutil 명령줄 도구를 사용 하 여 이동식 미디어 (CD, DVD 또는 기타 미디어)에 저장 하 고 대상 사이트에 제공할 수 있는 설치 미디어를 만들 수 있습니다. 그런 다음, 복제를 사용 하지 않고 설치 미디어를 사용 하 여 사이트의 도메인 컨트롤러에 AD DS를 설치할 수 있습니다. 

### <a name="hardware-failures-or-upgradestitle"></a>하드웨어 오류 또는 업그레이드</title>

하드웨어 오류로 인해 복제 문제가 발생 한 경우 (예: 마더보드, 디스크 하위 시스템 또는 하드 드라이브의 오류) 하드웨어 문제를 해결할 수 있도록 서버 소유자에 게 알립니다.

정기적 하드웨어 업그레이드는 도메인 컨트롤러의 서비스를 중단 시킬 수도 있습니다. 서버 소유자에 게 이러한 중단을 미리 전달 하는 좋은 시스템이 있는지 확인 합니다.

### <a name="firewall-configuration"></a>방화벽 구성

기본적으로 Active Directory 복제 Rpc (원격 프로시저 호출)는 포트 135에서 RPCSS (RPC 끝점 매퍼)를 통해 사용 가능한 포트를 통해 동적으로 발생 합니다. 고급 보안이 포함 된 Windows 방화벽 및 기타 방화벽이 복제를 허용 하도록 올바르게 구성 되어 있는지 확인 합니다. Active Directory 복제 및 포트 설정에 대 한 포트를 지정 하는 방법에 대 한 자세한 내용은 [Microsoft 기술 자료 문서 224196](https://go.microsoft.com/fwlink/?LinkId=22578)를 참조 하십시오. 

Active Directory 복제에서 사용 하는 포트에 대 한 자세한 내용은 [Active Directory 복제 도구 및 설정](https://go.microsoft.com/fwlink/?LinkId=123774)을 참조 하세요.

방화벽을 통한 Active Directory 복제를 관리 하는 방법에 대 한 자세한 내용은 [방화벽을 통한 복제 Active Directory](https://go.microsoft.com/fwlink/?LinkId=123775)를 참조 하세요.

## <a name="responding-to-failure-of-an-outdated-server-running-windows-2000-server"></a>Windows 2000 서버를 실행 하는 오래 된 서버 실패에 대 한 응답

Windows 2000 서버를 실행 하는 도메인 컨트롤러가 삭제 표시 수명 기간 (일) 보다 오래 실패 한 경우 솔루션은 항상 동일 합니다. 

1. 서버를 회사 네트워크에서 개인 네트워크로 이동 합니다.
2. Active Directory를 강제로 제거 하거나 운영 체제를 다시 설치 합니다.
3. 서버 개체를 다시 수 없도록 Active Directory에서 서버 메타 데이터를 제거 합니다. 

스크립트를 사용 하 여 대부분의 Windows 운영 체제에서 서버 메타 데이터를 정리할 수 있습니다. 이 스크립트를 사용 하는 방법에 대 한 자세한 내용은 [Active Directory 도메인 컨트롤러 메타 데이터 제거](https://go.microsoft.com/fwlink/?LinkID=123599)를 참조 하세요. 

기본적으로 삭제 된 NTDS 설정 개체는 14 일 동안 자동으로 다시 됩니다. 따라서 서버 메타 데이터를 제거 하지 않는 경우 (이전에 설명한 Ntdsutil 또는 스크립트를 사용 하 여 메타 데이터 정리를 수행 하는 경우), 서버 메타 데이터가 디렉터리에 복원 되 고,이로 인해 복제 시도가 수행 됩니다. 이 경우 누락 된 도메인 컨트롤러를 사용 하 여 복제할 수 없기 때문에 오류가 영구적으로 기록 됩니다.

## <a name="root-causes"></a>근본 원인

의도적인 연결이 나 하드웨어 오류 및 오래 된 Windows 2000 도메인 컨트롤러를 제외 하는 경우 나머지 복제 문제는 거의 항상 다음과 같은 근본 원인 중 하나입니다.

- 네트워크 연결: 네트워크 연결을 사용할 수 없거나 네트워크 설정이 제대로 구성 되어 있지 않을 수 있습니다.
- 이름 확인: DNS 잘못 된 구성이 복제 오류의 일반적인 원인입니다.
- 인증 및 권한 부여: 도메인 컨트롤러가 복제 파트너에 연결 하려고 할 때 인증 및 권한 부여 문제로 인해 "액세스 거부" 오류가 발생 합니다.
- 디렉터리 데이터베이스 (저장소): 디렉터리 데이터베이스는 복제 제한 시간을 단축 하기에 충분 한 트랜잭션을 빠르게 처리할 수 없습니다.
- 복제 엔진: 사이트 간 복제 일정이 너무 짧으면 복제 큐가 너무 커서 아웃 바운드 복제 일정에 필요한 시간에 처리할 수 없습니다. 이 경우 일부 변경 내용에 대 한 복제는 삭제 표시 수명을 초과 하는 경우에만 무기한으로 지연 될 수 있습니다.
- 복제 토폴로지: 도메인 컨트롤러에는 WAN (wide area network) 또는 VPN (가상 사설망) 연결에 매핑되는 AD DS 사이트 간 링크가 있어야 합니다. 네트워크의 실제 사이트 토폴로지에서 지원 되지 않는 복제 토폴로지의 AD DS에서 개체를 만드는 경우 잘못 구성 된 토폴로지가 필요한 복제는 실패 합니다.

## <a name="general-approach-to-fixing-problems"></a>문제 해결을 위한 일반적인 방법

다음 일반적인 방법을 사용 하 여 복제 문제를 해결 합니다. 

1. 매일 복제 상태를 모니터링 하거나 Repadmin.exe를 사용 하 여 매일 복제 상태를 검색 합니다.
2. 이벤트 메시지 및이 가이드에 설명 된 방법을 사용 하 여 보고 된 오류를 적시에 해결 해 봅니다. 소프트웨어가 문제를 일으킬 수 있는 경우 다른 솔루션을 계속 하기 전에 소프트웨어를 제거 합니다.
3. 복제 실패를 야기 하는 문제를 알려진 방법으로 해결할 수 없는 경우 서버에서 AD DS 제거한 후 AD DS를 다시 설치 합니다. AD DS를 다시 설치 하는 방법에 대 한 자세한 내용은 [도메인 컨트롤러 서비스](https://go.microsoft.com/fwlink/?LinkId=128290)해제를 참조 하세요.
4. 서버가 네트워크에 연결 되어 있는 동안 AD DS를 정상적으로 제거할 수 없는 경우 다음 방법 중 하나를 사용 하 여 문제를 해결 하십시오.

   - DSRM (디렉터리 서비스 복원 모드)에서 강제로 AD DS 제거 하 고 서버 메타 데이터를 정리한 다음 AD DS를 다시 설치 합니다.
   - 운영 체제를 다시 설치 하 고 도메인 컨트롤러를 다시 빌드합니다.

AD DS를 강제로 제거 하는 방법에 대 한 자세한 내용은 [도메인 컨트롤러 강제 제거](https://go.microsoft.com/fwlink/?LinkId=128291)를 참조 하세요.

## <a name="using-repadmin-to-retrieve-replication-statustitle"></a>Repadmin을 사용 하 여 복제 상태 검색</title>

복제 상태는 디렉터리 서비스의 상태를 평가 하는 데 중요 한 방법입니다. 오류가 발생 하지 않고 복제가 작동 하는 경우 온라인 상태인 도메인 컨트롤러를 알고 있어야 합니다. 또한 다음과 같은 시스템 및 서비스가 작동 하 고 있음을 알 수 있습니다.


- DNS 인프라
- Kerberos 인증 프로토콜
- W32time (Windows 시간 서비스)
- RPC (원격 프로시저 호출)
- 네트워크 연결

포리스트에서 모든 도메인 컨트롤러의 복제 상태를 평가 하는 명령을 실행 하 여 매일 복제 상태를 모니터링 하려면 Repadmin을 사용 합니다. 이 프로시저는 Microsoft Excel에서 열 수 있는 .csv 파일을 생성 하 고 복제 실패를 필터링 합니다.

다음 절차를 사용 하 여 포리스트에 있는 모든 도메인 컨트롤러의 복제 상태를 검색할 수 있습니다. 

요구 사항

이 절차를 완료하려면 최소한 **Enterprise Admins** 그룹의 구성원이거나 이와 동등한 자격이 있어야 합니다. 

도구:

- Repadmin.exe
- Excel (Microsoft Office)

### <a name="to-generate-a-repadmin-showrepl-spreadsheet-for-domain-controllers"></a>도메인 컨트롤러에 대 한 repadmin/showrepl 스프레드시트를 생성 하려면

1. 관리자 권한으로 명령 프롬프트 열기: 시작 메뉴에서 명령 프롬프트를 마우스 오른쪽 단추로 클릭 한 다음 관리자 권한으로 실행을 클릭 합니다. 사용자 계정 컨트롤 대화 상자가 나타나면 필요한 경우 엔터프라이즈 관리자 자격 증명을 제공 하 고 계속을 클릭 합니다.
2. 명령 프롬프트에서 다음 명령을 입력 하 고 ENTER 키를 누릅니다. `repadmin /showrepl * /csv > showrepl.csv`
3. Excel을 엽니다.
4. Office 단추를 클릭 하 고 열기를 클릭 한 다음 showrepl .csv로 이동 하 고 열기를 클릭 합니다.
5. 다음과 같이 열 A 및 전송 유형 열을 숨기 거 나 삭제 합니다.
6. 숨기기 또는 삭제 하려는 열을 선택 합니다.

   - 열을 숨기려면 열을 마우스 오른쪽 단추로 클릭 한 다음 숨기기를 클릭 합니다.
   - 열을 삭제 하려면 선택한 열을 마우스 오른쪽 단추로 클릭 한 다음 삭제를 클릭 합니다.

7. 열 머리글 행 아래에서 행 1을 선택 합니다. 보기 탭에서 창 고정을 클릭 한 다음 맨 위 행 고정을 클릭 합니다.
8. 전체 스프레드시트를 선택 합니다. 데이터 탭에서 필터를 클릭 합니다.
9. 마지막 성공 시간 열에서 아래쪽 화살표를 클릭 한 다음 오름차순 정렬을 클릭 합니다.
10. 원본 DC 열에서 필터 아래쪽 화살표를 클릭 하 고 텍스트 필터를 가리킨 다음 사용자 지정 필터를 클릭 합니다.
11. 사용자 지정 자동 필터 대화 상자의 행 표시 위치에서 포함 하지 않음을 클릭 합니다. 인접 텍스트 상자에 <userInput>delete</userInput> 를 입력 하 여 삭제 된 도메인 컨트롤러에 대 한 결과를 볼 수 없게 합니다.
12. 마지막 오류 시간 열에 대해 11 단계를 반복 하 되, 값이 같지 않은 경우에는 값 0을 입력 합니다.
13. 복제 오류를 해결 합니다.

포리스트의 모든 도메인 컨트롤러에 대해 스프레드시트는 원본 복제 파트너, 복제가 마지막으로 발생 한 시간, 각 명명 컨텍스트 (디렉터리 파티션)에 대 한 마지막 복제 실패가 발생 한 시간을 보여 줍니다. Excel에서 자동 필터를 사용 하 여 작업 중인 도메인 컨트롤러에 대 한 복제 상태, 장애 조치 (failover)만 수행 하는 도메인 컨트롤러 또는 가장 최근 인 도메인 컨트롤러에 대 한 복제 상태를 볼 수 있으며 복제 파트너가 성공적으로 복제 되는 것을 볼 수 있습니다.

## <a name="replication-problems-and-resolutions"></a>복제 문제 및 해결 방법

복제 문제는 이벤트 메시지 및 응용 프로그램 또는 서비스에서 작업을 시도할 때 발생 하는 다양 한 오류 메시지에서 보고 됩니다. 이러한 메시지는 모니터링 응용 프로그램에 의해 수집 되거나 복제 상태를 검색 하는 경우에 이상적입니다.

대부분의 복제 문제는 디렉터리 서비스 이벤트 로그에 기록 되는 이벤트 메시지에서 식별 됩니다. 복제 문제는 <system>repadmin/showrepl</system> 명령 출력의 오류 메시지 형식으로도 식별할 수 있습니다.

### <a name="repadmin-showrepl-error-messages-that-indicate-replication-problems"></a>복제 문제를 나타내는 repadmin/showrepl 오류 메시지

Active Directory 복제 문제를 식별 하려면 이전 섹션에 설명 된 대로 <system>repadmin/showrepl</system> 명령을 사용 합니다. 다음 표에서는이 명령이 생성 하는 오류 메시지와 오류의 근본 원인 및 오류에 대 한 해결 방법을 제공 하는 항목에 대 한 링크를 보여 줍니다.

|Repadmin 오류|근본 원인|솔루션|
| --- | --- | --- |
|이 서버와의 마지막 복제 이후 시간이 삭제 표시 수명 기간을 초과 했습니다.|도메인 컨트롤러에서 삭제를 삭제 하 고, 복제 하 고, AD DS에서 가비지 수집 하기에 충분 한 길이의 명명 된 원본 도메인 컨트롤러와의 인바운드 복제에 실패 했습니다.|이벤트 ID 2042: 이 컴퓨터가 복제된 이후 시간이 너무 오래 경과함|
|인바운드 인접 하지 않습니다.|Repadmin/showrepl에서 생성 된 출력의 "인바운드 환경" 섹션에 표시 되는 항목이 없으면 도메인 컨트롤러가 다른 도메인 컨트롤러와의 복제 링크를 설정할 수 없습니다.|복제 연결 문제 해결(이벤트 ID 1925)| 
|액세스가 거부되었습니다.|두 도메인 컨트롤러 간에 복제 링크가 있지만 인증 실패로 인해 복제를 제대로 수행할 수 없습니다.|복제 보안 문제 해결| 
|< 날짜-시간 >에 대 한 마지막 시도가 "대상 계정 이름이 올바르지 않습니다."로 인해 실패 했습니다.|이 문제는 연결, DNS 또는 인증 문제와 관련이 있을 수 있습니다. DNS 오류 인 경우 로컬 도메인 컨트롤러에서 해당 복제 파트너의 GUID (globally unique identifier) 기반 DNS 이름을 확인할 수 없습니다.|복제 DNS 조회 문제 해결 (이벤트 Id 1925, 2087, 2088) 복제 보안 문제 해결 복제 연결 문제 해결 (이벤트 ID 1925)| 
|LDAP 오류 49.|도메인 컨트롤러 컴퓨터 계정이 KDC (키 배포 센터)와 동기화 되지 않았을 수 있습니다.|복제 보안 문제 해결| 
|로컬 호스트에 대 한 LDAP 연결을 열 수 없습니다.|관리 도구가 AD DS에 연결할 수 없습니다.|복제 DNS 조회 문제 해결(이벤트 ID 1925, 2087, 2088)| 
|Active Directory 복제가 선점 되었습니다.|인바운드 복제 진행률이 repadmin/sync 명령을 사용 하 여 수동으로 생성 된 요청과 같이 우선 순위가 높은 복제 요청에 의해 중단 되었습니다.|복제가 완료 될 때까지 기다립니다. 이 정보 메시지는 정상 작업을 나타냅니다.| 
|복제가 게시 되 고 대기 중입니다.| 도메인 컨트롤러에서 복제 요청을 게시 하 고 응답을 기다리는 중입니다. 이 원본에서 복제가 진행 중입니다.|복제가 완료 될 때까지 기다립니다. 이 정보 메시지는 정상 작업을 나타냅니다.| 

다음 표에서는 문제의 근본 원인과 문제에 대 한 해결 방법을 제공 하는 항목에 대 한 링크와 함께 Active Directory 복제 관련 문제를 나타낼 수 있는 일반적인 이벤트를 보여 줍니다. 

|이벤트 ID 및 원본|근본 원인|솔루션|
| --- | --- | --- | 
|1311 NTDS KCC|AD DS의 복제 구성 정보는 네트워크의 실제 토폴로지를 정확 하 게 반영 하지 않습니다.|복제 토폴로지 문제 해결(이벤트 ID 1311)| 
|1388 NTDS 복제|엄격한 복제 일관성은 적용 되지 않으며, 느린 개체가 도메인 컨트롤러에 복제 됩니다.|복제 느린 개체 문제 해결(이벤트 ID 1388, 1988, 2042)|
|1925 NTDS KCC|쓰기 가능한 디렉터리 파티션에 대 한 복제 링크를 설정 하지 못했습니다. 이 이벤트에는 오류에 따라 다른 원인이 있을 수 있습니다.| 복제 연결 문제 해결 (이벤트 ID 1925) 복제 DNS 조회 문제 해결 (이벤트 Id 1925, 2087, 2088)| 
|1988 NTDS 복제|로컬 도메인 컨트롤러는 삭제 되어 이미 가비지 수집 되었을 수 있으므로 로컬 도메인 컨트롤러에 없는 원본 도메인 컨트롤러에서 개체를 복제 하려고 했습니다. 상황이 해결 될 때까지이 파트너와의이 디렉터리 파티션에 대 한 복제는 진행 되지 않습니다.|복제 느린 개체 문제 해결(이벤트 ID 1388, 1988, 2042)|
|2042 NTDS 복제|이 파트너에 게 삭제 표시 수명에 대 한 복제가 발생 하지 않았으므로 복제를 계속할 수 없습니다.|복제 느린 개체 문제 해결(이벤트 ID 1388, 1988, 2042)| 
|2087 NTDS 복제|AD DS 원본 도메인 컨트롤러의 DNS 호스트 이름을 IP 주소로 확인할 수 없습니다. 복제에 실패 했습니다.|복제 DNS 조회 문제 해결(이벤트 ID 1925, 2087, 2088)| 
|2088 NTDS 복제 |AD DS 원본 도메인 컨트롤러의 DNS 호스트 이름을 IP 주소로 확인할 수 없지만 복제에 성공 했습니다.|복제 DNS 조회 문제 해결(이벤트 ID 1925, 2087, 2088)|
|5805 네트워크 로그온|컴퓨터 계정을 인증 하지 못했습니다. 일반적으로이 오류는 동일한 컴퓨터 이름의 여러 인스턴스 또는 모든 도메인 컨트롤러에 복제 되지 않는 컴퓨터 이름에 의해 발생 합니다.|복제 보안 문제 해결| 

복제 개념에 대 한 자세한 내용은 [Active Directory Replication 기술](https://go.microsoft.com/fwlink/?LinkId=41950)(영문)을 참조 하십시오.
  
## <a name="next-steps"></a>다음 단계

오류 코드와 관련 된 지원 문서를 포함 한 자세한 내용은 지원 문서: [일반적인 Active Directory 복제 오류를 해결 하는 방법](https://support.microsoft.com/help/3108513) 을 참조 하세요.
