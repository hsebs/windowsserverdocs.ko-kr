---
ms.assetid: 77aa61bf-9c04-4889-a5d2-6f45bc1b8bd2
title: 변환 클레임 규칙을 사용하는 경우
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 2b69156d1e2825f4287112735493ebc5cc8469d2
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80853786"
---
# <a name="when-to-use-a-transform-claim-rule"></a>변환 클레임 규칙을 사용하는 경우
들어오는 클레임 유형을 나가는 클레임 유형에 매핑한 후 들어오는 클레임의 값에 따라 발생 해야 하는 출력을 결정 하는 작업을 적용 하는 Active Directory Federation Services \(\) AD FS에서이 규칙을 사용할 수 있습니다. 이 규칙을 사용하는 경우 다음 표에 설명된 대로 규칙에서 구성하는 옵션 중 하나에 따라 다음 규칙 논리와 일치하는 클레임을 통과 또는 변환합니다.  
  
|규칙 옵션|규칙 논리|  
|---------------|--------------|  
|들어오는 모든 클레임 통과|들어오는 클레임 유형이 *지정된 클레임 유형*이고 값이 *임의 값*이면 나가는 클레임 유형이 *지정된 클레임 유형*과 같은 클레임을 통과시킵니다.|  
|들어오는 클레임 값을 다른 나가는 클레임 값으로 바꾸기|들어오는 클레임 유형이 *지정된 클레임 유형*이고 값이 *지정된 클레임 값*이면 새로운 나가는 클레임 값을 *지정된 클레임 값*으로 사용하고 나가는 클레임 유형을 *지정된 클레임 유형*으로 사용하여 클레임을 변환합니다.|  
|들어오는 전자 교체\-접미사를 클레임 새 전자 메일\-메일 접미사|들어오는 클레임 유형이 *지정 된 클레임 형식* 고 값이 *모든 접미사 값*, 다음 새 나가는 클레임 값으로 클레임을 변환 *접미사 값을 지정 된* 와 나가는 클레임 유형 및 *지정 된 클레임 형식*|  
  
다음 섹션에서는 클레임 규칙의 기본 사항을 소개하고 이 규칙을 사용하는 경우에 대한 추가 정보를 제공합니다.  
  
## <a name="about-claim-rules"></a>클레임 규칙 정보  
클레임 규칙은 들어오는 클레임에 조건을 적용 하는 비즈니스 논리의 인스턴스를 나타냅니다 \(다음 y x if\) 조건 매개 변수를 기반으로 하는 나가는 클레임을 생성 합니다. 다음 목록은 이 항목을 더 읽기 전에 클레임 규칙에 대해 알아야 하는 중요한 팁을 간략하게 설명합니다.  
  
-   AD FS 관리 스냅인에서\-클레임 규칙을 다시 만든 클레임 규칙 템플릿을 사용 하 여  
  
-   클레임 규칙 프로세스 들어오는 클레임을 클레임 공급자에서 직접 \(Active Directory 또는 다른 페더레이션 서비스와 같은\) 또는 수용의 출력에서 클레임 공급자 트러스트에 대 한 규칙을 변환 합니다.  
  
-   클레임 규칙은 지정된 규칙 집합 내의 시간 순서대로 클레임 발급 엔진에 의해 처리됩니다. 규칙에 우선 순위를 설정하여 지정된 규칙 집합 내의 이전 규칙에 의해 생성된 클레임을 더욱 구체화하거나 필터링할 수 있습니다.  
  
-   클레임 규칙 템플릿에서는 항상 들어오는 클레임 유형을 지정해야 합니다. 그러나 단일 규칙을 사용하여 동일한 클레임 유형 내의 여러 클레임 값을 처리할 수 있습니다.  
  
클레임 규칙 및 클레임 규칙 집합에 대 한 정보를 자세한 참조 [규칙의 역할 클레임](The-Role-of-Claim-Rules.md)합니다. 규칙은 처리 하는 방법에 대 한 자세한 내용은 참조 [클레임 엔진의 역할](The-Role-of-the-Claims-Engine.md)합니다. 자세한 내용은 클레임 규칙 집합을 처리 하는 방법을 참조 하십시오 [클레임 파이프라인의 역할](The-Role-of-the-Claims-Pipeline.md)합니다.  
  
## <a name="pass-through-all-claim-values"></a>모든 클레임 값 통과  
이 작업을 사용하는 경우 페더레이션 서비스에 의해 서명된 토큰으로 나가는 클레임으로 전송되기 전에 지정된 들어오는 클레임 유형에 키가 지정된 들어오는 클레임 값이 모두 지정된 나가는 클레임 유형에 매핑됩니다.  
  
규칙으로 설정 된 경우에 예를 들어는 **클레임 값 통과 모든** 옵션 논리와 들어오는 클레임 그룹의 유형 및 지정 된 역할의 나가는 클레임 형식, 발급자 로부터 전달 하는 모든 들어오는 클레임 값은 역할 클레임 유형에 사용 하는 새 나가는 클레임에 개별적으로 복사 됩니다.  
  
## <a name="transforming-a-claim"></a>클레임 변환  
Ad FS 용어 *클레임 변환* 수단을 대체 한 들어오는 클레임 다른 나가는 클레임 값을 갖는 값입니다. 이 기능을 가능하게 하는 것은 들어오는 클레임 변환 규칙입니다. 이 규칙의 속성 내에서 지정된 들어오는 클레임 유형에 따라 들어오는 값을 다른 나가는 클레임 값으로 변환하는 조건을 설정할 수 있습니다.  
  
예를 들어 다음 그림과 같이 들어오는 값을 다른 나가는 클레임 값으로 바꾸는 조건을 사용하여 규칙을 설정하는 경우 들어오는 클레임 유형 그룹이 모두 새로운 나가는 클레임 유형 역할에 매핑됩니다. 이 경우 들어오는 클레임 값 Purchaser가 새로운 나가는 클레임 값 Admin으로 바뀝니다.  
  
![변환을 사용 하는 경우](media/adfs2_transform.gif)  
  
들어오는 클레임을 모두 지정된 e로 대체 하는 조건을 적용 하려면이 규칙을 사용할 수도 있습니다\-메일 접미사 값과 새 값입니다. 예를 들어 접미사가 sales.corp.fabrikam.com인 모든 클레임 값을 fabrikam.com으로 변경하는 조건을 이 규칙에 설정할 수 있습니다.  
  
## <a name="configuring-this-rule-on-a-claims-provider-trust"></a>클레임 공급자 트러스트에서 이 규칙 구성  
클레임 공급자 트러스트를 사용하는 경우 클레임 공급자에서 들어오는 클레임을 신뢰할 수 있는 해당 항목으로 변환하도록 이 규칙을 구성할 수 있습니다. 클레임 유형 또는 클레임 값의 의미가 클레임 공급자 조직과 사용자 조직에서 다를 수 있습니다. 이 규칙을 사용하여 클레임 공급자에서 들어오는 클레임 유형 및 값을 정규화하면 신뢰 당사자가 해당 나가는 클레임을 이해할 수 있습니다.  
  
## <a name="configuring-this-rule-on-a-relying-party-trust"></a>신뢰 당사자 트러스트에서 이 규칙 구성  
신뢰 당사자 트러스트를 사용하는 경우 특정 신뢰 당사자에 대한 클레임을 변환하도록 이 규칙을 구성할 수 있습니다. 클레임 유형 또는 클레임 값의 의미가 특정 신뢰 당사자에서 다를 수 있으며, 이 규칙을 사용하면 단일 신뢰 당사자에 대해 나가는 클레임 유형 및 값을 변경할 수 있습니다.  
  
## <a name="how-to-create-this-rule"></a>이 규칙을 만드는 방법  
또는 클레임 규칙 언어를 사용 하 여이 규칙을 만들면는 **들어오는 클레임 변환** AD FS 관리 스냅인에서 규칙 템플릿을\-에 있습니다. 이 규칙 템플릿은 다음과 같은 구성 옵션을 제공합니다.  
  
-   클레임 규칙 이름 지정  
  
-   특정 들어오는 클레임 유형을 지정된 나가는 클레임 유형으로 변환  
  
-   모든 클레임 값 통과  
  
-   들어오는 클레임 값을 다른 나가는 클레임 값으로 바꾸기  
  
-   들어오는 전자 바꾸기\-접미사를 클레임 새 전자 메일\-메일 접미사  
  
이 서식 파일을 만드는 방법에 대 한 자세한 내용은 참조 하십시오. [들어오는 클레임 변환 하는 규칙을 만들](https://technet.microsoft.com/library/dd807068.aspx) AD FS 배포 가이드에 있습니다.  
  
## <a name="using-the-claim-rule-language"></a>클레임 규칙 언어 사용  
둘 이상의 들어오는 클레임 내용에서 나가는 클레임을 생성해야 하는 경우 대신 사용자 지정 규칙을 사용해야 합니다. 나가는 클레임의 클레임 값이 들어오는 클레임 값을 기반으로 해야 하지만 추가 콘텐츠도 포함해야 하는 경우에도 사용자 지정 규칙을 사용해야 합니다. 자세한 내용은 [When to Use a Custom Claim Rule](When-to-Use-a-Custom-Claim-Rule.md)를 참조하세요.  
  
### <a name="examples-of-how-to-construct-a-transform-rule-syntax"></a>변환 규칙 구문을 생성하는 방법의 예  
클레임 규칙 언어 구문을 사용하여 클레임을 변환하는 경우 변환된 클레임의 속성을 새 리터럴 값으로 설정할 수 있습니다. 예를 들어 다음 규칙은 동일한 클레임 유형을 유지 하면서 역할 클레임의 값을 "Administrators"에서 "root"로 변경 합니다.  
  
```  
c:[type == "https://schemas.microsoft.com/ws/2008/06/identity/claims/role", value == "Administrators"]  => issue(type = c.type, value = "root");  
```  
  
정규식을 클레임 변환에 사용할 수도 있습니다. 예를 들어, 다음 규칙은 도메인 설정 windows 사용자 이름 클레임에 도메인에\\fabrikam 사용자 형식:  
  
```  
c:[type == "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"] => issue(type = c.type, value = regexreplace(c.value, "(?<domain>[^\\]+)\\(?<user>.+)", "FABRIKAM\${user}"));  
```  
  
### <a name="best-practices-for-creating-custom-rules"></a>사용자 지정 규칙을 만드는 모범 사례  
기본 필터링 기능을 사용하여 선택한 클레임에 클레임 변환을 선택적으로 적용할 수 있습니다. 다음과 같은 제한 사항을 적용하여 필터링에 사용되는 각 클레임 속성에 값을 할당할 수 있습니다.  
  
|클레임 속성|설명|  
|------------------|---------------|  
|Type, Value, ValueType|이러한 속성은 할당에 자주 사용됩니다. 결과로 변환된 클레임에 대한 최소한의 유형 및 값을 지정해야 합니다.|  
|발급자|클레임 규칙 언어에서는 클레임 발급자 설정을 허용하지만 일반적으로 설정하지 않는 것이 좋습니다. 클레임 발급자는 토큰에 직렬화되지 않습니다. 토큰이 수신되면 모든 클레임의 발급자 속성이 토큰에 서명한 페더레이션 서버의 식별자로 설정됩니다. 따라서 규칙에서 클레임 발급자를 설정해도 토큰의 내용에는 영향을 주지 않으며 클레임이 토큰에 패키지되면 설정이 손실됩니다. 클레임 발급자 설정이 타당한 유일한 시나리오는 클레임 공급자 규칙 집합에서 특정 값으로 설정되고 신뢰 당사자 규칙 집합이 이 특정 값을 참조하는 규칙으로 작성된 경우입니다. 발급자 속성이 클레임 규칙의 값으로 명시적으로 설정 되지 않은 경우 클레임 발급 엔진은이를 "로컬 기관"으로 설정 합니다.|  
|OriginalIssuer|Issuer와 마찬가지로, 일반적으로 OriginalIssuer에는 명시적으로 값이 할당되지 않습니다. Issuer와 달리 OriginalIssuer 속성은 토큰에 직렬화되지만 토큰 소비자가 설정된 속성에 원래 클레임을 발급한 페더레이션 서버의 식별자가 포함된다고 예상합니다.|  
|속성|이전 섹션에서 설명한 대로 클레임의 속성 모음은 토큰에 지속되지 않으므로 후속 로컬 정책에서 속성에 저장된 정보를 참조하는 경우에만 속성에 할당해야 합니다.|  
  
클레임 규칙 언어를 사용 하는 방법에 대 한 자세한 내용은 참조 [클레임 규칙 언어의 역할](The-Role-of-the-Claim-Rule-Language.md)합니다.  
  

