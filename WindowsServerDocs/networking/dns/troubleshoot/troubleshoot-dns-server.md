---
title: DNS 서버 문제 해결
description: 이 문서에서는 서버 쪽에서 DNS 문제를 해결 하는 방법을 소개 합니다.
manager: dcscontentpm
ms.technology: networking-dns
ms.topic: article
ms.author: delhan
ms.date: 8/8/2019
author: Deland-Han
ms.openlocfilehash: 4413c60072c43b623f386d5037e3da7ed5dc128d
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80861326"
---
# <a name="troubleshooting-dns-servers"></a>DNS 서버 문제 해결

이 문서에서는 DNS 서버에서 발생 하는 문제를 해결 하는 방법을 설명 합니다.

## <a name="check-ip-configuration"></a>IP 구성 확인

1. 명령 프롬프트에서 `ipconfig /all`를 실행 하 고 IP 주소, 서브넷 마스크 및 기본 게이트웨이를 확인 합니다.

2. DNS 서버가 조회 중인 이름에 대해 권한이 있는지 확인 합니다. 그렇다면 [신뢰할 수 있는 데이터에 대 한 문제 확인](#checking-for-problems-with-authoritative-data)을 참조 하세요.

3. 다음 명령을 실행합니다.

   ```cmd
   nslookup <name> <IP address of the DNS server>
   ```
   예를 들면 다음과 같습니다. 
   ```cmd
   nslookup app1 10.0.0.1
   ```
   오류 또는 제한 시간 응답을 받는 경우 [재귀 문제 확인](#checking-for-recursion-problems)을 참조 하세요.

4. 확인자 캐시를 플러시합니다. 이렇게 하려면 관리 명령 프롬프트 창에서 다음 명령을 실행 합니다.

   ```cmd
   dnscmd /clearcache
   ```
   또는 관리 PowerShell 창에서 다음 cmdlet을 실행 합니다.
   ```powershell
   Clear-DnsServerCache
   ```

5. 3 단계를 반복 합니다. 

## <a name="check-dns-server-problems"></a>DNS 서버 문제 확인

### <a name="event-log"></a>이벤트 로그

다음 로그를 확인 하 여 기록 된 오류가 있는지 여부를 확인 합니다.

- 응용 프로그램

- System

- DNS 서버

### <a name="test-by-using-nslookup-query"></a>Nslookup 쿼리를 사용 하 여 테스트

다음 명령을 실행 하 고 클라이언트 컴퓨터에서 DNS 서버에 연결할 수 있는지 여부를 확인 합니다.

```cmd
nslookup <client name> <server IP address>
```

- 확인자에서 클라이언트의 IP 주소를 반환 하는 경우 서버에 문제가 없는 것입니다.

- 해결 프로그램이 "서버 오류" 또는 "쿼리 거부" 응답을 반환 하는 경우 영역이 일시 중지 되었거나 서버가 오버 로드 된 것일 수 있습니다. DNS 콘솔에서 영역 속성의 일반 탭을 선택 하 여 일시 중지 되었는지 여부를 알 수 있습니다.

해결 프로그램이 "서버에서 요청 시간이 초과 되었습니다." 또는 "서버에서 응답 없음" 응답을 반환 하는 경우 DNS 서비스가 실행 되 고 있지 않을 수 있습니다. 서버의 명령 프롬프트에서 다음을 입력 하 여 DNS 서버 서비스를 다시 시작 하십시오.

```cmd
net start DNS
```

서비스가 실행 중일 때 문제가 발생 하면 서버는 nslookup 쿼리에서 사용한 IP 주소를 수신 하지 못할 수 있습니다. 관리자는 DNS 콘솔에 있는 서버 속성 페이지의 **인터페이스** 탭에서 선택한 주소만 수신 하도록 dns 서버를 제한할 수 있습니다. DNS 서버가 구성 된 IP 주소의 특정 목록으로 서비스를 제한 하도록 구성 된 경우 DNS 서버에 연결 하는 데 사용 되는 IP 주소가 목록에 없을 수 있습니다. 목록에서 다른 IP 주소를 시도 하거나 목록에 IP 주소를 추가할 수 있습니다.

드문 경우 지만 DNS 서버에 고급 보안 또는 방화벽 구성이 있을 수 있습니다. 서버가 중간 호스트 (예: 패킷 필터링 라우터 또는 프록시 서버)를 통해서만 연결할 수 있는 다른 네트워크에 있는 경우 DNS 서버는 비표준 포트를 사용 하 여 클라이언트 요청을 수신 하 고 받을 수 있습니다. 기본적으로 nslookup은 UDP 포트 53의 DNS 서버에 쿼리를 보냅니다. 따라서 DNS 서버에서 다른 포트를 사용 하는 경우 nslookup 쿼리가 실패 합니다. 이것이 문제가 될 수 있다고 생각 되는 경우에는 중간 필터가 잘 알려진 DNS 포트에서 트래픽을 차단 하는 데 의도적으로 사용 되는지 확인 합니다. 그렇지 않은 경우 UDP/TCP 포트 53에 대 한 트래픽을 허용 하도록 방화벽에서 패킷 필터 또는 포트 규칙을 수정 합니다.

## <a name="checking-for-problems-with-authoritative-data"></a>권한 있는 데이터의 문제 확인

잘못 된 응답을 반환 하는 서버가 영역의 주 서버 (영역에 대 한 표준 주 서버 또는 영역을 로드 하는 데 Active Directory 통합을 사용 하는 서버) 또는 영역의 보조 복사본을 호스트 하는 서버 인지 확인 합니다. 

### <a name="if-the-server-is-a-primary-server"></a>서버가 주 서버 이면

사용자가 영역에 데이터를 입력할 때 사용자 오류로 인해 문제가 발생할 수 있습니다. 또는 Active Directory 복제 또는 동적 업데이트에 영향을 주는 문제로 인해 발생할 수 있습니다.

### <a name="if-the-server-is-hosting-a-secondary-copy-of-the-zone"></a>서버가 영역의 보조 복사본을 호스트 하는 경우

1. 마스터 서버 (이 서버가 영역 전송을 끌어오는 서버)에서 영역을 검사 합니다.

   > [!NOTE]
   >DNS 콘솔에서 보조 영역의 속성을 검사 하 여 어떤 서버가 마스터 서버 인지 확인할 수 있습니다.

   마스터 서버에서 이름이 올바르지 않으면 4 단계로 이동 합니다.

2. 마스터 서버에서 이름이 올바르면 마스터 서버에 있는 일련 번호가 보조 서버의 일련 번호 보다 작거나 같은지 확인 합니다. 이 경우 마스터 서버에 있는 일련 번호가 보조 서버의 일련 번호 보다 큰지 마스터 서버 또는 보조 서버를 수정 합니다. 
  
3. 보조 서버에서 DNS 콘솔 내에서 또는 다음 명령을 실행 하 여 영역 전송을 강제로 실행 합니다.
  
   ```cmd
   dnscmd /zonerefresh <zone name>
   ```
  
   예를 들어 영역이 corp.contoso.com 인 경우 `dnscmd /zonerefresh corp.contoso.com`를 입력 합니다.
  
4. 보조 서버를 다시 검사 하 여 영역이 올바르게 전송 되었는지 여부를 확인 합니다. 그렇지 않은 경우에는 영역 전송 문제가 있을 수 있습니다. 자세한 내용은 [영역 전송 문제](#zone-transfer-problems)를 참조 하세요.

5. 영역이 올바르게 전송 되 면 데이터가 올바른지 여부를 확인 합니다. 그렇지 않으면 주 영역에서 데이터가 올바르지 않습니다. 사용자가 영역에 데이터를 입력할 때 사용자 오류로 인해 문제가 발생할 수 있습니다. 또는 Active Directory 복제 또는 동적 업데이트에 영향을 주는 문제로 인해 발생할 수 있습니다.

## <a name="checking-for-recursion-problems"></a>재귀 문제를 확인 하는 중

재귀가 성공적으로 작동 하려면 재귀 쿼리 경로에 사용 되는 모든 DNS 서버가 응답 하 고 올바른 데이터를 전달할 수 있어야 합니다. 사용할 수 없는 경우 다음 이유 중 하나로 인해 재귀 쿼리가 실패할 수 있습니다.

- 쿼리가 완료 되기 전에 제한 시간이 초과 되었습니다.

- 쿼리 중에 사용 되는 서버가 응답 하지 않습니다.

- 쿼리 중에 사용 되는 서버에서 잘못 된 데이터를 제공 합니다.

원래 쿼리에서 사용 된 서버에서 문제 해결을 시작 합니다. 이 서버가 DNS 콘솔의 서버 속성에서 **전달자** 탭을 검사 하 여 쿼리를 다른 서버로 전달 하는지 확인 합니다. **전달자 사용** 확인란이 선택 되어 있고 하나 이상의 서버가 나열 되어 있는 경우이 서버는 쿼리를 전달 합니다.

이 서버에서 쿼리를 다른 서버로 전달 하는 경우이 서버가 쿼리를 전달 하는 서버에 영향을 주는 문제를 확인 합니다. 문제를 확인 하려면 [DNS 서버 문제 확인](#check-dns-server-problems)을 참조 하세요. 이 섹션에서는 클라이언트에서 작업을 수행 하도록 지시 하는 경우 대신 서버에서 작업을 수행 합니다.

서버가 정상 상태이 고 쿼리를 전달할 수 있는 경우이 단계를 반복 하 고이 서버에서 쿼리를 전달 하는 서버를 검사 합니다.

이 서버에서 쿼리를 다른 서버로 전달 하지 않는 경우이 서버가 루트 서버를 쿼리할 수 있는지 여부를 테스트 합니다. 이렇게 하려면 다음 명령을 실행합니다.

```cmd
nslookup
server <IP address of server being examined>
set q=NS
 ```

- 해결 프로그램이 루트 서버의 IP 주소를 반환 하는 경우 루트 서버와 해결 하려는 이름 또는 IP 주소 간의 위임이 손상 되었을 수 있습니다. 끊어진 [위임 테스트](#test-a-broken-delegation) 절차에 따라 위임이 끊어진 위치를 확인 합니다.

- 해결 프로그램이 "서버에 대 한 요청 시간이 초과 되었습니다." 응답을 반환 하는 경우 루트 힌트가 작동 중인 루트 서버를 가리키도록 할지 여부를 확인 합니다. 이렇게 하려면를 사용 하 여 [현재 루트 힌트](#to-view-the-current-root-hints) 프로시저를 확인 합니다. 루트 힌트가 작동 중인 루트 서버를 가리키는 경우 네트워크에 문제가 있거나 [DNS 서버 문제 확인](#check-dns-server-problems) 섹션에 설명 된 대로 서버가 서버를 쿼리할 수 없도록 하는 고급 방화벽 구성을 사용할 수 있습니다. 재귀 시간 제한 기본값이 너무 짧을 수도 있습니다.

### <a name="test-a-broken-delegation"></a>끊어진 위임 테스트

유효한 루트 서버를 쿼리하여 다음 절차에서 테스트를 시작 합니다. 이 테스트에서는 모든 DNS 서버를 루트에서 중단 된 위임에 대해 테스트 하는 서버로 쿼리 하는 프로세스를 안내 합니다.

1. 테스트 중인 서버의 명령 프롬프트에서 다음을 입력 합니다.

   ```cmd
   nslookup
   server <server IP address>
   set norecursion
   set querytype= <resource record type>
   <FQDN>
   ```
   > [!NOTE]
   >리소스 레코드 종류는 원래 쿼리에서 쿼리 하는 리소스 레코드의 형식이 며 FQDN은 쿼리를 수행한 FQDN (마침표로 종료 됨)입니다.
 
2. 응답이 위임 된 서버에 대 한 "NS" 및 "A" 리소스 레코드 목록을 포함 하는 경우 각 서버에 대해 1 단계를 반복 하 고 "A" 리소스 레코드의 IP 주소를 서버 IP 주소로 사용 합니다.

   - 응답에 "NS" 리소스 레코드가 포함 되어 있지 않은 경우에는 위임이 중단 됩니다.
   
   - 응답에 "NS" 리소스 레코드가 포함 되어 있지만 "A" 리소스 레코드가 없는 경우 **설정 재귀**를 입력 하 고 "ns" 레코드에 나열 된 서버의 "a" 리소스 레코드에 대해 개별적으로 쿼리 합니다. 영역에 있는 각 NS 리소스 레코드에 대 한 "A" 리소스 레코드의 유효한 IP 주소를 하나 이상 찾지 못한 경우 위임이 중단 됩니다.

3. 연결이 끊어진 경우 위임 된 영역에 대 한 올바른 DNS 서버에 유효한 IP 주소를 사용 하 여 부모 영역에서 "A" 리소스 레코드를 추가 하거나 업데이트 하 여 문제를 해결 합니다.

### <a name="to-view-the-current-root-hints"></a>현재 루트 힌트를 보려면

1. DNS 콘솔을 시작 합니다.

2. 재귀 쿼리를 실패 한 DNS 서버를 추가 하거나 연결 합니다.

3. 서버를 마우스 오른쪽 단추로 클릭 하 고 **속성**을 선택 합니다.

4. 루트 힌트를 클릭 합니다.

루트 서버에 대 한 기본 연결을 확인 합니다.

- 루트 힌트가 올바르게 구성 된 것으로 나타나면 실패 한 이름 확인에 사용 되는 DNS 서버가 IP 주소를 사용 하 여 루트 서버를 ping 할 수 있는지 확인 합니다.

- 루트 서버가 IP 주소에의 한 ping에 응답 하지 않으면 루트 서버에 대 한 IP 주소가 변경 되었을 수 있습니다. 그러나 루트 서버를 재구성 하는 것이 일반적이 지 않습니다.

## <a name="zone-transfer-problems"></a>영역 전송 문제

다음 검사를 실행 합니다.

- 주 DNS 서버와 보조 DNS 서버 모두에 대 한 이벤트 뷰어를 확인 합니다.

- 마스터 서버를 확인 하 여 보안을 위해 전송 전송을 거부 하는지 여부를 확인 합니다. 

- DNS 콘솔에서 영역 속성의 **영역 전송** 탭을 확인 합니다. 서버가 영역 속성의 **이름 서버** 탭에 나열 된 것과 같은 서버 목록으로 영역 전송을 제한 하는 경우 보조 서버가 해당 목록에 있는지 확인 합니다. 서버가 영역 전송을 보내도록 구성 되어 있는지 확인 합니다.

- [DNS 서버 문제 확인](#check-dns-server-problems) 섹션의 단계를 수행 하 여 마스터 서버에 문제가 있는지 확인 합니다. 클라이언트에서 작업을 수행 하 라는 메시지가 표시 되 면 보조 서버에서 작업을 수행 합니다.

- 보조 서버에서 BIND와 같은 다른 DNS 서버 구현을 실행 하 고 있는지 확인 합니다. 이 경우 다음 원인 중 하나가 발생할 수 있습니다.

  - 빠른 영역 전송을 전송 하도록 Windows 마스터 서버를 구성 했을 수 있지만 타사 보조 서버는 빠른 영역 전송을 지원 하지 않을 수 있습니다. 이 경우 서버 속성의 **고급** 탭에서 **바인드 보조 사용** 확인란을 선택 하 여 DNS 콘솔 내에서 마스터 서버에 대 한 빠른 영역 전송을 사용 하지 않도록 설정 합니다.

  - Windows 서버의 전방 조회 영역에 보조 서버에서 지원 하지 않는 레코드 유형 (예: SRV 레코드)이 포함 된 경우 보조 서버는 영역을 끌어오는 데 문제가 있을 수 있습니다.

마스터 서버에서 BIND와 같은 다른 DNS 서버 구현을 실행 하 고 있는지 확인 합니다. 그렇다면 마스터 서버의 영역에 Windows에서 인식 되지 않는 호환 되지 않는 리소스 레코드가 포함 되어 있을 수 있습니다.
 
마스터 서버 또는 보조 서버에서 다른 DNS 서버 구현을 실행 하는 경우 두 서버 모두에서 동일한 기능을 지원 하는지 확인 합니다. 서버에 대 한 속성 페이지의 **고급** 탭에서 DNS 콘솔의 Windows server를 확인할 수 있습니다. 바인딩 보조 사용 상자 외에도이 페이지에는 **이름 확인** 드롭다운 목록이 포함 됩니다. 이렇게 하면 DNS 이름의 문자에 대해 엄격한 RFC 준수 적용을 선택할 수 있습니다.

