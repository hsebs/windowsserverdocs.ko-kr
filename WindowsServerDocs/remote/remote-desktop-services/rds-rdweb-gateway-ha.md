---
title: RD 웹 및 게이트웨이 웹 프런트에 고가용성 추가
description: RDS 배포에 RD 웹 및 게이트웨이 서버를 설치하기 위한 단계를 제공합니다.
ms.prod: windows-server
ms.technology: remote-desktop-services
ms.topic: article
author: lizap
ms.author: elizapo
ms.date: 11/08/2016
manager: dongill
ms.openlocfilehash: e98bbda5460311dd379eab6f5a5bde0ec3845d5c
ms.sourcegitcommit: 3a3d62f938322849f81ee9ec01186b3e7ab90fe0
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/23/2020
ms.locfileid: "80860286"
---
# <a name="add-high-availability-to-the-rd-web-and-gateway-web-front"></a>RD 웹 및 게이트웨이 웹 프런트에 고가용성 추가

>적용 대상: Windows Server(반기 채널), Windows Server 2019, Windows Server 2016


Windows Server RDS(원격 데스크톱 서비스) 배포의 가용성과 규모를 개선하기 위해 RD 웹 액세스(원격 데스크톱 웹 액세스) 및 RD 게이트웨이(원격 데스크톱 게이트웨이) 팜을 배포할 수 있습니다. 

기존 원격 데스크톱 서비스 기본 배포에 RD 웹 및 게이트웨이 서버를 추가하려면 다음 단계를 사용합니다.  

## <a name="pre-requisites"></a>필수 구성 요소

추가 RD 웹 및 RD 게이트웨이 역할을 수행할 서버 설정 - 이 서버는 물리적 서버 또는 VM일 수 있습니다. 이 과정에서 서버를 도메인에 가입하고 원격 관리를 사용하도록 설정합니다.

## <a name="step-1-configure-the-new-server-to-be-part-of-the-rds-environment"></a>1단계: 새 서버를 RDS 환경의 일부로 구성

1. 원격 데스크톱 연결 클라이언트를 사용하여 Azure Portal에서 RDMS 서버에 연결합니다.
2. 서버 관리자에 새 게이트웨이 및 RD 웹 서버를 추가 합니다.
    1. 서버 관리자를 시작, 클릭 **관리 > 서버 추가**합니다.   
    2. 서버 추가 대화 상자에서 클릭 **지금 찾기**합니다.   
    3. 새로 만든 RD 웹 및 게이트웨이 서버(예: Contoso-WebGw2)를 선택하고 **확인**을 클릭합니다.
3. 배포에 RD 웹 및 게이트웨이 서버 추가  
    1. 서버 관리자를 시작 합니다.  
    2. **원격 데스크톱 서비스 > 개요 > 배포 서버 > 작업 > RD 웹 액세스 서버 추가**를 클릭합니다.   
    3. 새로 만든 서버(예: Contoso-WebGw2)를 선택하고 **다음**을 클릭합니다.  
    4. 선택 확인 페이지에서 **필요에 따라 원격 컴퓨터를 다시 시작**, 를 클릭 하 고 **추가**합니다.  
    5. 이러한 단계를 반복하여 RD 게이트웨이 서버를 추가하지만 b단계에서 **RD 게이트웨이 서버**를 선택합니다.
4. RD 게이트웨이 서버용 인증서를 다시 설치합니다.
   1. RDMS 서버의 서버 관리자에서 **원격 데스크톱 서비스 > 개요 > 작업 > 배포 속성 편집**을 클릭합니다.  
   2. **인증서**를 확장합니다.  
   3. 테이블까지 아래로 스크롤합니다. RD **게이트웨이 역할 서비스를 클릭하고 기존 인증서를 선택**합니다.  
   4. **다른 인증서 선택**을 클릭하고 인증서 위치로 이동합니다. (예: \Contoso-CB1\Certificates) 필수 작업 동안 만든 RD 웹 및 게이트웨이 서버용 인증서 파일(예: ContosoRdGwCert)을 선택한 후 **열기**를 클릭합니다.  
   5. 인증서의 암호를 입력하고 **대상 컴퓨터의 신뢰할 수 있는 루트 인증 기관 인증서 저장소에 인증서를 추가할 수 있습니다.** 를 선택하고 **확인**을 클릭합니다.  
   6. **적용**을 클릭합니다.
      > [!NOTE] 
      > 서버 관리자 또는 작업 관리자를 통해 각 RD 게이트웨이 서버에서 실행되는 TSGateway 서비스를 수동으로 다시 시작해야 할 수 있습니다.
   7. RD 웹 액세스 역할 서비스에 대해 a~f단계를 반복합니다.

## <a name="step-2-configure-rd-web-and-rd-gateway-properties-on-the-new-server"></a>2단계: 새 서버에서 RD 웹 및 RD 게이트웨이 속성 구성
1. 다음과 같이 서버를 RD 게이트웨이 팜의 일부로 구성합니다.
    1.  RDMS 서버의 서버 관리자에서 **모든 서버**를 클릭합니다. RD 게이트웨이 서버 중 하나를 마우스 오른쪽 단추로 클릭하고 **원격 데스크톱 연결**을 클릭합니다.
    2.  도메인 관리자 계정을 사용하여 RD 게이트웨이 서버에 로그인합니다.  
    3.  RD 게이트웨이 서버의 서버 관리자에서 **도구 > 원격 데스크톱 서비스 > RD 게이트웨이 관리자**를 클릭합니다.  
    4.  탐색 창에서 로컬 컴퓨터(예: Contoso-WebGw1)를 클릭합니다.  
    5.  **RD 게이트웨이 서버 팜 멤버 추가**를 클릭합니다.  
    6.  **서버 팜** 탭에서 각 RD 게이트웨이 서버의 이름을 입력하고 **추가** 및 **적용**을 클릭합니다.  
    7.  각 RD 게이트웨이 서버가 서로를 팜의 RD 게이트웨이 서버로 인식하도록 각 RD 게이트웨이 서버에 대해 a~f단계를 반복합니다. DNS 설정이 전파되는 데 시간이 걸릴 수 있으므로 경고가 표시되더라도 놀라지 마세요.
2. 서버를 RD 웹 액세스 팜의 일부로 구성합니다. 아래 단계는 두 RDWeb 사이트에서 유효성 검사 및 암호 해독 컴퓨터 키가 같아지도록 구성합니다.
    1.  RDMS 서버의 서버 관리자에서 **모든 서버**를 클릭합니다. 첫 번째 RD 웹 액세스 서버(예: Contoso-WebGw1)를 마우스 오른쪽 단추로 클릭하고 **원격 데스크톱 연결**을 클릭합니다.  
    2.  도메인 관리자 계정을 사용하여 RD 웹 액세스 서버에 로그인합니다.  
    3.  RD 웹 액세스 서버의 서버 관리자에서 **도구 > IIS(인터넷 정보 서비스) 관리자**를 클릭합니다.  
    4.  IIS 관리자의 왼쪽 창에서 **서버(예: Contoso-WebGw1) > 사이트 > 기본 웹 사이트**를 확장하고 **RDWeb**을 클릭합니다.  
    5.  **컴퓨터 키**를 마우스 오른쪽 단추로 클릭하고 **기능 열기**를 클릭합니다.
    6.  컴퓨터 키 페이지의 **작업** 창에서 **키 생성**을 클릭하고 **적용**을 클릭합니다.
    7.  유효성 검사 키를 복사합니다(키를 마우스 오른쪽 단추로 클릭하고 **복사** 클릭).
    8.  IIS 관리자의 **기본 웹 사이트** 아래에서 **Feed**, **FeedLogon** 및 **Pages**를 차례로 선택합니다.
    9. 각각에 대해 다음을 수행합니다.
        1.  **컴퓨터 키**를 마우스 오른쪽 단추로 클릭하고 **기능 열기**를 클릭합니다.
        2.  유효성 검사 키에 대해 **런타임에 자동 생성**을 선택 취소하고 g단계에서 복사한 키를 붙여넣습니다.
    10.  이 RD 웹 서버에 대한 RD 연결 창을 최소화합니다.  
    11.  두 번째 RD 웹 액세스 서버에 대해 **컴퓨터 키**의 기능 보기까지 b~e단계를 반복합니다.
    12. 유효성 검사 키에 대해 **런타임에 자동 생성**을 선택 취소하고 g단계에서 복사한 키를 붙여넣습니다.
    13. **적용**을 클릭합니다.
    14. **RDWeb**, **Feed**, **FeedLogon** 및 **Pages** 페이지에 대해 이 프로세스를 완료합니다.
    15. 두 번째 RD 웹 액세스 서버에 대한 RD 연결 창을 최소화한 후, 첫 번째 RD 웹 액세스 서버에 대한 RD 연결 창을 최대화합니다.  
    16. g~n단계를 반복하여 암호 해독 키를 복사합니다.
    17. 유효성 검사 키와 암호 해독 키가 **RDWeb**, **Feed**, **FeedLogon** 및 **Pages** 페이지의 두 RD 웹 액세스 서버에서 동일한 경우 모든 RD 연결 창에서 로그아웃합니다.

## <a name="step-3-configure-load-balancing-for-the-rd-web-and-rd-gateway-servers"></a>3단계: RD 웹 및 RD 게이트웨이 서버에 대해 부하 분산 구성

Azure 인프라를 사용하는 경우 외부 Azure Load Balancer를 만들 수 있으며, 그렇지 않은 경우 별도의 하드웨어 또는 소프트웨어 부하 분산 장치를 설정할 수 있습니다. 원격 데스크톱 클라이언트에서 RD 게이트웨이를 통과하여 사용자가 해당 워크로드를 실행할 서버로 이어지는 장기적인 연결에서 트래픽이 균일하게 분산되도록 하기 위해서는 부하 분산이 중요합니다.

> [!NOTE] 
> RD 웹 및 RD 게이트웨이를 실행하는 이전 서버를 이미 외부 부하 분산 장치를 기준으로 설정한 경우 4단계로 건너뛴 후 기존 백 엔드 풀을 선택하고, 풀에 새 서버를 추가합니다.

1.  다음과 같이 Azure Load Balancer를 만듭니다.  
    1.  Azure Portal에서 **찾아보기 > 부하 분산 장치 > 추가**를 클릭합니다.  
    2.  이름(예: **WebGwLB**)을 입력합니다.  
    3.  **구성표**에 대해 **퍼블릭**을 선택합니다.
    4.  **공용 IP 주소** 아래에서 **공용 IP 주소 선택**을 선택한 다음, 기존 공용 IP 주소를 선택하거나 새 공용 IP 주소를 만듭니다.
    5.  해당 **구독**, **리소스 그룹** 및 **위치**를 선택합니다.
    6.  **만들기**를 클릭합니다.  
2. 다음과 같이 [프로브](https://azure.microsoft.com/documentation/articles/load-balancer-custom-probe-overview/)를 만들어 활성 상태인 서버를 모니터링합니다.  
    1.  Azure Portal에서 **찾아보기** > **부하 분산 장치**를 차례로 선택한 다음, 이전 단계에서 만든 부하 분산 장치를 선택합니다.
    2.  **모든 설정** > **프로브** > **추가**를 차례로 선택합니다.  
    3.  프로브의 이름(예: **HTTPS**)을 입력합니다. **프로토콜**로 **TCP**를 선택하고 **포트**에 대해 **443**을 입력한 후 **확인**을 클릭합니다.   
3.  다음과 같이 HTTPS 및 UDP 부하를 분산 규칙을 만듭니다.  
    1.  **설정**에서 **부하 분산 규칙**을 클릭합니다.  
    2.  **HTTPS 규칙**에 대해 **추가**를 선택합니다.  
    3.  규칙의 이름(예: HTTPS)을 입력하고 **프로토콜**로 **TCP**를 선택합니다. **포트** 및 **백 엔드 포트** 둘 다에 대해 **443**을 입력하고 **확인**을 클릭합니다.  
    4.  **부하 분산 규칙**에서 **UDP 규칙**에 대해 **추가**를 클릭합니다.  
    5.  규칙의 이름(예: **UDP**)을 입력하고 **프로토콜**로 **UDP**를 선택합니다. **포트** 및 **백 엔드 포트** 둘 다에 대해 **3391**을 입력하고 **확인**을 클릭합니다.  
4. 다음과 같이 RD 웹 및 RD 게이트웨이 서버의 백 엔드 풀을 만듭니다.
      1. **설정**에서 **백 엔드 주소 풀 > 추가**를 클릭합니다.   
      2. 이름(예: **WebGwBackendPool**)을 입력한 다음, **가상 머신 추가**를 클릭합니다.  
      3. 가용성 집합(예: WebGwAvSet)을 선택하고 **확인**을 클릭합니다.   
      4. **가상 머신 선택**을 클릭하고 각 가상 머신을 선택한 후 **선택 > 확인 > 확인**을 클릭합니다.
