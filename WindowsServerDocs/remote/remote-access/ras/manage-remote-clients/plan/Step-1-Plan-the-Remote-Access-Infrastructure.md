---
title: 1 단계 원격 액세스 인프라 계획
description: 이 항목은 Windows Server 2016에서 원격으로 DirectAccess 클라이언트 관리 가이드의 일부입니다.
manager: brianlic
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: networking-ras
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: a1ce7af5-f3fe-4fc9-82e8-926800e37bc1
ms.author: lizross
author: eross-msft
ms.openlocfilehash: 7c6b4e4d4975303aef6a2334bce164ce498f7254
ms.sourcegitcommit: da7b9bce1eba369bcd156639276f6899714e279f
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/26/2020
ms.locfileid: "80314281"
---
# <a name="step-1-plan-the-remote-access-infrastructure"></a>1 단계 원격 액세스 인프라 계획

>적용 대상: Windows Server(반기 채널), Windows Server 2016

> [!NOTE]
> Windows Server 2016에서는 DirectAccess 및 RRAS (라우팅 및 원격 액세스 서비스)를 단일 원격 액세스 역할로 결합 합니다.  
  
이 항목에서는 DirectAccess 클라이언트의 원격 관리를 위해 단일 원격 액세스 서버를 설정 하는 데 사용할 수 있는 인프라를 계획 하는 단계에 대해 설명 합니다. 다음 표에서는 이러한 단계를 나열 하지만 이러한 계획 작업은 특정 순서 대로 수행할 필요가 없습니다.  
  
|작업|설명|  
|----|--------|  
|[네트워크 토폴로지 및 서버 설정 계획](#plan-network-topology-and-settings)|원격 액세스 서버의 위치 (NAT (네트워크 주소 변환) 장치 또는 방화벽)를 결정 하 고 IP 주소 지정 및 라우팅을 계획 합니다.|  
|[방화벽 요구 사항 계획](#plan-firewall-requirements)|원격 액세스가 경계면 방화벽을 통과하도록 허용할 계획을 수립합니다.|  
|[인증서 요구 사항 계획](#plan-certificate-requirements)|클라이언트 인증을 위해 Kerberos 프로토콜을 사용할지 또는 인증서를 사용할지 결정 하 고 웹 사이트 인증서를 계획 합니다.<br/><br/>IP-HTTPS는 DirectAccess 클라이언트가 IPv4 네트워크상의 IPv6 트래픽을 터널링하는 데 사용되는 변환 프로토콜입니다. CA (인증 기관)에서 발급 한 인증서를 사용 하거나 원격 액세스 서버에서 자동으로 발급 한 자체 서명 된 인증서를 사용 하 여 서버에 대해 IP-HTTPS를 인증할지 여부를 결정 합니다.|  
|[DNS 요구 사항 계획](#plan-dns-requirements)|원격 액세스 서버, 인프라 서버, 로컬 이름 확인 옵션 및 클라이언트 연결에 대 한 DNS (Domain Name System) 설정을 계획 합니다.| 
|[네트워크 위치 서버 구성 계획](#plan-the-network-location-server-configuration)|조직에서 네트워크 위치 서버 웹 사이트를 배치할 위치 (원격 액세스 서버 또는 대체 서버)를 결정 하 고, 네트워크 위치 서버가 원격 액세스 서버에 있는 경우 인증서 요구 사항을 계획 합니다. **참고:** 네트워크 위치 서버는 DirectAccess 클라이언트가 내부 네트워크에 있는지 여부를 확인 하는 데 사용 됩니다.|  
|[관리 서버의 구성 계획](#plan-management-servers-configuration)|원격 클라이언트 관리 시 사용되는 관리 서버(예: 업데이트 서버)를 계획합니다. **참고:** 관리자는 인터넷을 사용 하 여 회사 네트워크 외부에 있는 DirectAccess 클라이언트 컴퓨터를 원격으로 관리할 수 있습니다.|  
|[계획 Active Directory 요구 사항](#plan-active-directory-requirements)|도메인 컨트롤러, Active Directory 요구 사항, 클라이언트 인증 및 여러 도메인 구조를 계획 합니다.|  
|[계획 그룹 정책 개체 만들기](#plan-group-policy-object-creation)|조직에 필요한 Gpo 및 Gpo를 만들고 편집 하는 방법을 결정 합니다.|  
  
## <a name="plan-network-topology-and-settings"></a>네트워크 토폴로지 및 설정 계획  
네트워크를 계획 하는 경우 네트워크 어댑터 토폴로지, IP 주소 지정에 대 한 설정 및 ISATAP의 요구 사항을 고려해 야 합니다.  
  
### <a name="plan-network-adapters-and-ip-addressing"></a>네트워크 어댑터 및 IP 주소 지정 계획  
  
1.  사용할 네트워크 어댑터 토폴로지를 확인 합니다. 다음 토폴로지 중 하나를 사용 하 여 원격 액세스를 설정할 수 있습니다.  
  
    -   두 개의 네트워크 어댑터 사용: 원격 액세스 서버는 인터넷에 연결 된 네트워크 어댑터와 내부 네트워크에 연결 된 네트워크 어댑터 하나를 사용 하 여에 지에 설치 됩니다.  
  
    -   두 개의 네트워크 어댑터 사용: 원격 액세스 서버는 NAT 장치, 방화벽 또는 라우터 뒤에 설치 되며, 하나의 네트워크 어댑터는 경계 네트워크와 내부 네트워크에 연결 됩니다.  
  
    -   네트워크 어댑터 1 개 사용: 원격 액세스 서버는 NAT 장치 뒤에 설치 되 고 단일 네트워크 어댑터는 내부 네트워크에 연결 됩니다.  
  
2.  IP 주소 지정 요구 사항을 확인합니다.  
  
    DirectAccess는 IPsec에서 IPv6을 사용하여 DirectAccess 클라이언트 컴퓨터와 회사 내부 네트워크 사이의 보안 연결을 만듭니다. 그러나 DirectAccess를 사용하기 위해 반드시 IPv6 인터넷 또는 내부 네트워크에서 지원되는 기본 IPv6에 연결할 필요는 없습니다. 대신, IPv6 전환 기술을 자동으로 구성 하 고 사용 하 여 ipv4 인터넷 (6to4, Teredo 또는 IP-HTTPS) 및 IPv4 전용 인트라넷 (NAT64 또는 ISATAP)에서 IPv6 트래픽을 터널링 합니다. 이러한 전환 기술에 대한 개요는 다음 리소스를 참조하세요.  
  
    -   [IPv6 전환 기술](https://technet.microsoft.com/library/bb726951.aspx)  
  
    -   [IP-HTTPS 터널링 프로토콜 사양](https://msdn.microsoft.com/library/dd358571.aspx)  
  
3.  다음 표에 따라 필요한 어댑터 및 주소를 구성합니다. 단일 네트워크 어댑터를 사용 하는 NAT 장치 뒤에 있는 배포의 경우 **내부 네트워크 어댑터** 열만 사용 하 여 IP 주소를 구성 합니다.  
  
    ||외부 네트워크 어댑터|내부 네트워크 어댑터<sup>1 이상</sup>|라우팅 요구 사항|  
    |-|--------------|------------------------|------------|  
    |IPv4 인터넷 및 IPv4 인트라넷|다음을 구성합니다.<br/><br/>-적절 한 서브넷 마스크를 사용 하는 두 개의 고정 연속 공용 IPv4 주소 (Teredo에만 필요)<br/>-인터넷 방화벽이 나 로컬 ISP (인터넷 서비스 공급자) 라우터의 기본 게이트웨이 IPv4 주소입니다. **참고:** 원격 액세스 서버는 Teredo 서버 역할을 하 고 Windows 기반 Teredo 클라이언트는 원격 액세스 서버를 사용 하 여 NAT 장치 유형을 검색할 수 있도록 두 개의 연속 된 공용 IPv4 주소가 필요 합니다.|다음을 구성합니다.<br/><br/>-적절 한 서브넷 마스크는 IPv4 인트라넷 주소입니다.<br/>-인트라넷 네임 스페이스에 대 한 연결별 DNS 접미사입니다. DNS 서버도 내부 인터페이스에 구성해야 합니다. **주의:** 인트라넷 인터페이스의 기본 게이트웨이 구성 하지 마십시오.|내부 IPv4 네트워크의 모든 서브넷에 연결 하도록 원격 액세스 서버를 구성 하려면 다음을 수행 합니다.<br/><br/>-인트라넷의 모든 위치에 대 한 IPv4 주소 공간을 나열 합니다.<br/>-`route add -p` 또는 `netsh interface ipv4 add route` 명령을 사용 하 여 원격 액세스 서버의 IPv4 라우팅 테이블에 고정 경로로 IPv4 주소 공간을 추가 합니다.|  
    |IPv6 인터넷 및 IPv6 인트라넷|다음을 구성합니다.<br/><br/>-ISP에서 제공 하는 자동 구성 된 주소 구성을 사용 합니다.<br/>-`route print` 명령을 사용 하 여 ISP 라우터를 가리키는 기본 IPv6 경로가 IPv6 라우팅 테이블에 있는지 확인 합니다.<br/>-ISP 및 인트라넷 라우터가 RFC 4191에 설명 된 대로 기본 라우터 기본 설정을 사용 하 고 있고 로컬 인트라넷 라우터 보다 높은 기본 우선 순위를 사용 하는지 확인 합니다. 둘 다에 해당되면 기본 경로에 대한 다른 구성이 필요하지 않습니다. ISP 라우터의 우선 순위가 높으면 원격 액세스 서버의 활성 기본 IPv6 경로가 IPv6 인터넷을 가리킵니다.<br/><br/>원격 액세스 서버가 IPv6 라우터이므로 기본 IPv6 인프라가 있는 경우 인터넷 인터페이스에서 인트라넷의 도메인 컨트롤러에도 연결할 수 있습니다. 이 경우 경계 네트워크의 도메인 컨트롤러에 패킷 필터를 추가 하 여 원격 액세스 서버의 인터넷 인터페이스 IPv6 주소에 대 한 연결을 방지 합니다.|다음을 구성합니다.<br/><br/>기본 기본 설정 수준을 사용 하지 않는 경우 `netsh interface ipv6 set InterfaceIndex ignoredefaultroutes=enabled` 명령을 사용 하 여 인트라넷 인터페이스를 구성 합니다. 이 명령을 사용하면 인트라넷 라우터를 가리키는 추가 기본 경로가 IPv6 라우팅 테이블에 추가되지 않습니다. `netsh interface show interface` 명령 표시에서 인트라넷 인터페이스의 InterfaceIndex를 가져올 수 있습니다.|IPv6 인트라넷을 사용하는 경우 모든 IPv6 위치에 연결하도록 원격 액세스 서버를 구성하려면 다음을 수행합니다.<br/><br/>-인트라넷의 모든 위치에 대 한 IPv6 주소 공간을 나열 합니다.<br/>-`netsh interface ipv6 add route` 명령을 사용 하 여 원격 액세스 서버의 IPv6 라우팅 테이블에 고정 경로로 IPv6 주소 공간을 추가 합니다.|  
    |IPv4 인터넷 및 IPv6 인트라넷|원격 액세스 서버는 Microsoft 6to4 어댑터 인터페이스를 사용 하 여 기본 IPv6 경로 트래픽을 IPv4 인터넷의 6to4 릴레이에 전달 합니다. 기본 i p v 6이 회사 네트워크에 배포 되지 않은 경우 다음 명령을 사용 하 여 IPv4 인터넷에서 Microsoft 6to4 릴레이의 IPv4 주소에 대 한 원격 액세스 서버를 구성할 수 있습니다. `netsh interface ipv6 6to4 set relay name=<ipaddress> state=enabled`.|||  
  
    > [!NOTE]  
    > -   DirectAccess 클라이언트에 공용 IPv4 주소가 할당 된 경우 6to4 릴레이 기술을 사용 하 여 인트라넷에 연결 합니다. 클라이언트에 개인 IPv4 주소가 할당 된 경우 Teredo를 사용 합니다. DirectAccess 클라이언트는 6to4 또는 Teredo를 사용하여 DirectAccess 서버에 연결할 수 없는 경우 IP-HTTPS를 사용합니다.  
    > -   Teredo를 사용하려면 외부 연결 네트워크 어댑터에서 두 개의 연속된 IP 주소를 구성해야 합니다.  
    > -   원격 액세스 서버에 네트워크 어댑터가 하나만 있는 경우에는 Teredo를 사용할 수 없습니다.  
    > -   기본 IPv6 클라이언트 컴퓨터는 기본 IPv6을 통해 원격 액세스 서버에 연결할 수 있으므로 전환 기술이 필요 없습니다.  
  
### <a name="plan-isatap-requirements"></a>ISATAP 요구 사항 계획  
ISATAP는 DirectAccessclients를 원격으로 관리 하는 데 필요 하므로 DirectAccess 관리 서버는 인터넷에 있는 DirectAccess 클라이언트에 연결할 수 있습니다. ISATAP는 DirectAccess 클라이언트 컴퓨터에서 회사 네트워크의 IPv4 리소스에 대해 시작 하는 연결을 지 원하는 데 필요 하지 않습니다. 이 용도에는 NAT64/DNS64가 사용됩니다. 배포에 ISATAP가 필요한 경우 다음 표를 사용 하 여 요구 사항을 확인 합니다.  
  
|ISATAP 배포 시나리오|요구 사항|  
|---------------|--------|  
|기존 기본 IPv6 인트라넷 (ISATAP가 필요 하지 않음)|기존 기본 IPv6 인프라를 사용 하면 원격 액세스 배포 중에 조직의 접두사를 지정 하 고 원격 액세스 서버는 ISATAP 라우터로 구성 하지 않습니다. 다음을 수행합니다.<br/><br/>1. 인트라넷에서 DirectAccess 클라이언트에 연결할 수 있도록 하려면 기본 경로 트래픽이 원격 액세스 서버에 전달 되도록 IPv6 라우팅을 수정 해야 합니다. 인트라넷 IPv6 주소 공간이 단일 48 비트 IPv6 주소 접두사 이외의 주소를 사용 하는 경우 배포 중에 관련 된 조직 IPv6 접두사를 지정 해야 합니다.<br/>2. 현재 IPv6 인터넷에 연결 된 경우에는 원격 액세스 서버에 전달 되도록 기본 경로 트래픽을 구성한 다음 원격 액세스 서버에서 적절 한 연결과 경로를 구성 하 여 기본 경로를 구성 해야 합니다. 트래픽은 IPv6 인터넷에 연결 된 장치에 전달 됩니다.|  
|기존 ISATAP 배포|기존 ISATAP 인프라가 있는 경우 배포 중에 조직의 48 비트 접두사를 입력 하 라는 메시지가 표시 되며 원격 액세스 서버는 ISATAP 라우터로 구성 되지 않습니다. 인트라넷에서 DirectAccess 클라이언트에 연결할 수 있는지 확인 하려면 기본 경로 트래픽이 원격 액세스 서버에 전달 되도록 IPv6 라우팅 인프라를 수정 해야 합니다. 이 변경은 인트라넷 클라이언트가 이미 기본 트래픽을 전달 해야 하는 기존 ISATAP 라우터에 대해 수행 해야 합니다.|  
|기존 IPv6 연결 없음|원격 액세스 설치 마법사에서 서버에 기본 또는 ISATAP 기반 IPv6 연결이 없다는 것을 감지 하면 자동으로 인트라넷에 대 한 6to4 기반 48 비트 접두사를 파생 시키고 원격 액세스 서버를 ISATAP 라우터로 구성 하 여 IPv6을 제공 합니다. 인트라넷을 통해 ISATAP 호스트에 연결 합니다. 6to4 기반 접두사는 서버에 공용 주소가 있는 경우에만 사용 되 고, 그렇지 않으면 고유 로컬 주소 범위에서 접두사가 자동으로 생성 됩니다.<br/><br/>ISATAP를 사용 하려면 다음을 수행 합니다.<br/><br/>1. isatap 기반 연결을 사용 하도록 설정할 각 도메인에 대 한 DNS 서버에서 ISATAP 이름을 등록 하 여 내부 DNS 서버에서 원격 액세스 서버의 내부 IPv4 주소에 대해 ISATAP 이름을 확인할 수 있도록 합니다.<br/>2. 기본적으로 Windows Server 2012, Windows Server 2008 R2, Windows Server 2008 또는 Windows Server 2003이 실행 되는 DNS 서버는 전역 쿼리 차단 목록을 사용 하 여 ISATAP 이름의 블록을 확인 합니다. ISATAP를 사용 하도록 설정 하려면 블록 목록에서 ISATAP 이름을 제거 해야 합니다. 자세한 내용은 [DNS 전역 쿼리 차단 목록에서 ISATAP 제거](https://go.microsoft.com/fwlink/p/?LinkId=168593)를 참조 하세요.<br/><br/>ISATAP 이름을 확인할 수 있는 Windows 기반 ISATAP 호스트가 다음과 같이 원격 액세스 서버를 사용 하 여 주소를 자동으로 구성 합니다.<br/><br/>1. ISATAP 터널링 인터페이스의 ISATAP 기반 IPv6 주소<br/>2. 인트라넷의 다른 ISATAP 호스트에 대 한 연결을 제공 하는 64 비트 경로<br/>3. 원격 액세스 서버를 가리키는 기본 IPv6 경로입니다. 기본 경로를 사용 하면 인트라넷 ISATAP 호스트가 DirectAccess 클라이언트에 연결할 수 있습니다.<br/><br/>Windows 기반 ISATAP 호스트는 ISATAP 기반 IPv6 주소를 가져올 때 대상이 isatap 호스트인 경우에도 ISATAP 캡슐화 된 트래픽을 사용 하 여 통신 합니다. ISATAP는 전체 인트라넷에 단일 64 비트 서브넷을 사용 하기 때문에 통신은 분할 된 IPv4 통신 모델에서 i p v 6의 단일 서브넷 통신 모델로 이동 합니다. 이는 Active Directory 사이트 및 서비스 구성을 사용 하는 일부 Active Directory Domain Services (AD DS) 및 응용 프로그램의 동작에 영향을 줄 수 있습니다. 예를 들어 사이트 및 서비스 스냅인을 사용 하 여 사이트 및 IPv4 기반 서브넷을 구성 하 고 사이트 내의 서버에 요청을 전달 하는 사이트 간 전송을 Active Directory 사용 하는 경우이 구성은 ISATAP 호스트에서 사용 되지 않습니다.<br/><br/><ol><li>ISATAP 호스트에 대 한 사이트 내에서 전달할 사이트와 서비스를 Active Directory 구성 하려면 각 IPv4 서브넷 개체에 대해 서브넷의 IPv6 주소 접두사가 동일한 ISATAP 호스트 범위를 표시 하는 동등한 IPv6 서브넷 개체를 구성 해야 합니다. IPv4 서브넷으로 주소를 합니다. 예를 들어 IPv4 서브넷 192.168.99.0/24 및 64 비트 ISATAP 주소 접두사 2002:836b: 1:8000:/64의 경우 IPv6 서브넷 개체의 IPv6 주소 접두사는 2002:836b: 1:8000:0: 5efe: 192.168.99.0/120입니다. 임의 IPv4 접두사 길이 (예제에서는 24로 설정)의 경우 96 + IPv4PrefixLength 수식에서 해당 IPv6 접두사 길이를 확인할 수 있습니다.</li><li>DirectAccess 클라이언트의 IPv6 주소에 대해 다음을 추가 합니다.<br/><br/><ul><li>Teredo 기반 DirectAccess 클라이언트의 경우: 2001:0: WWXX: YYZZ::/64 범위에 대 한 IPv6 서브넷입니다. 여기서 WWXX: YYZZ은 원격 액세스 서버에 대 한 첫 번째 인터넷 연결 IPv4 주소의 콜론 16 진수 버전입니다. .</li><li>IP-HTTPS 기반 DirectAccess 클라이언트의 경우: 2002: WWXX: YYZZ: 8100:/56 범위의 IPv6 서브넷입니다. 여기서 WWXX: YYZZ는 원격 액세스 서버의 첫 번째 인터넷 연결 IPv4 주소 (w. x. y z)의 콜론 16 진수 버전입니다. .</li><li>6to4 기반 DirectAccess 클라이언트: 2002:으로 시작 하는 일련의 6to4 기반 IPv6 접두사는 IANA (인터넷 할당 기관) 및 지역 레지스트리에서 관리 되는 지역, 공용 IPv4 주소 접두사를 나타냅니다. 공용 IPv4 주소 접두사 w. x. y. z/n에 대 한 6to4 기반 접두사는 2002: WWXX: YYZZ::/[16 + n]입니다. 여기서 WWXX: YYZZ은 콜론 16 진수 w.x.y.z.입니다.<br/><br/>        예를 들어 7.0.0.0/8 범위는 북아메리카에 대 한 인터넷 번호 (ARIN)에 대해 미국 레지스트리에서 관리 됩니다. 이 공용 IPv6 주소 범위에 해당 하는 6to4 기반 접두사는 2002:700::/24입니다. IPv4 공용 주소 공간에 대 한 자세한 내용은 [IANA Ipv4 주소 공간 레지스트리](https://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.xml)를 참조 하세요. .</li></ul></li></ol>|  
  
> [!IMPORTANT]  
> DirectAccess 서버의 내부 인터페이스에 공용 IP 주소가 있는지 확인 합니다. 내부 인터페이스에 공용 IP 주소가 있는 경우 ISATAP를 통한 연결이 실패할 수 있습니다.  
  
### <a name="plan-firewall-requirements"></a>방화벽 요구 사항 계획  
원격 액세스 서버가 경계면 방화벽 뒤에 있는 경우 원격 액세스 서버가 IPv4 인터넷에 있으면 원격 액세스 트래픽에 대한 다음과 같은 예외가 필요합니다.  
  
-   IP-HTTPS: 전송 제어 프로토콜 (TCP) 대상 포트 443 및 TCP 원본 포트 443 아웃 바운드입니다.  
  
-   Teredo 트래픽: UDP (사용자 데이터 그램 프로토콜) 대상 포트 3544 인바운드, UDP 원본 포트 3544 아웃 바운드  
  
-   6to4 트래픽의 경우: IP 프로토콜 41 인바운드 및 아웃 바운드입니다.  
  
    > [!NOTE]  
    > Teredo 및 6to4 트래픽의 경우 이 예외는 원격 액세스 서버의 연속된 인터넷 연결 공용 IPv4 주소 둘 다에 대해 적용되어야 합니다.  
    >   
    > IP-HTTPS의 경우 예외는 공용 DNS 서버에 등록 된 주소에 적용 해야 합니다.  
  
-   단일 네트워크 어댑터를 사용 하 여 원격 액세스를 배포 하 고 원격 액세스 서버에 네트워크 위치 서버를 설치 하는 경우 TCP 포트 62000을 사용 합니다.  
  
    > [!NOTE]  
    > 이 예외는 원격 액세스 서버에 있고 이전 예외는에 지 방화벽에 있습니다.  
  
원격 액세스 서버가 IPv6 인터넷에 있는 경우 원격 액세스 트래픽에는 다음과 같은 예외가 필요 합니다.  
  
-   IP 프로토콜 50  
  
-   UDP 대상 포트 500 인바운드, UDP 원본 포트 500 아웃바운드  
  
-   ICMPv6 트래픽 인바운드 및 아웃 바운드 (Teredo를 사용 하는 경우에만).  
  
추가 방화벽을 사용 하는 경우 원격 액세스 트래픽에 대해 다음 내부 네트워크 방화벽 예외를 적용 합니다.  
  
-   ISATAP: Protocol 41 인바운드 및 아웃 바운드  
  
-   모든 IPv4/IPv6 트래픽: TCP/UD  
  
-   Teredo: 모든 IPv4/IPv6 트래픽에 대 한 ICMP  
  
### <a name="plan-certificate-requirements"></a>인증서 요구 사항 계획  
단일 원격 액세스 서버를 배포할 때 인증서가 필요한 세 가지 시나리오가 있습니다.  
  
-   **Ipsec 인증**: ipsec에 대 한 인증서 요구 사항에는 원격 액세스 서버와의 ipsec 연결을 설정할 때 directaccess 클라이언트 컴퓨터에서 사용 하는 컴퓨터 인증서 및 directaccess 클라이언트와의 ipsec 연결을 설정 하기 위해 원격 액세스 서버에서 사용 하는 컴퓨터 인증서가 포함 됩니다.  
  
    Windows Server 2012의 DirectAccess에서는 이러한 IPsec 인증서를 반드시 사용 해야 하는 것은 아닙니다. 대 안으로, 원격 액세스 서버는 인증서를 요구 하지 않고 Kerberos 인증에 대 한 프록시로 작동할 수 있습니다. Kerberos 인증을 사용 하는 경우 SSL을 통해 작동 하 고 Kerberos 프로토콜은 IP-HTTPS 용으로 구성 된 인증서를 사용 합니다. 일부 엔터프라이즈 시나리오 (멀티 사이트 배포 및 일회용 암호 클라이언트 인증 포함)에서는 Kerberos 인증이 아니라 인증서 인증을 사용 해야 합니다.  
  
-   **Ip-https 서버**: 원격 액세스를 구성 하는 경우 원격 액세스 서버가 ip-https 웹 수신기 역할을 하도록 자동으로 구성 됩니다. IP-HTTPS 사이트에는 웹 사이트 인증서가 필요하므로 클라이언트 컴퓨터에서 인증서의 CRL(인증서 해지 목록) 사이트에 연결할 수 있어야 합니다.  
  
-   **네트워크 위치 서버**: 네트워크 위치 서버는 클라이언트 컴퓨터가 회사 네트워크에 있는지 여부를 검색 하는 데 사용 되는 웹 사이트입니다. 네트워크 위치 서버에는 웹 사이트 인증서가 필요합니다. DirectAccess 클라이언트에서 인증서의 CRL 사이트에 연결할 수 있어야 합니다.  
  
이러한 각 시나리오에 대 한 CA (인증 기관) 요구 사항은 다음 표에 요약 되어 있습니다.  
  
|IPsec 인증|IP-HTTPS 서버|네트워크 위치 서버|  
|------------|----------|--------------|  
|인증을 위해 Kerberos 프로토콜을 사용 하지 않는 경우 원격 액세스 서버 및 클라이언트에서 IPsec 인증을 위해 컴퓨터 인증서를 발급 하려면 내부 CA가 필요 합니다.|내부 CA: 내부 CA를 사용 하 여 IP-HTTPS 인증서를 발급할 수 있습니다. 그러나 CRL 배포 지점을 외부에서 사용할 수 있는지 확인 해야 합니다.|내부 CA: 내부 CA를 사용 하 여 네트워크 위치 서버 웹 사이트 인증서를 발급할 수 있습니다. 그러나 내부 네트워크에서 CRL 배포 지점을 항상 사용할 수 있어야 합니다.|  
||자체 서명 된 인증서: IP-HTTPS 서버에 자체 서명 된 인증서를 사용할 수 있습니다. 멀티 사이트 배포에는 자체 서명된 인증서를 사용할 수 없습니다.|자체 서명 된 인증서: 네트워크 위치 서버 웹 사이트에 자체 서명 된 인증서를 사용할 수 있습니다. 그러나 멀티 사이트 배포에는 자체 서명 된 인증서를 사용할 수 없습니다.|  
||공용 CA: 공용 CA를 사용 하 여 IP-HTTPS 인증서를 발급 하는 것이 좋습니다. 이렇게 하면 외부에서 CRL 배포 지점을 사용할 수 있습니다.||  
  
#### <a name="plan-computer-certificates-for-ipsec-authentication"></a>IPsec 인증용 컴퓨터 인증서 계획  
인증서 기반 IPsec 인증을 사용 하는 경우 원격 액세스 서버와 클라이언트에서 컴퓨터 인증서를 가져와야 합니다. 인증서를 설치 하는 가장 간단한 방법은 그룹 정책를 사용 하 여 컴퓨터 인증서에 대 한 자동 등록을 구성 하는 것입니다. 이렇게 하면 모든 도메인 구성원이 엔터프라이즈 CA에서 인증서를 가져옵니다. 엔터프라이즈 조직에서 설정 하는 CA가 참조 [Active Directory 인증서 서비스](https://technet.microsoft.com/library/cc770357.aspx)합니다.  
  
이 인증서에는 다음과 같은 요구 사항이 있습니다.  
  
-   인증서에 클라이언트 인증 EKU (확장 키 사용)가 있어야 합니다.  
  
-   클라이언트와 서버 인증서는 동일한 루트 인증서와 관련 되어야 합니다. DirectAccess 구성 설정에서 이 루트 인증서를 선택해야 합니다.  
  
#### <a name="plan-certificates-for-ip-https"></a>IP-HTTPS용 인증서 계획  
원격 액세스 서버가 IP-HTTPS 수신기 역할을 하므로 서버에 HTTPS 웹 사이트 인증서를 수동으로 설치해야 합니다. 계획 시 고려할 사항은 다음과 같습니다.  
  
-   CRL을 항상 사용할 수 있도록 공용 CA를 사용하는 것이 좋습니다.  
  
-   주체 필드에 원격 액세스 서버 인터넷 어댑터의 IPv4 주소를 지정 하거나 IP-HTTPS URL (ConnectTo 주소)의 FQDN을 지정 합니다. 원격 액세스 서버가 NAT 장치 뒤에 있는 경우에는 NAT 장치의 공개 이름 또는 주소를 지정해야 합니다.  
  
-   인증서의 일반 이름이 IP-HTTPS 사이트의 이름과 일치해야 합니다.  
  
-   에 대 한는 **향상 된 키 용도** 필드의 경우는 서버 인증 OID (개체 식별자)를 사용 합니다.  
  
-   **CRL 배포 지점** 필드의 경우 인터넷에 연결된 DirectAccess 클라이언트에서 액세스할 수 있는 CRL 배포 지점을 지정합니다.  
  
    > [!NOTE]  
    > 이는 Windows 7을 실행 하는 클라이언트에만 필요 합니다.  
  
-   IP-HTTPS 인증서에 프라이빗 키가 있어야 합니다.  
  
-   IP-HTTPS 인증서를 개인 저장소로 직접 가져와야 합니다.  
  
-   IP-HTTPS 인증서 이름에 와일드카드 문자를 사용할 수 있습니다.  
  
#### <a name="plan-website-certificates-for-the-network-location-server"></a>네트워크 위치 서버용 웹 사이트 인증서 계획  
네트워크 위치 서버 웹 사이트를 계획할 때 다음 사항을 고려 하세요.  
  
-   **주체** 필드에 네트워크 위치 서버의 인트라넷 인터페이스 IP 주소 또는 네트워크 위치 URL의 FQDN을 지정합니다.  
  
-   확장 된 **키 사용** 필드의 경우 서버 인증 OID를 사용 합니다.  
  
-   **Crl 배포 지점** 필드의 경우 인트라넷에 연결 된 DirectAccess 클라이언트에서 액세스할 수 있는 crl 배포 지점을 사용 합니다. 이 CRL 배포 지점에는 내부 네트워크 외부에서 액세스할 수 없습니다.  
  
> [!NOTE]  
> IP-HTTPS 및 네트워크 위치 서버의 인증서에 주체 이름이 있는지 확인 합니다. 인증서가 대체 이름을 사용 하는 경우 원격 액세스 마법사에서 허용 되지 않습니다.  
  
#### <a name="plan-dns-requirements"></a>DNS 요구 사항 계획  
이 섹션에서는 원격 액세스 배포의 클라이언트 및 서버에 대 한 DNS 요구 사항을 설명 합니다.  
  
##### <a name="directaccess-client-requests"></a>DirectAccess 클라이언트 요청  
내부 네트워크에 없는 DirectAccess 클라이언트 컴퓨터의 요청을 확인하는 데 DNS가 사용됩니다. DirectAccess 클라이언트는 DirectAccess 네트워크 위치 서버에 연결 하 여 인터넷 또는 회사 네트워크에 있는지 여부를 확인 합니다.  
  
-   연결에 성공 하면 클라이언트가 인트라넷에 있는 것으로 확인 되 고, DirectAccess가 사용 되지 않으며, 클라이언트 요청이 클라이언트 컴퓨터의 네트워크 어댑터에 구성 된 DNS 서버를 사용 하 여 확인 됩니다.  
  
-   연결에 실패하면 클라이언트가 인트라넷에 있는 것으로 간주됩니다. 이 경우 DirectAccess 클라이언트는 NRPT(이름 확인 정책 테이블)를 사용하여 이름 요청을 확인할 때 사용할 DNS 서버를 결정합니다. 클라이언트에서 DirectAccess DNS64를 사용하여 이름을 확인하거나, 대체 내부 DNS 서버를 사용하도록 지정할 수 있습니다.  
  
이름 확인을 수행할 때 NRPT는 DirectAccess 클라이언트에서 요청을 처리할 방법을 식별하는 데 사용됩니다. 클라이언트는 <https://internal>와 같은 FQDN 또는 단일 레이블 이름을 요청 합니다. 단일 레이블 이름이 요청된 경우 FQDN을 만들기 위해 DNS 접미사가 추가됩니다. DNS 쿼리가 NRPT의 항목과 일치 하 고 DNS64 또는 인트라넷 DNS 서버가 해당 항목에 대해 지정 된 경우 해당 쿼리는 지정 된 서버를 사용 하 여 이름 확인을 위해 전송 됩니다. 일치가 있지만 DNS 서버가 지정 되지 않은 경우 예외 규칙 및 일반 이름 확인이 적용 됩니다.  
  
원격 액세스 관리 콘솔에서 NRPT에 새 접미사가 추가 된 경우 **검색** 단추를 클릭 하 여 해당 접미사의 기본 DNS 서버를 자동으로 검색할 수 있습니다. 자동 검색은 다음과 같이 작동 합니다.  
  
-   회사 네트워크가 IPv4 기반 이거나 i p v 4와 i p v 6을 사용 하는 경우 기본 주소는 원격 액세스 서버에 있는 내부 어댑터의 DNS64 주소입니다.  
  
-   회사 네트워크가 IPv6 기반인 경우 기본 주소는 회사 네트워크에 있는 DNS의 IPv6 주소입니다.  
  
##### <a name="infrastructure-servers"></a>인프라 서버  
  
-   **네트워크 위치 서버**  
  
    DirectAccess 클라이언트는 내부 네트워크에 있는지 확인하기 위해 네트워크 위치 서버에 연결합니다. 내부 네트워크의 클라이언트는 네트워크 위치 서버의 이름을 확인할 수 있어야 하며 인터넷에 있을 때 이름을 확인 하지 못하도록 해야 합니다. 이를 위해 기본적으로 네트워크 위치 서버의 FQDN이 NRPT에 예외 규칙으로 추가됩니다. 또한 원격 액세스를 구성하는 경우 다음 규칙이 자동으로 만들어집니다.  
  
    -   루트 도메인 또는 원격 액세스 서버의 도메인 이름과 원격 액세스 서버에 구성 된 인트라넷 DNS 서버에 해당 하는 IPv6 주소에 대 한 DNS 접미사 규칙. 예를 들어 원격 액세스 서버가 corp.contoso.com 도메인의 구성원인 경우 corp.contoso.com DNS 접미사에 대한 규칙이 만들어집니다.  
  
    -   네트워크 위치 서버의 FQDN에 대한 예외 규칙. 예를 들어 네트워크 위치 서버 URL이 <https://nls.corp.contoso.com>인 경우 FQDN nls.corp.contoso.com에 대 한 예외 규칙이 만들어집니다.  
  
-   **IP-HTTPS 서버**  
  
    원격 액세스 서버는 ip-https 수신기 역할을 하며 해당 서버 인증서를 사용 하 여 ip-https 클라이언트를 인증 합니다. IP-HTTPS 이름은 공용 DNS 서버를 사용 하는 DirectAccess 클라이언트에서 확인할 수 있어야 합니다.  
  
##### <a name="connectivity-verifiers"></a>연결 검증 도구  
원격 액세스는 DirectAccess 클라이언트 컴퓨터에서 내부 네트워크에 대한 연결을 확인하는 데 사용하는 기본 웹 검색을 만듭니다. 검색이 정상적으로 작동하려면 다음 이름을 DNS에 수동으로 등록해야 합니다.  
  
-   **webprobehost** 는 원격 액세스 서버의 내부 IPv4 주소 또는 ipv6 전용 환경의 ipv6 주소를 확인 해야 합니다.  
  
-   **directaccess-corpconnectivityhost-** 로컬 호스트 (루프백) 주소를 확인 합니다. 및 AAAA 레코드를 만들어야 합니다. A 레코드의 값은 127.0.0.1 이며 AAAA 레코드의 값은 마지막 32 비트가 127.0.0.1 인 NAT64 접두사에서 구성 됩니다. **Get-netnattransitionconfiguration** Windows PowerShell cmdlet을 실행 하 여 NAT64 접두사를 검색할 수 있습니다.  
  
    > [!NOTE]  
    > 이는 IPv4 전용 환경 에서만 유효 합니다. IPv4 및 ipv6 전용 환경에서는 루프백 IP 주소:: 1을 사용 하 여 AAAA 레코드만 만듭니다.  
  
HTTP 또는 PING을 통해 다른 웹 주소를 사용 하 여 추가 연결 검증 도구를 만들 수 있습니다. 각 연결 검증 도구에 대한 DNS 항목이 있어야 합니다.  
  
##### <a name="dns-server-requirements"></a>DNS 서버 요구 사항  
  
-   DirectAccess 클라이언트의 경우 Windows Server 2012, Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 또는 i p v 6을 지 원하는 DNS 서버를 실행 하는 DNS 서버를 사용 해야 합니다.  
  
-   동적 업데이트를 지 원하는 DNS 서버를 사용 해야 합니다. 동적 업데이트를 지원 하지 않는 DNS 서버를 사용할 수 있지만 항목을 수동으로 업데이트 해야 합니다.  
  
-   CRL 배포 지점의 FQDN은 인터넷 DNS 서버를 사용 하 여 확인할 수 있어야 합니다. 예를 들어 URL <https://crl.contoso.com/crld/corp-DC1-CA.crl>이 원격 액세스 서버 IP-HTTPS 인증서의 **CRL 배포 요소** 필드에 있는 경우 인터넷 DNS 서버를 사용 하 여 FQDN crld.contoso.com을 확인할 수 있는지 확인 해야 합니다.  
  
#### <a name="plan-for-local-name-resolution"></a>로컬 이름 확인 계획  
로컬 이름 확인을 계획할 때 다음 사항을 고려 하세요.  
  
##### <a name="nrpt"></a>NRPT  
다음과 같은 경우 추가 NRPT (이름 확인 정책 테이블) 규칙을 만들어야 할 수 있습니다.  
  
-   인트라넷 네임 스페이스에 대 한 DNS 접미사를 더 추가 해야 합니다.  
  
-   CRL 배포 지점의 Fqdn이 인트라넷 네임 스페이스를 기반으로 하는 경우 CRL 배포 지점의 Fqdn에 대 한 예외 규칙을 추가 해야 합니다.  
  
-   분할 두뇌 DNS 환경을 사용 하는 경우 인터넷에 있는 DirectAccess 클라이언트가 인트라넷 버전이 아닌 인터넷 버전에 액세스할 수 있도록 하려는 리소스 이름에 대 한 예외 규칙을 추가 해야 합니다.  
  
-   인트라넷 웹 프록시 서버를 통해 외부 웹 사이트로 트래픽을 리디렉션하는 경우 해당 외부 웹 사이트는 인트라넷 에서만 사용할 수 있습니다. 웹 프록시 서버의 주소를 사용 하 여 인바운드 요청을 허용 합니다. 이 경우 외부 웹 사이트의 FQDN에 대 한 예외 규칙을 추가 하 고 해당 규칙에서 인트라넷 DNS 서버의 IPv6 주소 대신 인트라넷 웹 프록시 서버를 사용 하도록 지정 합니다.  
  
    예를 들어 test.contoso.com 이라는 외부 웹 사이트를 테스트 하는 경우를 가정해 보겠습니다. 인터넷 DNS 서버를 통해이 이름을 확인할 수는 없지만 Contoso 웹 프록시 서버는 이름을 확인 하는 방법 및 웹 사이트에 대 한 요청을 외부 웹 서버로 전달 하는 방법을 알고 있습니다. Contoso 인트라넷에 없는 사용자가 사이트에 액세스하지 못하도록 하기 위해 외부 웹 사이트에서는 Contoso 웹 프록시의 IPv4 인터넷 주소에서 보내는 요청만 허용합니다. 따라서 인트라넷 사용자는 Contoso 웹 프록시를 사용 하 고 있지만 DirectAccess 사용자는 Contoso 웹 프록시를 사용 하지 않기 때문에 웹 사이트에 액세스할 수 있습니다. Contoso 웹 프록시를 사용하는 test.contoso.com에 대한 NRPT 예외 규칙을 구성하면 test.contoso.com에 대한 웹 페이지 요청이 IPv4 인트라넷을 통해 인트라넷 웹 프록시 서버로 라우팅됩니다.  
  
##### <a name="single-label-names"></a>단일 레이블 이름  
<https://paycheck>와 같은 단일 레이블 이름이 인트라넷 서버에 사용 되는 경우도 있습니다. 단일 레이블 이름을 요청 하 고 DNS 접미사 검색 목록을 구성 하면 목록에 있는 DNS 접미사가 단일 레이블 이름에 추가 됩니다. 예를 들어 corp.contoso.com 도메인 형식의 구성원 인 컴퓨터의 사용자가 웹 브라우저에서 <https://paycheck> 경우 이름으로 생성 된 FQDN은 paycheck.corp.contoso.com입니다. 기본적으로 추가 된 접미사는 클라이언트 컴퓨터의 주 DNS 접미사를 기반으로 합니다.  
  
> [!NOTE]  
> 연결 되지 않은 이름 공간 시나리오 (하나 이상의 도메인 컴퓨터에 해당 컴퓨터가 구성원 인 Active Directory 도메인과 일치 하지 않는 DNS 접미사가 있는 경우)에서는 필요한 모든 접미사를 포함 하도록 검색 목록을 사용자 지정 해야 합니다. 기본적으로 원격 액세스 마법사는 Active Directory DNS 이름을 클라이언트의 주 DNS 접미사로 구성 합니다. 클라이언트에서 이름 확인에 사용하는 DNS 접미사를 추가해야 합니다.  
  
조직에서 여러 도메인과 WINS (Windows Internet Name Service)를 배포 하 고 원격으로 연결 하는 경우 다음과 같이 단일 이름을 확인할 수 있습니다.  
  
-   DNS에 WINS 전방 조회 영역을 배포 합니다. Computername.dns.zone1.corp.contoso.com을 확인 하려고 하면 컴퓨터 이름만 사용 하는 WINS 서버로 요청이 전달 됩니다. 클라이언트는 일반 DNS 레코드 요청을 발급 하는 것으로 간주 하지만 실제로는 NetBIOS 요청입니다.  
  
    자세한 내용은 [전방 조회 영역 관리](https://technet.microsoft.com/library/cc816891(WS.10).aspx)를 참조 하세요.  
  
-   기본 도메인 GPO에 DNS 접미사 (예: dns.zone1.corp.contoso.com)를 추가 합니다.  
  
##### <a name="split-brain-dns"></a>스플릿 브레인(Split-Brain) DNS  
분할-두뇌 DNS는 인터넷 및 인트라넷 이름 확인에 동일한 DNS 도메인을 사용 하는 것을 의미 합니다.  
  
스플릿 브레인 DNS 배포에 대 한 인터넷 및 인트라넷에 중복 된 리소스를 결정 하는 Fqdn을 나열 해야 도달률은 인트라넷 또는 인터넷 버전 DirectAccess 클라이언트 해야 합니다. DirectAccess 클라이언트에서 인터넷 버전에 연결 하도록 하려면 해당 FQDN을 각 리소스의 NRPT에 예외 규칙으로 추가 해야 합니다.  
  
분할 두뇌 DNS 환경에서 리소스의 두 버전을 모두 사용할 수 있도록 하려면 인터넷에서 사용 되는 이름과 중복 되지 않는 이름을 사용 하 여 인트라넷 리소스를 구성 합니다. 그런 다음 사용자가 인트라넷에서 리소스에 액세스할 때 대체 이름을 사용 하도록 지시 합니다. 예를 들어 www\.contoso.com의 내부 이름에 대해 www\.internal.contoso.com를 구성 합니다.  
  
스플릿 브레인이 아닌 DNS 환경에서는 인터넷 네임스페이스가 인트라넷 네임스페이스와 다릅니다. 예를 들어 인터넷의 네임스페이스는 Contoso Corporation uses contoso.com이고 인트라넷의 네임스페이스는 corp.contoso.com인 경우를 살펴보겠습니다. 모든 인트라넷 리소스는 corp.contoso.com DNS 접미사를 사용하므로 corp.contoso.com에 대한 NRPT 규칙에 따라 인트라넷 리소스에 대한 모든 DNS 이름 쿼리가 인트라넷 DNS 서버로 라우팅됩니다. Contoso.com 접미사가 있는 이름에 대 한 DNS 쿼리는 NRPT의 corp.contoso.com 인트라넷 네임 스페이스 규칙과 일치 하지 않으므로 인터넷 DNS 서버로 전송 됩니다. 스플릿 브레인이 아닌 DNS 환경에서는 인트라넷 리소스와 인터넷 리소스의 FQDN이 중복되지 않으므로 NRPT에 대한 추가 구성이 필요 없습니다. DirectAccess 클라이언트는 조직의 인터넷 리소스와 인트라넷 리소스 모두에 액세스할 수 있습니다.  
  
##### <a name="plan-local-name-resolution-behavior-for-directaccess-clients"></a>DirectAccess 클라이언트에 대 한 로컬 이름 확인 동작 계획  
DNS로 이름을 확인할 수 없는 경우 Windows Server 2012, Windows 8, Windows Server 2008 R2 및 Windows 7의 DNS 클라이언트 서비스는 로컬 서브넷에서 이름을 확인 하기 위해 LLMNR (링크-로컬 멀티 캐스트 이름 확인) 및 NetBIOS over TCP/IP 프로토콜을 사용 하 여 로컬 이름 확인을 사용할 수 있습니다. 로컬 이름 확인은 컴퓨터가 단일 서브넷 홈 네트워크와 같은 프라이빗 네트워크에 있는 경우 일반적으로 피어-투-피어 연결에 필요합니다.  
  
DNS 클라이언트 서비스에서 인트라넷 서버 이름에 대 한 로컬 이름 확인을 수행 하 고 컴퓨터가 인터넷의 공유 서브넷에 연결 되어 있으면 악의적인 사용자가 LLMNR 및 NetBIOS over TCP/IP 메시지를 캡처하여 인트라넷 서버 이름을 확인할 수 있습니다. 인프라 서버 설치 마법사의 DNS 페이지에서 인트라넷 DNS 서버 로부터 받은 응답 유형에 따라 로컬 이름 확인 동작을 구성할 수 있습니다. 사용할 수 있는 옵션은 다음과 같습니다.  
  
-   **DNS에 이름이 없는 경우 로컬 이름 확인 사용**:이 옵션은 DirectAccess 클라이언트가 인트라넷 DNS 서버에서 확인할 수 없는 서버 이름에 대해서만 로컬 이름 확인을 수행 하기 때문에 가장 안전 합니다. 인트라넷 DNS 서버에 연결할 수 있는 경우 인트라넷 서버의 이름이 확인됩니다. 인트라넷 DNS 서버에 연결할 수 없거나 다른 유형의 DNS 오류가 있는 경우에는 인트라넷 서버 이름이 로컬 이름 확인을 통해 서브넷에 유출되지 않습니다.  
  
-   **Dns에 이름이 없는 경우 로컬 이름 확인 사용 또는 클라이언트 컴퓨터가 개인 네트워크에 있을 때 dns 서버에 연결할 수 없는 경우 (권장)** :이 옵션은 인트라넷 DNS 서버에 연결할 수 없는 경우에만 개인 네트워크에서 로컬 이름 확인을 사용할 수 있기 때문에 권장 됩니다.  
  
-   **모든 종류의 DNS 확인 오류 (가장 안전 하지 않음)에 대해 로컬 이름 확인 사용**: 로컬 이름 확인을 통해 로컬 서브넷에 대해 인트라넷 네트워크 서버 이름이 유출 될 수 있으므로 보안 수준이 가장 낮은 옵션입니다.  
  
#### <a name="plan-the-network-location-server-configuration"></a>네트워크 위치 서버 구성 계획  
네트워크 위치 서버는 DirectAccess 클라이언트가 회사 네트워크에 있는지 검색하는 데 사용되는 웹 사이트입니다. 회사 네트워크의 클라이언트는 DirectAccess를 사용 하 여 내부 리소스에 연결 하지 않습니다. 대신 직접 연결 합니다.  
  
네트워크 위치 서버 웹 사이트는 원격 액세스 서버 또는 조직의 다른 서버에서 호스팅될 수 있습니다. 원격 액세스 서버에서 네트워크 위치 서버를 호스트 하는 경우 원격 액세스를 배포할 때 웹 사이트가 자동으로 만들어집니다. Windows 운영 체제를 실행 하는 다른 서버에서 네트워크 위치 서버를 호스트 하는 경우 해당 서버에 인터넷 정보 서비스 (IIS)가 설치 되어 있고 웹 사이트가 만들어졌는지 확인 해야 합니다. 원격 액세스는 네트워크 위치 서버에서 설정을 구성 하지 않습니다.  
  
네트워크 위치 서버 웹 사이트가 다음 요구 사항을 충족 하는지 확인 합니다.  
  
-   에는 HTTPS 서버 인증서가 있습니다.  
  
-   내부 네트워크의 컴퓨터에 대해 고가용성을 제공 합니다.  
  
-   는 인터넷의 DirectAccess 클라이언트 컴퓨터에서 액세스할 수 없습니다.  
  
-  
  
또한 네트워크 위치 서버 웹 사이트를 설정할 때 클라이언트에 대 한 다음 요구 사항을 고려해 야 합니다.  
  
-   DirectAccess 클라이언트 컴퓨터가 네트워크 위치 서버 웹 사이트에 서버 인증서를 발급한 CA를 신뢰해야 합니다.  
  
-   내부 네트워크의 DirectAccess 클라이언트 컴퓨터에서 네트워크 위치 서버 사이트의 이름을 확인할 수 있어야 합니다.  
  
##### <a name="plan-certificates-for-the-network-location-server"></a>네트워크 위치 서버용 인증서 계획  
네트워크 위치 서버에 사용할 웹 사이트 인증서를 가져오는 경우 다음을 고려 하십시오.  
  
-   에 **주체** 필드에 네트워크 위치 서버의 인트라넷 인터페이스 또는 네트워크 위치 URL의 FQDN의 IP 주소를 지정 합니다.  
  
-   확장 된 **키 사용** 필드의 경우 서버 인증 OID를 사용 합니다.  
  
-   네트워크 위치 서버 인증서를 CRL (인증서 해지 목록)에 대해 확인 해야 합니다. **Crl 배포 지점** 필드의 경우 인트라넷에 연결 된 DirectAccess 클라이언트에서 액세스할 수 있는 crl 배포 지점을 사용 합니다. 이 CRL 배포 지점에는 내부 네트워크 외부에서 액세스할 수 없습니다.  
  
##### <a name="plan-dns-for-the-network-location-server"></a>네트워크 위치 서버용 DNS 계획  
DirectAccess 클라이언트는 내부 네트워크에 있는지 확인하기 위해 네트워크 위치 서버에 연결합니다. 내부 네트워크의 클라이언트는 네트워크 위치 서버의 이름을 확인할 수 있어야 하지만, 인터넷에 있을 때는 이름을 확인하지 못하도록 설정되어야 합니다. 이를 위해 기본적으로 네트워크 위치 서버의 FQDN이 NRPT에 예외 규칙으로 추가됩니다.  
  
### <a name="plan-management-servers-configuration"></a>관리 서버 구성 계획  
DirectAccess 클라이언트는 Windows 업데이트 및 바이러스 백신 업데이트와 같은 서비스를 제공 하는 관리 서버와의 통신을 시작 합니다. 또한 DirectAccess 클라이언트는 내부 네트워크에 액세스 하기 전에 Kerberos 프로토콜을 사용 하 여 도메인 컨트롤러에 인증 합니다. DirectAccess 클라이언트의 원격 관리 중에 관리 서버는 클라이언트 컴퓨터와 통신하여 소프트웨어 또는 하드웨어 인벤토리 평가와 같은 관리 기능을 수행합니다. 원격 액세스에서는 다음을 비롯한 일부 관리 서버를 자동으로 검색할 수 있습니다.  
  
-   도메인 컨트롤러: 클라이언트 컴퓨터를 포함 하는 도메인 및 원격 액세스 서버와 동일한 포리스트에 있는 모든 도메인에 대해 도메인 컨트롤러 자동 검색이 수행 됩니다.  
  
-   Microsoft 끝점 Configuration Manager 서버  
  
도메인 컨트롤러 및 Configuration Manager 서버는 DirectAccess가 처음 구성 될 때 자동으로 검색 됩니다. 검색 된 도메인 컨트롤러는 콘솔에 표시 되지 않지만 Windows PowerShell cmdlet을 사용 하 여 설정을 검색할 수 있습니다. 도메인 컨트롤러 또는 Configuration Manager 서버가 수정 된 경우 콘솔에서 **업데이트 관리 서버** 를 클릭 하면 관리 서버 목록이 새로 고쳐집니다.  
  
**관리 서버 요구 사항**  
  
-   인프라 터널을 통해 관리 서버에 액세스할 수 있어야 합니다. 원격 액세스를 구성할 때 관리 서버 목록에 서버를 추가하면 이 터널을 통해 해당 서버에 액세스할 수 있도록 자동으로 설정됩니다.  
  
-   DirectAccess 클라이언트에 대 한 연결을 시작 하는 관리 서버는 기본 IPv6 주소를 사용 하거나 ISATAP에서 할당 된 주소를 사용 하 여 IPv6을 완전히 지원 해야 합니다.  
  
### <a name="plan-active-directory-requirements"></a>계획 Active Directory 요구 사항  
원격 액세스에서는 다음과 같이 Active Directory를 사용 합니다.  
  
-   **인증**: 인프라 터널은 원격 액세스 서버에 연결 하는 컴퓨터 계정에 대해 NTLMv2 인증을 사용 하며, 계정은 Active Directory 도메인에 있어야 합니다. 인트라넷 터널에서는 사용자에 대해 Kerberos 인증을 사용 하 여 인트라넷 터널을 만듭니다.  
  
-   **그룹 정책 개체**: 원격 액세스는 원격 액세스 서버, 클라이언트 및 내부 응용 프로그램 서버에 적용 되는 구성 설정을 gpo (그룹 정책 개체)로 수집 합니다.  
  
-   **보안 그룹**: 원격 액세스는 보안 그룹을 사용 하 여 DirectAccess 클라이언트 컴퓨터를 수집 및 식별 합니다. Gpo는 필요한 보안 그룹에 적용 됩니다.  
  
원격 액세스 배포를 위한 Active Directory 환경을 계획 하는 경우 다음 요구 사항을 고려 하세요.  
  
-   하나 이상의 도메인 컨트롤러가 Windows Server 2012, Windows Server 2008 R2 Windows Server 2008 또는 Windows Server 2003 운영 체제에 설치 되어 있어야 합니다.  
  
    도메인 컨트롤러가 경계 네트워크에 있는 경우 (따라서 원격 액세스 서버의 인터넷 연결 네트워크 어댑터에서 연결할 수 있는 경우) 원격 액세스 서버에서 해당 네트워크 어댑터에 연결할 수 없습니다. 인터넷 어댑터의 IP 주소에 대 한 연결을 방지 하려면 도메인 컨트롤러에 패킷 필터를 추가 해야 합니다.  
  
-   원격 액세스 서버가 도메인 구성원이어야 합니다.  
  
-   DirectAccess 클라이언트가 도메인 구성원이어야 합니다. 클라이언트는 다음에 속할 수 있습니다.  
  
    -   원격 액세스 서버와 동일한 포리스트의 모든 도메인  
  
    -   원격 액세스 서버 도메인과 양방향 트러스트 관계에 있는 모든 도메인  
  
    -   원격 액세스 서버 도메인의 포리스트와 양방향 트러스트 관계에 있는 포리스트의 모든 도메인  
  
> [!NOTE]  
> -   원격 액세스 서버는 도메인 컨트롤러일 수 없습니다.  
> -   원격 액세스 서버의 외부 인터넷 어댑터에서 원격 액세스에 사용 되는 Active Directory 도메인 컨트롤러에 연결할 수 없어야 합니다. 즉, 어댑터가 Windows 방화벽의 도메인 프로필에 없어야 합니다.  
  
#### <a name="plan-client-authentication"></a>클라이언트 인증 계획  
Windows Server 2012의 원격 액세스에서 사용자 이름 및 암호를 사용 하거나 IPsec 컴퓨터 인증용 인증서를 사용 하는 기본 제공 Kerberos 인증을 사용 하도록 선택할 수 있습니다.  
  
**Kerberos 인증**: 인증에 Active Directory 자격 증명을 사용 하도록 선택 하는 경우 DirectAccess는 먼저 컴퓨터에 kerberos 인증을 사용 하 고 사용자에 대해 kerberos 인증을 사용 합니다. 이 인증 모드를 사용 하는 경우 DirectAccess에서는 DNS 서버, 도메인 컨트롤러 및 내부 네트워크의 다른 서버에 대 한 액세스를 제공 하는 단일 보안 터널을 사용 합니다.  
  
**IPsec 인증**: 2 단계 인증 또는 네트워크 액세스 보호를 사용 하도록 선택한 경우 DirectAccess에서는 두 개의 보안 터널을 사용 합니다. 원격 액세스 설치 마법사는 고급 보안이 포함 된 Windows 방화벽에서 연결 보안 규칙을 구성 합니다. 이러한 규칙은 원격 액세스 서버에 IPsec 보안을 협상할 때 다음 자격 증명을 지정 합니다.  
  
-   인프라 터널은 두 번째 인증에 대해 NTLMv2 (첫 번째 인증 및 사용자) 자격 증명에 대 한 컴퓨터 인증서 자격 증명을 사용 합니다. 사용자 자격 증명은 AuthIP (인증된 인터넷 프로토콜)를 강제로 사용 하며, DirectAccess 클라이언트에서 인트라넷 터널에 Kerberos 자격 증명을 사용할 수 있기 전에 DNS 서버 및 도메인 컨트롤러에 대 한 액세스를 제공 합니다.  
  
-   인트라넷 터널에서는 첫 번째 인증에 컴퓨터 인증서 자격 증명을 사용 하 고 두 번째 인증에 대 한 사용자 (Kerberos V5) 자격 증명을 사용 합니다.  
  
#### <a name="plan-multiple-domains"></a>여러 도메인 계획  
관리 서버 목록에는 DirectAccess 클라이언트 컴퓨터가 포함된 보안 그룹을 포함하는 모든 도메인의 도메인 컨트롤러가 포함되어야 합니다. DirectAccess 클라이언트로 구성 된 컴퓨터를 사용할 수 있는 사용자 계정을 포함 하는 모든 도메인을 포함 해야 합니다. 그러면 사용 중인 클라이언트 컴퓨터와 동일한 도메인에 있지 않은 사용자가 사용자 도메인의 도메인 컨트롤러로 인증을 받을 수 있게 됩니다.  
  
도메인이 동일한 포리스트에 있는 경우에는이 인증이 자동으로 진행 됩니다. 다른 포리스트에 있는 클라이언트 컴퓨터 또는 응용 프로그램 서버를 포함 하는 보안 그룹이 있는 경우 해당 포리스트의 도메인 컨트롤러는 자동으로 검색 되지 않습니다. 또한 포리스트는 자동으로 검색 되지 않습니다. **원격 액세스 관리** 에서 작업 **업데이트 관리 서버** 를 실행 하 여 이러한 도메인 컨트롤러를 검색할 수 있습니다.  
  
가능 하면 원격 액세스 배포 중에 공통 도메인 이름 접미사를 NRPT에 추가 해야 합니다. 예를 들어 두 개의 도메인 domain1.corp.contoso.com과 domain2.corp.contoso.com이 있는 경우 NRPT에 두 항목을 추가하는 대신 공통 DNS 접미사 항목(여기서 도메인 이름 접미사는 corp.contoso.com)을 추가할 수 있습니다. 이는 동일한 루트의 도메인에 대해 자동으로 발생 합니다. 동일한 루트에 있지 않은 도메인은 수동으로 추가 해야 합니다.  
  
### <a name="plan-group-policy-object-creation"></a>계획 그룹 정책 개체 만들기  
원격 액세스를 구성할 때 DirectAccess 설정은 Gpo (그룹 정책 Objects)로 수집 됩니다. 두 Gpo가 DirectAccess 설정으로 채워지고 다음과 같이 배포 됩니다.  
  
-   **DirectAccess 클라이언트 gpo**:이 Gpo는 IPv6 전환 기술 설정, NRPT 항목, 고급 보안이 포함 된 Windows 방화벽에 대 한 연결 보안 규칙 등의 클라이언트 설정을 포함 합니다. 클라이언트 컴퓨터에 지정된 보안 그룹에 적용됩니다.  
  
-   **Directaccess 서버 gpo**:이 gpo는 배포에서 원격 액세스 서버로 구성 된 모든 서버에 적용 되는 DirectAccess 구성 설정을 포함 합니다. 또한 고급 보안이 포함 된 Windows 방화벽에 대 한 연결 보안 규칙을 포함 합니다.  
  
> [!NOTE]  
> 클라이언트에서 응용 프로그램 서버가 상주 하는 DirectAccess 서버의 내부 네트워크에 액세스할 수 없기 때문에 응용 프로그램 서버 구성은 DirectAccess 클라이언트의 원격 관리에서 지원 되지 않습니다. 이 유형의 구성에서는 원격 액세스 설치 구성 화면의 4 단계를 사용할 수 없습니다.  
  
자동 또는 수동으로 Gpo를 구성할 수 있습니다.  
  
**자동**: gpo를 자동으로 만들도록 지정 하면 각 gpo에 대해 기본 이름이 지정 됩니다.  
  
**수동**: Active Directory 관리자가 미리 정의한 gpo를 사용할 수 있습니다.  
  
Gpo를 구성할 때 다음 경고를 고려 하십시오.  
  
-   DirectAccess가 특정 GPO를 사용하도록 구성된 후에는 다른 GPO를 사용하도록 구성할 수 없습니다.  
  
-   DirectAccess cmdlet을 실행 하기 전에 모든 원격 액세스 그룹 정책 개체를 백업 하려면 다음 절차를 따르십시오.  
  
    [원격 액세스 구성 백업 및 복원](https://go.microsoft.com/fwlink/?LinkID=257928) 절차에 따라 모든 원격 액세스 GPO를 백업합니다.  
  
-   자동 또는 수동으로 구성 된 Gpo를 사용 하는 경우에는 클라이언트가 3G를 사용 하는 경우 저속 연결 검색에 대 한 정책을 추가 해야 합니다. 정책에 대 한 경로 **: 그룹 정책 저속 연결 검색 구성** :  
  
    **컴퓨터 구성/정책/관리 템플릿/시스템/그룹 정책**입니다.  
  
-   Gpo 연결에 대 한 올바른 권한이 없는 경우 경고가 발생 합니다. 원격 액세스 작업은 계속 되지만 연결이 발생 하지 않습니다. 이 경고가 발생 하면 나중에 사용 권한을 추가한 경우에도 연결이 자동으로 생성 되지 않습니다. 대신 관리자가 수동으로 연결을 만들어야 합니다.  
  
#### <a name="automatically-created-gpos"></a>자동으로 만들어진 Gpo  
자동으로 만들어진 Gpo를 사용 하는 경우 다음 사항을 고려 하세요.  
  
자동으로 만들어진 GPO는 다음과 같이 위치 및 링크 대상에 따라 적용 됩니다.  
  
-   DirectAccess 서버 GPO의 경우 위치 및 연결 대상은 원격 액세스 서버를 포함 하는 도메인을 가리킵니다.  
  
-   클라이언트 및 응용 프로그램 서버 Gpo를 만들 때 위치는 단일 도메인으로 설정 됩니다. GPO 이름은 각 도메인에서 조회 되 고 도메인은 DirectAccess 설정 (있는 경우)으로 채워집니다.  
  
-   연결 대상은 GPO가 만들어진 도메인의 루트로 설정됩니다. GPO는 클라이언트 컴퓨터 또는 응용 프로그램 서버가 포함된 각 도메인에 만들어지며 각 도메인의 루트에 연결됩니다.  
  
자동으로 만들어진 Gpo를 사용 하 여 DirectAccess 설정을 적용 하는 경우 원격 액세스 서버 관리자에 게 다음 권한이 필요 합니다.  
  
-   각 도메인에 대 한 Gpo를 만들 수 있는 권한  
  
-   선택한 모든 클라이언트 도메인 루트에 연결할 수 있는 권한입니다.  
  
-   서버 GPO 도메인 루트에 연결할 수 있는 권한입니다.  
  
-   Gpo를 만들고, 편집 하 고, 삭제 하 고, 수정할 수 있는 보안 권한  
  
-   필요한 각 도메인에 대 한 GPO 읽기 권한 이 권한은 필요 하지 않지만 Gpo를 만들 때 원격 액세스에서 이름이 중복 된 Gpo가 존재 하지 않는지 확인할 수 있으므로 권장 됩니다.  
  
#### <a name="manually-created-gpos"></a>수동으로 만든 Gpo  
수동으로 만든 GPO를 사용할 때 고려할 사항은 다음과 같습니다.  
  
-   원격 액세스 설치 마법사를 실행하기 전에 GPO가 존재해야 합니다.  
  
-   DirectAccess 설정을 적용 하려면 원격 액세스 서버 관리자에 게 수동으로 만든 Gpo를 만들고, 편집 하 고, 삭제 하 고, 수정 하려면 모든 보안 권한이 있어야 합니다.  
  
-   전체 도메인에서 GPO에 대 한 링크를 검색 합니다. GPO가 도메인에 연결되지 않은 경우 자동으로 도메인 루트에 연결이 만들어집니다. 연결을 만드는 데 필요한 권한이 없으면 경고가 발생합니다.  
  
#### <a name="recovering-from-a-deleted-gpo"></a>삭제된 GPO 복구  
원격 액세스 서버, 클라이언트 또는 응용 프로그램 서버의 GPO를 실수로 삭제 한 경우 **gpo (gpo 이름)를 찾을 수 없습니다**. 라는 오류 메시지가 표시 됩니다.  
  
그러나 백업을 사용할 수 있는 경우 백업에서 GPO를 복구할 수 있습니다. 사용할 수 있는 백업이 없으면 구성 설정을 제거 하 고 다시 구성 해야 합니다.  
  
###### <a name="to-remove-configuration-settings"></a>구성 설정을 제거 하려면  
  
1.  Windows **PowerShell cmdlet을 실행 합니다.**  
  
2.  **원격 액세스 관리**를 엽니다.  
  
3.  GPO를 찾을 수 없다는 오류 메시지가 표시됩니다. **구성 설정 제거**를 클릭합니다. 완료 되 면 서버가 구성 되지 않은 상태로 복원 되 고 설정을 다시 구성할 수 있습니다.  
  


