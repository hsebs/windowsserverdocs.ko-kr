---
title: Windows 인증에서 자격 증명 프로세스
description: Windows Server 보안
ms.prod: windows-server
ms.technology: security-windows-auth
ms.topic: article
ms.assetid: 48c60816-fb8b-447c-9c8e-800c2e05b14f
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: 2de8383ce6a946dfdd80cfc027478c495037169b
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80857586"
---
# <a name="credentials-processes-in-windows-authentication"></a>Windows 인증에서 자격 증명 프로세스

>적용 대상: Windows Server(반기 채널), Windows Server 2016

IT 전문가를 위한이 참조 항목에서는 Windows 인증에서 자격 증명을 처리 하는 방법을 설명 합니다.

Windows 자격 증명 관리는 운영 체제에서 서비스 또는 사용자 로부터 자격 증명을 수신 하 고 이후 프레젠테이션을 인증 대상으로 보호 하는 데 사용 되는 프로세스입니다. 도메인에 가입 된 컴퓨터의 경우 인증 대상이 도메인 컨트롤러입니다. 인증에 사용 되는 자격 증명은 인증서, 암호 또는 PIN과 같은 사용자의 id를 일종의 인증 형식에 연결 하는 디지털 문서입니다.

기본적으로 Windows 자격 증명은 로컬 컴퓨터의 SAM (보안 계정 관리자) 데이터베이스에 대해 또는 Winlogon 서비스를 통해 도메인에 가입 된 컴퓨터의 Active Directory에 대해 유효성이 검사 됩니다. 자격 증명은 로그온 사용자 인터페이스에 대 한 사용자 입력을 통해 또는 프로그래밍 방식으로 API (응용 프로그래밍 인터페이스)를 통해 인증 대상에 제공 됩니다.

로컬 보안 정보는 **HKEY_LOCAL_MACHINE \security**의 레지스트리에 저장 됩니다. 저장 된 정보에는 정책 설정, 기본 보안 값 및 계정 정보 (예: 캐시 된 로그온 자격 증명)가 포함 됩니다. SAM 데이터베이스의 복사본은 쓰기 보호 된 경우에도 여기에 저장 됩니다.

다음 다이어그램은 필요한 구성 요소와 자격 증명이 시스템을 통해 사용자 또는 프로세스를 인증 하는 데 필요한 경로를 보여 줍니다.

![사용자 또는 프로세스를 인증 하기 위해 자격 증명에서 시스템을 통해 수행 하는 필수 구성 요소 및 경로를 표시 하는 다이어그램입니다.](../media/credentials-processes-in-windows-authentication/AuthN_LSA_Architecture_Client.gif)

다음 표에서는 로그온 시점에 인증 프로세스에서 자격 증명을 관리 하는 각 구성 요소에 대해 설명 합니다.

**모든 시스템의 인증 구성 요소**

|구성 요소|설명|
|-------|--------|
|사용자 로그온|Csc.exe는 보안 사용자 조작 관리를 담당 하는 실행 파일입니다. Winlogon 서비스는 보안 데스크톱 (로그온 UI)의 사용자 작업으로 수집 된 자격 증명을 통해 secur32.dll를 통해 LSA (로컬 보안 기관)에 전달 하 여 Windows 운영 체제에 대 한 로그온 프로세스를 시작 합니다.|
|응용 프로그램 로그온|대화형 로그온이 필요 하지 않은 응용 프로그램 또는 서비스 로그온입니다. 사용자가 시작한 프로세스 대부분은 통해 secur32.dll를 사용 하 여 사용자 모드로 실행 되는 반면 시작 시 시작 되는 프로세스 (예: 서비스)는 Ksecdd .sys를 사용 하 여 커널 모드에서 실행 됩니다.<p>사용자 모드 및 커널 모드에 대 한 자세한 내용은이 항목의 응용 프로그램 및 사용자 모드 또는 서비스 및 커널 모드를 참조 하십시오.|
|Secur32.dll|인증 프로세스의 기초를 형성 하는 여러 인증 공급자입니다.|
|Lsasrv.dll|Lsa 서버 서비스는 보안 정책을 적용 하 고 LSA에 대 한 보안 패키지 관리자 역할을 합니다. LSA는 성공할 프로토콜을 결정 한 후 NTLM 또는 Kerberos 프로토콜을 선택 하는 Negotiate 함수를 포함 합니다.|
|보안 지원 공급자|하나 이상의 인증 프로토콜을 개별적으로 호출할 수 있는 공급자 집합입니다. 기본 공급자 집합은 각 버전의 Windows 운영 체제에서 변경 될 수 있으며 사용자 지정 공급자를 작성할 수 있습니다.|
|Netlogon.dll|Net Logon 서비스에서 수행 하는 서비스는 다음과 같습니다.<p>-도메인 컨트롤러에 대 한 컴퓨터의 보안 채널 (Schannel과 혼동 하지 않음)을 유지 관리 합니다.<br />-보안 채널을 통해 도메인 컨트롤러에 사용자 자격 증명을 전달 하 고 사용자에 대 한 Sid (도메인 보안 식별자) 및 사용자 권한을 반환 합니다.<br />-DNS (Domain Name System)에 서비스 리소스 레코드를 게시 하 고 DNS를 사용 하 여 도메인 컨트롤러의 IP (인터넷 프로토콜) 주소에 대 한 이름을 확인 합니다.<br />-주 도메인 컨트롤러 (Pdc)와 백업 도메인 컨트롤러 (Bdc)를 동기화 하는 RPC (원격 프로시저 호출)를 기반으로 복제 프로토콜을 구현 합니다.|
|Samsrv|로컬 보안 계정을 저장 하는 SAM (보안 계정 관리자)은 로컬로 저장 된 정책을 적용 하 고 Api를 지원 합니다.|
|레지스트리|레지스트리에는 SAM 데이터베이스의 복사본, 로컬 보안 정책 설정, 기본 보안 값 및 시스템에만 액세스할 수 있는 계정 정보가 포함 되어 있습니다.|

이 항목의 섹션:

-   [사용자 로그온을 위한 자격 증명 입력](#BKMK_CrentialInputForUserLogon)

-   [응용 프로그램 및 서비스 로그온을 위한 자격 증명 입력](#BKMK_CredentialInputForApplicationAndServiceLogon)

-   [로컬 보안 기관](#BKMK_LSA)

-   [캐시 된 자격 증명 및 유효성 검사](#BKMK_CachedCredentialsAndValidation)

-   [자격 증명 저장소 및 유효성 검사](#BKMK_CredentialStorageAndValidation)

-   [보안 계정 관리자 데이터베이스](#BKMK_SAM)

-   [로컬 도메인 및 트러스트 된 도메인](#BKMK_LocalDomainsAndTrustedDomains)

-   [Windows 인증의 인증서](#BKMK_CertificatesInWindowsAuthentication)

## <a name="credential-input-for-user-logon"></a><a name="BKMK_CrentialInputForUserLogon"></a>사용자 로그온을 위한 자격 증명 입력
Windows Server 2008 및 Windows Vista에서 GINA (그래픽 식별 및 인증) 아키텍처는 자격 증명 공급자 모델로 대체 되었으며 로그온 타일을 사용 하 여 다양 한 로그온 유형을 열거할 수 있습니다. 두 모델은 아래에 설명 되어 있습니다.

**그래픽 식별 및 인증 아키텍처**

GINA (그래픽 식별 및 인증) 아키텍처는 Windows Server 2003, Microsoft Windows 2000 Server, Windows XP 및 Windows 2000 Professional 운영 체제에 적용 됩니다. 이러한 시스템에서 모든 대화형 로그온 세션은 Winlogon 서비스의 개별 인스턴스를 만듭니다. GINA 아키텍처는 Winlogon에서 사용 되는 프로세스 공간에 로드 되 고, 자격 증명을 수신 및 처리 하 고, LSALogonUser를 통해 인증 인터페이스에 대 한 호출을 수행 합니다.

대화형 로그온에 대 한 Winlogon 인스턴스는 세션 0에서 실행 됩니다. 세션 0은 시스템 서비스 및 LSA (로컬 보안 기관) 프로세스를 비롯 한 기타 중요 한 프로세스를 호스팅합니다.

다음 다이어그램에서는 Windows Server 2003, Microsoft Windows 2000 Server, Windows XP 및 Microsoft Windows 2000 Professional의 자격 증명 프로세스를 보여 줍니다.

![Windows Server 2003, Microsoft Windows 2000 Server, Windows XP 및 Microsoft Windows 2000 Professional의 자격 증명 프로세스를 보여 주는 다이어그램](../media/credentials-processes-in-windows-authentication/AuthN_GINA_Architecture.gif)

**자격 증명 공급자 아키텍처**

자격 증명 공급자 아키텍처는이 항목의 시작 부분에 있는 **적용 대상** 목록에 지정 된 버전에 적용 됩니다. 이러한 시스템에서 자격 증명 입력 아키텍처는 자격 증명 공급자를 사용 하 여 확장 가능한 설계로 변경 되었습니다. 이러한 공급자는 보안 된 데스크톱의 여러 로그온 타일로 표시 됩니다. 즉, 동일한 사용자에 대해 다양 한 로그온 시나리오를 허용 하 고 암호, 스마트 카드, 생체 인식 등의 서로 다른 인증 방법을 사용할 수 있습니다.

자격 증명 공급자 아키텍처를 사용 하는 경우 Winlogon은 보안 주의 시퀀스 이벤트를 받은 후 항상 로그온 UI를 시작 합니다. 로그온 UI는 각 자격 증명 공급자에서 공급자가 열거 하도록 구성 된 다양 한 자격 증명 형식의 수를 쿼리 합니다. 자격 증명 공급자에는 이러한 타일 중 하나를 기본값으로 지정할 수 있는 옵션이 있습니다. 모든 공급자가 타일을 열거 한 후에 로그온 UI는 사용자에 게 표시 합니다. 사용자는 타일과 상호 작용 하 여 자격 증명을 제공 합니다. 로그온 UI는 인증을 위해 이러한 자격 증명을 제출 합니다.

자격 증명 공급자는 적용 메커니즘이 아닙니다. 자격 증명은 자격 증명을 수집 하 고 serialize 하는 데 사용 됩니다. 로컬 보안 기관 및 인증 패키지는 보안을 적용 합니다.

자격 증명 공급자는 컴퓨터에 등록 되며 다음을 담당 합니다.

-   인증에 필요한 자격 증명 정보를 설명 합니다.

-   외부 인증 기관을 사용 하 여 통신 및 논리 처리

-   대화형 및 네트워크 로그온을 위한 자격 증명을 패키지 합니다.

대화형 및 네트워크 로그온을 위한 자격 증명을 패키징하는 serialization 프로세스를 포함 합니다. 자격 증명을 직렬화 하면 로그온 UI에 여러 로그온 타일이 표시 될 수 있습니다. 따라서 조직에서는 사용자 지정 된 자격 증명 공급자를 사용 하 여 사용자, 로그온을 위한 대상 시스템, 네트워크 및 워크스테이션 잠금/잠금 해제 정책에 대 한 사전 로그온 액세스 등의 로그온 표시를 제어할 수 있습니다. 여러 자격 증명 공급자가 동일한 컴퓨터에 공존할 수 있습니다.

SSO (Single sign-on) 공급자는 표준 자격 증명 공급자나 사전 로그온 액세스 공급자로 개발할 수 있습니다.

각 버전의 Windows에는 SSO 공급자 라고도 하는 하나의 기본 자격 증명 공급자와 기본 PLAP (사전 로그온 액세스 공급자)가 포함 되어 있습니다. SSO 공급자는 로컬 컴퓨터에 로그온 하기 전에 사용자가 네트워크에 연결할 수 있도록 허용 합니다. 이 공급자가 구현 되 면 공급자는 로그온 UI에서 타일을 열거 하지 않습니다.

SSO 공급자는 다음과 같은 시나리오에서 사용 하기 위한 것입니다.

-   **네트워크 인증 및 컴퓨터 로그온은 다른 자격 증명 공급자에 의해 처리 됩니다.** 이 시나리오의 변형에는 다음이 포함 됩니다.

    -   사용자는 컴퓨터에 로그온 하기 전에 VPN (가상 사설망)에 연결 하는 등의 네트워크 연결 옵션을 선택할 수 있지만이 연결을 만들 필요는 없습니다.

    -   로컬 컴퓨터에서 대화형 인증을 수행 하는 데 사용 되는 정보를 검색 하려면 네트워크 인증이 필요 합니다.

    -   여러 네트워크 인증 후에 다른 시나리오 중 하나를 수행 합니다. 예를 들어 사용자가 ISP (인터넷 서비스 공급자)에 인증 하 고 VPN에 대해 인증 한 다음 사용자 계정 자격 증명을 사용 하 여 로컬로 로그온 합니다.

    -   캐시 된 자격 증명은 사용 하지 않도록 설정 되며, VPN을 통한 원격 액세스 서비스 연결은 로컬 로그온 전에 사용자를 인증 해야 합니다.

    -   도메인 사용자에 게는 도메인에 가입 된 컴퓨터에 설정 된 로컬 계정이 없으며, 대화형 로그온을 완료 하기 전에 VPN 연결을 통해 원격 액세스 서비스 연결을 설정 해야 합니다.

-   **네트워크 인증 및 컴퓨터 로그온은 동일한 자격 증명 공급자에 의해 처리 됩니다.** 이 시나리오에서는 사용자가 컴퓨터에 로그온 하기 전에 네트워크에 연결 해야 합니다.

**로그온 타일 열거**

자격 증명 공급자는 다음과 같은 경우에 로그온 타일을 열거 합니다.

-   이 항목의 시작 부분에 있는 **적용 대상** 목록에 지정 된 운영 체제에 해당 합니다.

-   자격 증명 공급자는 워크스테이션 로그온을 위한 타일을 열거 합니다. 자격 증명 공급자는 일반적으로 인증을 위해 로컬 보안 기관에 대 한 자격 증명을 직렬화 합니다. 이 프로세스는 각 사용자에 대 한 타일을 표시 하 고 각 사용자의 대상 시스템에 특정 합니다.

-   로그온 및 인증 아키텍처를 통해 사용자는 자격 증명 공급자가 열거 한 타일을 사용 하 여 워크스테이션의 잠금을 해제할 수 있습니다. 일반적으로 현재 로그온 한 사용자가 기본 타일 이지만 둘 이상의 사용자가 로그온 한 경우에는 많은 타일이 표시 됩니다.

-   자격 증명 공급자는 PIN 등의 암호 또는 기타 개인 정보를 변경 하기 위해 사용자 요청에 대 한 응답으로 타일을 열거 합니다. 일반적으로 현재 로그온 한 사용자가 기본 타일입니다. 그러나 둘 이상의 사용자가 로그온 한 경우에는 다양 한 타일이 표시 됩니다.

-   자격 증명 공급자는 원격 컴퓨터의 인증에 사용할 직렬화 된 자격 증명을 기반으로 하는 타일을 열거 합니다. 자격 증명 UI는 로그온 UI와 동일한 공급자 인스턴스를 사용 하거나, 워크스테이션의 잠금을 해제 하거나, 암호를 변경 하지 않습니다. 따라서 자격 증명 UI 인스턴스 간의 상태 정보를 공급자에서 유지 관리할 수 없습니다. 이 구조는 자격 증명이 올바르게 serialize 된 것으로 가정 하 여 각 원격 컴퓨터 로그온에 대해 하나의 타일을 생성 합니다. 이 시나리오는 UAC (사용자 계정 컨트롤) 에서도 사용 됩니다 .이를 통해 컴퓨터의 작업에 영향을 주거나 컴퓨터의 다른 사용자에 게 영향을 주는 설정을 변경할 수 있는 작업을 허용 하기 전에 사용자에 게 권한을 요청 하거나 관리자 암호를 입력 하 여 컴퓨터에 대 한 무단 변경을 방지할 수 있습니다.

다음 다이어그램에서는이 항목의 시작 부분에 있는 **적용 대상** 목록에 지정 된 운영 체제에 대 한 자격 증명 프로세스를 보여 줍니다.

![이 항목의 시작 부분에 있는 * * 적용 대상 * * 목록에 지정 된 운영 체제에 대 한 자격 증명 프로세스를 보여 주는 다이어그램](../media/credentials-processes-in-windows-authentication/AuthN_CredMan_CredProv.gif)

## <a name="credential-input-for-application-and-service-logon"></a><a name="BKMK_CredentialInputForApplicationAndServiceLogon"></a>응용 프로그램 및 서비스 로그온을 위한 자격 증명 입력
Windows 인증은 사용자 조작이 필요 하지 않은 응용 프로그램 또는 서비스에 대 한 자격 증명을 관리 하도록 설계 되었습니다. 사용자 모드의 응용 프로그램은 사용자가 액세스할 수 있는 시스템 리소스를 기준으로 제한 되지만, 서비스는 시스템 메모리 및 외부 장치에 무제한으로 액세스할 수 있습니다.

시스템 서비스 및 전송 수준 응용 프로그램은 Windows의 SSPI (보안 지원 공급자 인터페이스)를 통해 SSP (보안 지원 공급자)에 액세스 합니다 .이 공급자는 시스템에서 사용할 수 있는 보안 패키지를 열거 하 고, 패키지를 선택 하 고, 해당 패키지를 사용 하 여 인증 된 연결을 가져오는 기능을 제공 합니다.

클라이언트/서버 연결이 인증 되는 경우:

-   연결의 클라이언트 쪽에 있는 응용 프로그램은 `InitializeSecurityContext (General)`SSPI 함수를 사용 하 여 서버에 자격 증명을 보냅니다.

-   연결의 서버 쪽에 있는 응용 프로그램이 `AcceptSecurityContext (General)`SSPI 함수를 사용 하 여 응답 합니다.

-   SSPI 함수 `InitializeSecurityContext (General)` 및 `AcceptSecurityContext (General)`은 필요한 모든 인증 메시지가 성공 또는 실패 인증으로 교환 될 때까지 반복 됩니다.

-   연결이 인증 된 후에는 서버의 LSA가 클라이언트의 정보를 사용 하 여 액세스 토큰을 포함 하는 보안 컨텍스트를 빌드합니다.

-   그런 다음 서버는 `ImpersonateSecurityContext` SSPI 함수를 호출 하 여 액세스 토큰을 서비스의 가장 스레드에 연결할 수 있습니다.

**응용 프로그램 및 사용자 모드**

Windows의 사용자 모드는 적절 한 커널 모드 드라이버에 i/o 요청을 전달할 수 있는 두 가지 시스템으로 구성 됩니다. 즉, 다양 한 유형의 운영 체제용으로 작성 된 응용 프로그램을 실행 하는 환경 시스템과 환경 시스템 대신 시스템 관련 기능을 운영 하는 정수 계열 시스템입니다.

정수 계열 시스템은 환경 시스템 대신 운영 체제의 특정 기능을 관리 하 고 LSA (보안 시스템 프로세스), 워크스테이션 서비스 및 서버 서비스로 구성 됩니다. 보안 시스템 프로세스는 보안 토큰을 처리 하 고, 리소스 권한을 기반으로 사용자 계정에 액세스할 수 있는 권한을 부여 하거나 거부 하 고, 로그온 요청을 처리 하 고, 로그온 인증을 시작 하 고, 운영 체제에서 감사 해야 하는 시스템 리소스를 결정 합니다.

응용 프로그램은 로컬 시스템 (SYSTEM)의 보안 컨텍스트를 포함 하 여 응용 프로그램을 보안 주체로 실행할 수 있는 사용자 모드로 실행할 수 있습니다. 응용 프로그램이 로컬 시스템 (SYSTEM)의 보안 컨텍스트에서 실행 될 수 있는 커널 모드에서 응용 프로그램을 실행할 수도 있습니다.

SSPI는 인증, 메시지 무결성 및 메시지 개인 정보 보호를 위해 통합 보안 서비스를 얻는 데 사용 되는 API 인 통해 secur32.dll 모듈을 통해 사용할 수 있습니다. 응용 프로그램 수준 프로토콜 및 보안 프로토콜 간의 추상화 계층을 제공 합니다. 응용 프로그램 마다 사용자를 식별 하거나 인증 하는 다양 한 방법이 필요 하며, 네트워크를 통해 이동 하는 데이터를 암호화 하는 다른 방법을 사용 하려면 SSPI를 사용 하 여 다른 인증 및 암호화 기능을 포함 하는 Dll (동적 연결 라이브러리)에 액세스할 수 있는 방법을 제공 합니다. 이러한 Dll을 Ssp (보안 지원 공급자) 라고 합니다.

관리 서비스 계정 및 가상 계정은 Windows Server 2008 R2 및 Windows 7에 도입 되어 Microsoft SQL Server 및 인터넷 정보 서비스 (IIS)와 같은 중요 한 응용 프로그램을 자체 도메인 계정을 격리 하 여 제공 하 고, 관리자가 이러한 계정에 대 한 SPN (서비스 사용자 이름) 및 자격 증명을 수동으로 관리할 필요가 없습니다. 이러한 기능 및 인증의 해당 역할에 대 한 자세한 내용은 [windows 7 및 Windows Server 2008 r 2 용 관리 서비스 계정 설명서](https://technet.microsoft.com/library/ff641731(v=ws.10).aspx) 및 [그룹 관리 서비스 계정 개요](../group-managed-service-accounts/group-managed-service-accounts-overview.md)를 참조 하세요.

**서비스 및 커널 모드**

대부분의 Windows 응용 프로그램은 해당 응용 프로그램을 시작 하는 사용자의 보안 컨텍스트에서 실행 되지만 서비스에는 적용 되지 않습니다. 네트워크 및 인쇄 서비스와 같은 많은 Windows 서비스는 사용자가 컴퓨터를 시작할 때 서비스 컨트롤러에 의해 시작 됩니다. 이러한 서비스는 로컬 서비스 또는 로컬 시스템으로 실행 될 수 있으며, 마지막 사용자가 로그 오프 한 후에도 계속 실행 될 수 있습니다.

> [!NOTE]
> 서비스는 일반적으로 로컬 시스템 (시스템), 네트워크 서비스 또는 로컬 서비스 라고 하는 보안 컨텍스트에서 실행 됩니다.  Windows Server 2008 R2는 도메인 보안 주체 인 관리 서비스 계정으로 실행 되는 서비스를 도입 했습니다.

서비스를 시작 하기 전에 서비스 컨트롤러는 서비스에 대해 지정 된 계정을 사용 하 여 로그온 한 다음 LSA의 인증을 위해 서비스의 자격 증명을 제공 합니다. Windows 서비스는 서비스 컨트롤러 관리자가 서비스를 제어 하는 데 사용할 수 있는 프로그래밍 인터페이스를 구현 합니다. Windows 서비스는 시스템을 시작할 때 자동으로 시작 하거나 서비스 제어 프로그램을 사용 하 여 수동으로 시작할 수 있습니다. 예를 들어 Windows 클라이언트 컴퓨터가 도메인에 가입 하는 경우 컴퓨터의 메신저 서비스는 도메인 컨트롤러에 연결 하 여 보안 채널을 엽니다. 인증 된 연결을 얻으려면 서비스에 원격 컴퓨터의 LSA (로컬 보안 기관)에서 신뢰 하는 자격 증명이 있어야 합니다. 네트워크에 있는 다른 컴퓨터와 통신할 때 LSA는 로컬 시스템 및 네트워크 서비스의 보안 컨텍스트에서 실행 되는 다른 모든 서비스와 마찬가지로 로컬 컴퓨터의 도메인 계정에 대 한 자격 증명을 사용 합니다. 로컬 컴퓨터의 서비스를 시스템으로 실행 하므로 LSA에 자격 증명을 제공할 필요가 없습니다.

Ksecdd .sys 파일은 이러한 자격 증명을 관리 및 암호화 하 고 LSA에 대 한 로컬 프로시저 호출을 사용 합니다. 파일 형식은 WINSPOOL.DRV (드라이버) 이며 커널 모드 SSP (보안 지원 공급자) 라고 하며,이 항목의 시작 부분에 있는 **적용 대상** 목록에 지정 된 버전에서 FIPS 140-2 Level 1을 준수 합니다.

커널 모드에는 컴퓨터의 하드웨어 및 시스템 리소스에 대 한 모든 권한이 있습니다. 커널 모드에서는 사용자 모드 서비스와 응용 프로그램이 액세스 권한이 없어야 하는 운영 체제의 중요 영역에 액세스 하는 것을 중지 합니다.

## <a name="local-security-authority"></a><a name="BKMK_LSA"></a>로컬 보안 기관
LSA (로컬 보안 기관)는 사용자를 인증 하 고 로컬 컴퓨터에 로그온 하는 보호 된 시스템 프로세스입니다. 또한 LSA는 컴퓨터에서 로컬 보안의 모든 측면에 대 한 정보를 유지 관리 하며 (이러한 측면을 전체적으로 로컬 보안 정책 이라고 함) 이름 및 Sid (보안 식별자) 간의 변환에 다양 한 서비스를 제공 합니다. 보안 시스템 프로세스 인 LSASS (로컬 보안 기관 서버 서비스)는 컴퓨터 시스템에 적용 되는 보안 정책 및 계정을 추적 합니다.

LSA는 사용자 계정을 발급 한 다음 두 엔터티를 기준으로 사용자 id의 유효성을 검사 합니다.

-   **로컬 보안 기관.** LSA는 동일한 컴퓨터에 있는 보안 계정 관리자 (SAM) 데이터베이스를 확인 하 여 사용자 정보의 유효성을 검사할 수 있습니다. 모든 워크스테이션 또는 구성원 서버는 로컬 사용자 계정 및 로컬 그룹에 대 한 정보를 저장할 수 있습니다. 그러나 이러한 계정은 해당 워크스테이션 또는 컴퓨터에만 액세스 하는 데 사용할 수 있습니다.

-   **로컬 도메인 또는 트러스트 된 도메인의 보안 기관입니다.** LSA는 계정을 발급 한 엔터티에 연결 하 고 해당 계정이 유효한 지 확인 하 고 해당 요청을 계정 보유자에서 시작 했음을 요청 합니다.

LSASS(Local Security Authority Subsystem Service)는 활성 Windows 세션의 사용자를 위해 메모리에 자격 증명을 저장합니다. 저장 된 자격 증명을 통해 사용자는 각 원격 서비스에 대 한 자격 증명을 다시 입력 하지 않고도 파일 공유, Exchange Server 사서함, SharePoint 사이트 등의 네트워크 리소스에 원활 하 게 액세스할 수 있습니다.

LSASS는 다음을 비롯한 여러 가지 형식으로 자격 증명을 저장할 수 있습니다.

-   역방향으로 암호화된 일반 텍스트

-   Kerberos 티켓 (Tgt (티켓 허용 티켓), 서비스 티켓)

-   NT 해시

-   LM (LAN Manager) 해시

사용자가 스마트 카드를 사용 하 여 Windows에 로그온 하는 경우 LSASS는 일반 텍스트 암호를 저장 하지 않지만 계정의 해당 NT 해시 값과 스마트 카드의 일반 텍스트 PIN을 저장 합니다. 대화형 로그온에 필요한 계정 특성이 스마트 카드에 사용하도록 설정된 경우 계정에 대해 원래 암호 해시 대신 임의의 NT 해시 값이 자동으로 생성됩니다. 특성이 설정될 때 자동으로 생성된 암호는 변경되지 않습니다.

사용자가 LM (LAN Manager) 해시와 호환 되는 암호를 사용 하 여 Windows 기반 컴퓨터에 로그온 하면이 인증 자가 메모리에 존재 합니다.

메모리의 일반 텍스트 자격 증명 스토리지는 이를 필요로 하는 자격 증명 공급자가 사용되지 않는 경우에도 비활성화할 수 없습니다.

저장 된 자격 증명은 마지막으로 다시 시작한 후에 시작 되어 닫히지 않은 LSASS(Local Security Authority Subsystem Service) (LSASS) 로그온 세션과 직접 연결 됩니다. 예를 들어 사용자가 다음 중 하나를 수행하는 경우 저장된 LSA 자격 증명을 사용하는 LSA 세션이 만들어집니다.

-   컴퓨터의 로컬 세션 또는 원격 데스크톱 프로토콜 (RDP) 세션에 로그온 합니다.

-   **RunAs** 옵션을 사용하여 작업을 실행하는 경우

-   컴퓨터에서 활성 Windows 서비스를 실행하는 경우

-   예약된 작업 또는 일괄 처리 작업을 실행하는 경우

-   원격 관리 도구를 사용하여 로컬 컴퓨터에서 작업을 실행하는 경우

시스템 계정 프로세스 에서만 액세스할 수 있는 데이터의 비밀 일부인 LSA 비밀이 하드 디스크 드라이브에 저장 되는 경우도 있습니다. 이러한 암호 중 일부는 다시 부팅 후 유지해야 하는 자격 증명이며, 하드 디스크 드라이브에 암호화된 형식으로 저장됩니다. LSA 암호로 저장될 수 있는 자격 증명은 다음과 같습니다.

-   컴퓨터의 Active Directory Domain Services (AD DS) 계정에 대 한 계정 암호

-   컴퓨터에 구성되어 있는 Windows 서비스에 대한 계정 암호

-   구성된 예약된 작업에 대한 계정 암호

-   IIS 애플리케이션 풀 및 웹 사이트에 대한 계정 암호

-   Microsoft 계정에 대 한 암호

Windows 8.1에 도입 된 클라이언트 운영 체제에서는 보호 되지 않은 프로세스에의 한 메모리 및 코드 삽입을 읽을 수 없도록 LSA에 대 한 추가 보호 기능을 제공 합니다. 이 보호는 LSA에서 저장 및 관리 하는 자격 증명에 대 한 보안을 강화 합니다.

이러한 추가 보호에 대 한 자세한 내용은 [추가 LSA 보호 구성](../credentials-protection-and-management/configuring-additional-lsa-protection.md)을 참조 하세요.

## <a name="cached-credentials-and-validation"></a><a name="BKMK_CachedCredentialsAndValidation"></a>캐시 된 자격 증명 및 유효성 검사
유효성 검사 메커니즘은 로그온 시 자격 증명의 표시를 사용 합니다. 그러나 도메인 컨트롤러에서 컴퓨터의 연결이 끊어지고 사용자가 도메인 자격 증명을 제공 하는 경우 Windows는 유효성 검사 메커니즘에서 캐시 된 자격 증명 프로세스를 사용 합니다.

사용자는 도메인에 로그온 할 때마다 제공 된 자격 증명을 캐시 하 고 작업 시스템 레지스트리의 보안 hive에 저장 합니다.

캐시 된 자격 증명을 사용 하면 사용자가 도메인 내의 도메인 컨트롤러에 연결 하지 않고도 도메인 구성원에 로그온 할 수 있습니다.


## <a name="credential-storage-and-validation"></a><a name="BKMK_CredentialStorageAndValidation"></a>자격 증명 저장소 및 유효성 검사
다른 리소스에 액세스 하기 위해 하나의 자격 증명 집합을 사용 하는 것은 바람직하지 않습니다. 예를 들어 관리자가 원격 서버에 액세스할 때 사용자 자격 증명 대신 관리를 사용 하려고 할 수 있습니다. 마찬가지로 사용자가 은행 계좌와 같은 외부 리소스에 액세스 하는 경우 해당 도메인 자격 증명과 다른 자격 증명을 사용할 수 있습니다. 다음 섹션에서는 현재 버전의 Windows 운영 체제와 Windows Vista 및 Windows XP 운영 체제 간의 자격 증명 관리의 차이점에 대해 설명 합니다.

### <a name="remote-logon-credential-processes"></a>원격 로그온 자격 증명 프로세스
RDP (원격 데스크톱 프로토콜)는 Windows 8에 도입 된 원격 데스크톱 클라이언트를 사용 하 여 원격 컴퓨터에 연결 하는 사용자의 자격 증명을 관리 합니다. 일반 텍스트 형식의 자격 증명은 호스트가 인증 프로세스를 수행 하려고 하는 대상 호스트로 전송 되 고, 성공 하면 사용자를 허용 된 리소스에 연결 합니다. RDP는 클라이언트에 자격 증명을 저장 하지 않지만 사용자의 도메인 자격 증명은 LSASS에 저장 됩니다.

Windows Server 2012 R2 및 Windows 8.1에서 도입 된 제한 된 관리자 모드는 원격 로그온 시나리오에 대 한 추가 보안을 제공 합니다. 이 원격 데스크톱 모드를 사용 하면 클라이언트 응용 프로그램에서 NT 단방향 함수 (NTOWF)를 사용 하 여 네트워크 로그온 챌린지 응답을 수행 하거나 원격 호스트에 인증할 때 Kerberos 서비스 티켓을 사용 합니다. 관리자가 인증 된 후에는 원격 호스트에 제공 되지 않았기 때문에 관리자가 해당 계정 자격 증명을 LSASS에 포함 하지 않습니다. 대신 관리자에 게는 세션에 대 한 컴퓨터 계정 자격 증명이 있습니다. 원격 호스트에는 관리자 자격 증명이 제공 되지 않으므로 작업이 컴퓨터 계정으로 수행 됩니다. 또한 리소스는 컴퓨터 계정으로 제한 되며 관리자는 자신의 계정을 사용 하 여 리소스에 액세스할 수 없습니다.

### <a name="automatic-restart-sign-on-credential-process"></a>자동 다시 시작 로그온 자격 증명 프로세스
사용자가 Windows 8.1 장치에서 로그인 하면 LSA에서 사용자 자격 증명을 암호화 된 메모리에 저장 하며,이는 LSASS.EXE 에서만 액세스할 수 있습니다. 사용자가 없어도 자동 다시 시작을 시작 하 Windows 업데이트 경우 이러한 자격 증명을 사용 하 여 사용자에 대 한 자동 로그온을 구성 합니다.

다시 시작 시 사용자는 자동 로그온 메커니즘을 통해 자동으로 로그인 되며 사용자의 세션을 보호 하기 위해 컴퓨터가 추가로 잠깁니다. 잠금은 Winlogon을 통해 시작 되지만 자격 증명 관리는 LSA에서 수행 됩니다. 콘솔에서 사용자의 세션을 자동으로 로그인 하 고 잠그면 사용자의 잠금 화면 응용 프로그램이 다시 시작 되 고 사용 가능 합니다.

ARSO에 대 한 자세한 내용은 [Winlogon 자동 다시 시작 &#40;로그온 arso&#41;](winlogon-automatic-restart-sign-on-arso.md)를 참조 하세요.

### <a name="stored-user-names-and-passwords-in-windows-vista-and-windows-xp"></a>Windows Vista 및 Windows XP에 저장 된 사용자 이름 및 암호
Windows Server 2008, Windows Server 2003, Windows Vista 및 Windows XP에서 제어판의 **저장 된 사용자 이름 및 암호** 를 사용 하면 스마트 카드 및 Windows Live 자격 증명에 사용 되는 x.509 인증서 (현재 Microsoft 계정 이라고 함)를 비롯 한 여러 로그온 자격 증명 집합을 간편 하 게 관리할 수가 있습니다. 자격 증명-사용자 프로필의 부분은 필요할 때까지 저장 됩니다. 이 작업을 통해 한 암호가 손상 되더라도 모든 보안을 손상 시 키 지 않도록 하 여 리소스 별로 보안을 강화할 수 있습니다.

사용자가 로그온 하 여 서버의 공유와 같은 암호로 보호 된 추가 리소스에 액세스 하려고 시도 하는 경우 사용자의 기본 로그온 자격 증명이 충분 하지 않아 액세스 하지 못하는 경우에는 **저장 된 사용자 이름 및 암호** 를 쿼리 합니다. 올바른 로그온 정보가 포함 된 대체 자격 증명이 **저장 된 사용자 이름 및 암호**에 저장 된 경우 이러한 자격 증명을 사용 하 여 액세스 권한을 얻습니다. 그렇지 않으면 사용자에 게 새 자격 증명을 입력 하 라는 메시지가 표시 됩니다 .이 자격 증명은 나중에 로그온 세션에서 또는 후속 세션에서 다시 사용 하기 위해 저장할 수 있습니다.

다음과 같은 제한 사항이 있습니다.

-   **저장 된 사용자 이름 및 암호** 에 특정 리소스에 대해 유효 하지 않거나 잘못 된 자격 증명이 포함 된 경우 해당 리소스에 대 한 액세스가 거부 되 고 **저장 된 사용자 이름 및 암호** 대화 상자가 나타나지 않습니다.

-   **저장 된 사용자 이름 및 암호** 는 NTLM, Kerberos 프로토콜 Microsoft 계정 (이전의 WINDOWS Live ID) 및 SSL(SECURE SOCKETS LAYER) (SSL) 인증용 으로만 자격 증명을 저장 합니다. 일부 Internet Explorer 버전은 기본 인증을 위해 자체 캐시를 유지 관리 합니다.

이러한 자격 증명은 \Documents 및 Settings\Username\Application Data\Microsoft\Credentials 디렉터리에 있는 사용자의 로컬 프로필의 암호화 된 부분이 됩니다. 따라서 사용자의 네트워크 정책이 로밍 사용자 프로필을 지 원하는 경우 이러한 자격 증명은 사용자와 로밍할 수 있습니다. 그러나 사용자가 두 대의 컴퓨터에 **저장 된 사용자 이름 및 암호** 를 복사 하 고 이러한 컴퓨터 중 하나에 있는 리소스와 연결 된 자격 증명을 변경 하는 경우 변경 내용은 두 번째 컴퓨터에 **저장 된 사용자 이름 및 암호로** 전파 되지 않습니다.

### <a name="windows-vault-and-credential-manager"></a>Windows 자격 증명 모음 및 자격 증명 관리자
자격 증명 관리자는 사용자 이름 및 암호를 저장 하 고 관리 하는 제어판 기능으로 Windows Server 2008 R2 및 Windows 7에서 도입 되었습니다. 자격 증명 관리자를 통해 사용자는 보안 Windows 자격 증명 모음에서 다른 시스템 및 웹 사이트와 관련 된 자격 증명을 저장할 수 있습니다. 일부 Internet Explorer 버전은 웹 사이트 인증에이 기능을 사용 합니다.

자격 증명 관리자를 사용한 자격 증명 관리는 로컬 컴퓨터의 사용자에 의해 제어됩니다. 사용자는 지원되는 브라우저 및 Windows 애플리케이션에 자격 증명을 저장하여 이러한 리소스에 로그인해야 할 때 편리하게 사용할 수 있습니다. 자격 증명은 사용자의 프로필에 따라 컴퓨터의 특수 암호화 된 폴더에 저장 됩니다. 웹 브라우저 및 앱과 같이이 기능을 지 원하는 응용 프로그램은 자격 증명 관리자 Api를 사용 하 여 다른 컴퓨터와 웹 사이트에 올바른 자격 증명을 제공할 수 있습니다.

웹 사이트, 응용 프로그램 또는 다른 컴퓨터에서 NTLM 또는 Kerberos 프로토콜을 통해 인증을 요청 하면 **기본 자격 증명 업데이트** 또는 **암호 저장** 확인란을 선택할 수 있는 대화 상자가 나타납니다. 자격 증명 관리자 Api를 지 원하는 응용 프로그램에서 사용자가 로컬로 자격 증명을 저장할 수 있도록 하는이 대화 상자가 생성 됩니다. 사용자가 **암호 저장** 확인란을 선택 하는 경우 자격 증명 관리자는 사용 중인 인증 서비스에 대 한 사용자의 사용자 이름, 암호 및 관련 정보를 계속 추적 합니다.

다음 번에 서비스를 사용 하면 자격 증명 관리자가 Windows 자격 증명 모음에 저장 된 자격 증명을 자동으로 제공 합니다. 확인란을 선택하지 않은 경우에는 올바른 액세스 정보를 입력하라는 메시지가 표시됩니다. 새 자격 증명을 사용 하 여 액세스 권한을 부여 하는 경우 자격 증명 관리자는 이전 자격 증명을 새 자격 증명으로 덮어쓰고 새 자격 증명을 Windows 자격 증명 모음에 저장 합니다.

## <a name="security-accounts-manager-database"></a><a name="BKMK_SAM"></a>보안 계정 관리자 데이터베이스
SAM (보안 계정 관리자)은 로컬 사용자 계정 및 그룹을 저장 하는 데이터베이스입니다. 모든 Windows 운영 체제에 표시 됩니다. 그러나 컴퓨터가 도메인에 가입 되어 있으면 Active Directory Active Directory 도메인의 도메인 계정을 관리 합니다.

예를 들어 Windows 운영 체제를 실행 하는 클라이언트 컴퓨터는 사용자가 로그온 하지 않은 경우에도 도메인 컨트롤러와 통신 하 여 네트워크 도메인에 참여 합니다. 통신을 시작 하려면 컴퓨터에 도메인의 활성 계정이 있어야 합니다. 컴퓨터의 통신을 수락 하기 전에 도메인 컨트롤러의 LSA는 컴퓨터의 id를 인증 한 다음 사용자 보안 주체와 마찬가지로 컴퓨터의 보안 컨텍스트를 생성 합니다. 이 보안 컨텍스트는 특정 컴퓨터 또는 네트워크의 사용자, 서비스 또는 컴퓨터에 대 한 사용자 또는 서비스의 id와 기능을 정의 합니다. 예를 들어 보안 컨텍스트 내에 포함 된 액세스 토큰은 액세스할 수 있는 리소스 (예: 파일 공유 또는 프린터)와 해당 보안 주체의 사용자, 컴퓨터 또는 서비스에서 수행할 수 있는 작업 (예: 읽기, 쓰기 또는 수정)을 정의 합니다.

사용자 또는 컴퓨터의 보안 컨텍스트는 컴퓨터 마다 다를 수 있습니다. 예를 들어 사용자가 자신의 기본 워크스테이션이 아닌 서버 또는 워크스테이션에 로그온 하는 경우에 해당 합니다. 또한 관리자가 사용자의 권한 및 사용 권한을 수정 하는 경우와 같이 한 세션에서 다른 세션으로 달라질 수 있습니다. 또한 사용자 또는 컴퓨터가 독립 실행형 방식으로, 네트워크에서 또는 Active Directory 도메인의 일부로 작동 하는 경우에는 일반적으로 보안 컨텍스트가 다릅니다.

## <a name="local-domains-and-trusted-domains"></a><a name="BKMK_LocalDomainsAndTrustedDomains"></a>로컬 도메인 및 트러스트 된 도메인
두 도메인 간에 트러스트가 있는 경우 각 도메인에 대 한 인증 메커니즘은 다른 도메인에서 들어오는 인증의 유효성을 사용 합니다. 트러스트는 들어오는 인증 요청을 신뢰할 수 있는 기관 (트러스트 된 도메인)에서 가져온 것인지 확인 하 여 리소스 도메인 (트러스팅 도메인)의 공유 리소스에 대 한 제어 된 액세스를 제공 하는 데 도움이 됩니다. 이러한 방식으로 트러스트는 유효성을 검사 한 인증 요청만 도메인 간에 이동할 수 있도록 하는 브리지 역할을 합니다.

특정 신뢰가 인증 요청을 통과 하는 방법은 구성 방법에 따라 달라 집니다. 트러스트 관계는 트러스트 된 도메인에서 트러스팅 도메인의 리소스에 대 한 액세스를 제공 하거나, 각 도메인에서 다른 도메인의 리소스에 대 한 액세스를 제공 하 여 양방향 일 수 있습니다. 트러스트는 비 전이적입니다 .이 경우 트러스트는 두 트러스트 파트너 도메인 간에만 존재 하며,이 경우 트러스트는 파트너 트러스트 중 하나가 다른 모든 도메인으로 자동 확장 됩니다.

인증과 관련 된 도메인 및 포리스트 트러스트 관계에 대 한 자세한 내용은 [위임 된 인증 및 트러스트 관계](https://technet.microsoft.com/library/dn169022.aspx)를 참조 하세요.

## <a name="certificates-in-windows-authentication"></a><a name="BKMK_CertificatesInWindowsAuthentication"></a>Windows 인증의 인증서
PKI (공개 키 인프라)는 조직이 통신 및 비즈니스 트랜잭션을 보호할 수 있도록 하는 소프트웨어, 암호화 기술, 프로세스 및 서비스의 조합입니다. 통신 및 비즈니스 트랜잭션을 보호 하는 PKI는 인증 된 사용자와 신뢰할 수 있는 리소스 간의 디지털 인증서 교환을 기반으로 합니다.

디지털 인증서는 자신이 속한 엔터티에 대 한 정보, 발급자가 발급 한 엔터티, 고유한 일련 번호 또는 기타 고유 id, 발급 및 만료 날짜, 디지털 지문을 포함 하는 전자 문서입니다.

인증은 원격 호스트를 신뢰할 수 있는지 여부를 확인 하는 프로세스입니다. 신뢰성을 설정 하려면 원격 호스트에서 허용 되는 인증 인증서를 제공 해야 합니다.

원격 호스트는 CA (인증 기관)에서 인증서를 가져와 해당 신뢰를 설정 합니다. 그러면 CA는 더 높은 기관의 인증을 가지 며,이를 통해 신뢰 체인을 만들 수 있습니다. 인증서를 신뢰할 수 있는지 여부를 확인 하려면 응용 프로그램에서 루트 CA의 id를 확인 하 고 신뢰할 수 있는지 확인 해야 합니다.

마찬가지로, 원격 호스트 또는 로컬 컴퓨터는 사용자 또는 응용 프로그램에서 제공 하는 인증서가 인증 되었는지 확인 해야 합니다. LSA 및 SSPI를 통해 사용자가 제공 하는 인증서는 로컬 로그온, 네트워크 상의 로컬 컴퓨터 또는 Active Directory의 인증서 저장소를 통한 도메인에서 인증을 위해 평가 됩니다.

인증서를 생성 하려면 인증 데이터가 SHA(Secure Hash Algorithm) 1 (SHA1)와 같은 해시 알고리즘을 통해 전달 되어 메시지 다이제스트를 생성 합니다. 메시지 다이제스트는 보낸 사람의 개인 키를 사용 하 여 메시지 다이제스트가 보낸 사람이 생성 되었음을 증명 하는 방식으로 디지털 서명 됩니다.

> [!NOTE]
> SHA1은 Windows 7 및 Windows Vista의 기본값 이지만 Windows 8에서 SHA2로 변경 되었습니다.

**스마트 카드 인증**

스마트 카드 기술은 인증서 기반 인증의 한 예입니다. 스마트 카드를 사용 하 여 네트워크에 로그온 하면 사용자를 도메인에 인증할 때 암호화 기반 식별 및 소유 증명을 사용 하기 때문에 강력한 형태의 인증이 제공 됩니다. Active Directory 인증서 서비스 (AD CS)는 각 스마트 카드에 대 한 로그온 인증서를 발급 하 여 암호화 기반 id를 제공 합니다.

스마트 카드 인증에 대 한 자세한 내용은 [Windows 스마트 카드 기술 참조](https://technet.microsoft.com/library/ff404297.aspx)를 참조 하세요.

가상 스마트 카드 기술은 Windows 8에서 도입 되었습니다. PC에 스마트 카드의 인증서를 저장 한 다음 장치의 TPM (변조 방지 신뢰할 수 있는 플랫폼 모듈) 보안 칩을 사용 하 여 보호 합니다. 이러한 방식으로 PC는 실제로 인증을 위해 사용자의 PIN을 수신 해야 하는 스마트 카드가 됩니다.

**원격 및 무선 인증**

원격 및 무선 네트워크 인증은 인증을 위해 인증서를 사용 하는 또 다른 기술입니다. IAS (인터넷 인증 서비스) 및 가상 사설망 서버는 EAP-TLS (확장할 수 있는 인증 프로토콜), PEAP (Protected Extensible Authentication Protocol) 또는 IPsec (인터넷 프로토콜 보안)을 사용 하 여 VPN (가상 사설망) 및 무선 연결을 비롯 한 다양 한 유형의 네트워크 액세스에 대해 인증서 기반 인증을 수행 합니다.

네트워킹의 인증서 기반 인증에 대 한 자세한 내용은 [네트워크 액세스 인증 및 인증서](https://technet.microsoft.com/library/cc759575(WS.10).aspx)를 참조 하세요.

## <a name="see-also"></a><a name="BKMK_SeeAlso"></a>참고 항목
[Windows 인증 개념](https://docs.microsoft.com/windows-server/security/windows-authentication/windows-authentication-concepts)


